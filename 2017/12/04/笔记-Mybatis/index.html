<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
				<script>var timeStart = new Date();</script>
		
		<title>[笔记]-Mybatis | 一个放笔记的地方而已</title>
		
		<meta name="author" content="Huangzhike">
		
		
		<meta name="description" content="用手记笔记，用心记笔记，用脑记笔记">
		
		
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		
		<meta property="og:title" content="[笔记]-Mybatis"/>
		
		<meta property="og:site_name" content="一个放笔记的地方而已"/>
		
		
		<!-- favicon -->
		<link rel="icon" type="image/ico" href="/ok.ico" sizes="32x32">
 


		<meta name="msapplication-TileColor" content="#009688">
		<meta name="msapplication-TileImage" content="/mstile-144x144.ico">
		<meta name="theme-color" content="#009688">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Didact+Gothic"> 

		<!-- favicon end -->
		<!-- <link href="//ok.ico" rel="icon"> -->
		
		<!-- toc -->
		<!-- <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">-->
		<!-- material design -->
		<!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">-->
		<link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
		 
		 
		<!-- <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>-->
		<!-- <script>window.jQuery || document.write('<script src="/libs/jquery-3.1.1.slim.min.js" type="text/javascript"><\/script>')</script>-->
	</head>

<body>
	<nav class="navbar navbar-default">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">菜单</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/">一个放笔记的地方而已</a>
           
		</div>
		<div id="navbar" class="collapse navbar-collapse">
			<ul class="nav navbar-nav navbar-right">
				
				<li>
					<a href="https://huangzhike.github.io/" title="">
						<i class="fa fa-home"></i>Index
					</a>
				</li>
				
				<li>
					<a href="https://huangzhike.github.io/archives" title="">
						<i class="fa fa-list"></i>Archives
					</a>
				</li>
				
				<li>
					<a href="https://github.com/huangzhike" title="">
						<i class="fa fa-github"></i>GitHub
					</a>
				</li>
				
			</ul>
		</div>
	</div>
</nav>

	<div class="container" >
		<div class="row">
	
		<div class="col-md-9 center-content">
			
			<div class="content">
				<!-- index -->
				
				<h2>[笔记]-Mybatis</h2>
				
				<div>
					<span class="post-time">2017-12-04 00:23:17</span>
				</div>	
				
				<div class="article-content">
				<p><strong>12-30重新整理</strong></p>
<p>Mybatis有<a href="http://www.mybatis.org/mybatis-3/zh/index.html" target="_blank" rel="external">官方中文文档</a>，写得很精简，嗯，很好。</p>
<p>与Hibernate相比，MyBatis：</p>
<ul>
<li>在XML文件中配置SQL语句，分离SQL语句与代码，方便维护。</li>
<li>自己写SQL，灵活，效率。</li>
<li>简单。</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">users</span> (<span class="keyword">id</span> <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT, <span class="keyword">name</span> <span class="built_in">VARCHAR</span>(<span class="number">20</span>), age <span class="built_in">INT</span>);</div></pre></td></tr></table></figure>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> mmp.domain;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> &#123;</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line">	<span class="keyword">private</span> String name;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> age;</div><div class="line">	<span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>SQL映射文件</li>
</ul>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="comment">&lt;!-- mmp/mapping/userMapper.xml --&gt;</span></span></div><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> <span class="meta">?&gt;</span></span></div><div class="line"><span class="meta">&lt;!DOCTYPE mapper </span></div><div class="line">	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" </div><div class="line">	"http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</div><div class="line"><span class="comment">&lt;!-- 为mapper指定namespace，包名+SQL映射文件名 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"mmp.mapping.userMapper"</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- CURD：增 Create、改 Update、查 Read、删 Delete --&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 输入映射 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- parameterType：查询时的参数类型，自动检测，一般可以省略 --&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 输出映射 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- resultType：返回的结果集类型，本例将查询结果封装成User类对象返回 --&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- resultType：SQL查询的列名要和resultType指定POJO的属性名相同，方可映射成功 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- select name _name 给了别名_name，映射到对象时，name属性就为null --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 或者用resultMap --&gt;</span></div><div class="line"></div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUser"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"mmp.domain.User"</span>&gt;</span></div><div class="line">		select * from users where id = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line">		<span class="comment">&lt;!-- 如果接收简单类型，#</span><span class="template-variable">&#123;&#125;</span><span class="xml"><span class="comment">中的值任意？最好写类的属性名 --&gt;</span></span></div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 根据用户名称模糊查询用户信息，可能返回多条 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- $</span><span class="template-variable">&#123;&#125;</span><span class="xml"><span class="comment">：表示拼接SQL，可能引起SQL注入，不建议使用 --&gt;</span></span></div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserByName"</span> <span class="attr">parameterType</span>=<span class="string">"java.lang.String"</span> <span class="attr">resultType</span>=<span class="string">"mmp.domain.User"</span>&gt;</span></div><div class="line">		select * from users where name like '%$<span class="template-variable">&#123;value&#125;</span><span class="xml">%'</span></div><div class="line">		<span class="comment">&lt;!-- 如果接收简单类型，$</span><span class="template-variable">&#123;&#125;</span><span class="xml"><span class="comment">中只能写成value？ --&gt;</span></span></div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getAllUsers"</span> <span class="attr">resultType</span>=<span class="string">"mmp.domain.User"</span>&gt;</span></div><div class="line">		select * from users</div><div class="line">	<span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUser"</span> <span class="attr">parameterType</span>=<span class="string">"mmp.domain.User"</span>&gt;</span></div><div class="line">		insert into users(name, age) values(#<span class="template-variable">&#123;name&#125;</span><span class="xml">, #</span><span class="template-variable">&#123;age&#125;</span><span class="xml">)</span></div><div class="line">	<span class="tag">&lt;/<span class="name">insert</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">"deleteUser"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></div><div class="line">		delete from users where id = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line">	<span class="tag">&lt;/<span class="name">delete</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">"updateUser"</span> <span class="attr">parameterType</span>=<span class="string">"mmp.domain.User"</span>&gt;</span></div><div class="line">		update users set name = #<span class="template-variable">&#123;name&#125;</span><span class="xml">, age = #</span><span class="template-variable">&#123;age&#125;</span><span class="xml"> where id = #</span><span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line">	<span class="tag">&lt;/<span class="name">update</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li><code>&lt;selectKey&gt;</code></li>
</ul>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">"addUser"</span> <span class="attr">parameterType</span>=<span class="string">"mmp.domain.User"</span>&gt;</span></span></div><div class="line">	insert into users(name, age) values(#<span class="template-variable">&#123;name&#125;</span><span class="xml">, #</span><span class="template-variable">&#123;age&#125;</span><span class="xml">)</span></div><div class="line">	<span class="comment">&lt;!-- &lt;selectKey/&gt;将插入数据的主键返回到对象中 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- keyProperty：将查询到主键值设置到上面 parameterType指定的Java对象的哪个属性 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- resultType：获取的主键的类型 --&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- order：id的生成相对于insert语句的执行是在前还是在后 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- MySql先insert后生成id，设AFTER --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- Oracle先生成id再insert，设BEFORE --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 不指定order，则根据DBMS自动选择 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">selectKey</span> <span class="attr">keyProperty</span>=<span class="string">"id"</span> <span class="attr">order</span>=<span class="string">"AFTER"</span> <span class="attr">resultType</span>=<span class="string">"java.lang.Integer"</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- SQL函数，表示得到刚insert的主键值，只适用于自增主键 --&gt;</span></div><div class="line">		select last_insert_id()</div><div class="line">	<span class="tag">&lt;/<span class="name">selectKey</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 在插入操作还未提交时对象已经有了id --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 无论插入操作是提交还是回滚，id也已被使用，后面再插入，分配的id跳过此id --&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">insert</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>配置文件</li>
</ul>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></span></div><div class="line"><span class="meta">&lt;!DOCTYPE configuration </span></div><div class="line">	PUBLIC "-//mybatis.org//DTD Config 3.0//EN" </div><div class="line">	"http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 引用db.properties配置文件 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span>/&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 为parameterType或resultType的实体类定义别名 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 如&lt;insert id="addUser2" parameterType="user"&gt;...&lt;/insert&gt; --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 单独某一个实体类设置别名 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">typeAlias</span> <span class="attr">alias</span>=<span class="string">"user"</span> <span class="attr">type</span>=<span class="string">"mmp.domain.User"</span>/&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 批量为某个包下的所有实体类设置别名，默认简单的类名，如user --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"mmp.domain"</span>/&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 若有注解，则别名为其注解值 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- </span></div><div class="line">			@Alias("user")</div><div class="line">			public class User <span class="template-variable">&#123;&#125;</span><span class="xml"><span class="comment"></span></span></div><div class="line">		 --&gt;</div><div class="line">		<span class="comment">&lt;!-- Mybatis有默认别名，如java.lang.Integer的别名为int --&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="tag">&lt;<span class="name">environments</span> <span class="attr">default</span>=<span class="string">"development"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">environment</span> <span class="attr">id</span>=<span class="string">"development"</span>&gt;</span></div><div class="line">			<span class="comment">&lt;!-- 事务管理器 --&gt;</span></div><div class="line">			<span class="comment">&lt;!-- JDBC：默认关闭自动提交，要显式的提交事务或回滚 --&gt;</span></div><div class="line">			<span class="comment">&lt;!-- MANAGED：由容器管理事务的整个生命周期（如 Spring） --&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">transactionManager</span> <span class="attr">type</span>=<span class="string">"JDBC"</span>/&gt;</span></div><div class="line">			<span class="comment">&lt;!-- 数据库连接，POOLED：使用数据库连接池维护连接 --&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">dataSource</span> <span class="attr">type</span>=<span class="string">"POOLED"</span>&gt;</span></div><div class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driver"</span> <span class="attr">value</span>=<span class="string">"$</span></span><span class="template-variable">&#123;driver&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></div><div class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$</span></span><span class="template-variable">&#123;url&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></div><div class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$</span></span><span class="template-variable">&#123;name&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></div><div class="line">				<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$</span></span><span class="template-variable">&#123;password&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>/&gt;</span></span></div><div class="line">			<span class="tag">&lt;/<span class="name">dataSource</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">environment</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">environments</span>&gt;</span></div><div class="line"></div><div class="line">	<span class="tag">&lt;<span class="name">mappers</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 注册userMapper.xml文件 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">mapper</span> <span class="attr">resource</span>=<span class="string">"mmp/mapping/userMapper.xml"</span>/&gt;</span></div><div class="line"></div><div class="line">		<span class="comment">&lt;!-- &lt;mapper url="file:///xxx\userMapper.xml"/&gt; --&gt;</span></div><div class="line"></div><div class="line">		<span class="comment">&lt;!-- 接口方式 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 接口的全类名 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 映射xml文件名要与接口名相同，在同一包中 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 映射xml文件中&lt;mapper/&gt;的namespace属性值为接口的全类名 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- &lt;mapper class="mmp.mapping.UserMapper"/&gt; --&gt;</span></div><div class="line"></div><div class="line">		<span class="comment">&lt;!-- 当映射文件较多时，指定映射文件所存放的包 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 接口使用mapper动态代理实现 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 映射xml文件名要与接口名相同，在同一包中 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 映射xml文件中&lt;mapper/&gt;的namespace属性值为接口的全类名 --&gt;</span></div><div class="line">		<span class="comment">&lt;!-- &lt;package name="mmp.mapping"/&gt; --&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">mappers</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- </span></div><div class="line">	顺序：</div><div class="line">	&lt;properties&gt;(属性)</div><div class="line">	&lt;setting&gt;(全局配置参数)</div><div class="line">	&lt;typeAliases&gt;(类型别名)</div><div class="line">	&lt;typeHandlers&gt;(类型处理器)</div><div class="line">	&lt;objectFactory&gt;(对象工厂)</div><div class="line">	&lt;plugins&gt;(插件)</div><div class="line">	&lt;environments&gt;(环境集合属性对象)</div><div class="line">	&lt;mappers&gt;(映射器)</div><div class="line"> --&gt;</div></pre></td></tr></table></figure>
<p>src/db.properties<br><figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="attr">driver</span>=com.mysql.jdbc.Driver</div><div class="line"><span class="attr">url</span>=jdbc:mysql://localhost:<span class="number">3306</span>/mybatis</div><div class="line"><span class="attr">name</span>=root</div><div class="line"><span class="attr">password</span>=<span class="number">123456</span></div></pre></td></tr></table></figure></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// DAO方法</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> SqlSessionFactory sessionFactory;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> Reader reader;</div><div class="line"></div><div class="line">	<span class="keyword">static</span> &#123;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			reader = Resources.getResourceAsReader(<span class="string">"config/Configure.xml"</span>);</div><div class="line">			sessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(reader);</div><div class="line">		&#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="keyword">public</span> <span class="keyword">static</span> void main(String[] args) &#123;</div><div class="line">		SqlSession session = sessionFactory.openSession();</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			<span class="comment">// 映射SQL标识字符串，namespace + id 找到要执行的SQL</span></div><div class="line">			String statement = <span class="string">"mmp.mapping.userMapper.getUser"</span>;</div><div class="line"></div><div class="line">			User user = session.selectOne(statement, <span class="number">1</span>);</div><div class="line"></div><div class="line">			statement = <span class="string">"mmp.mapping.userMapper.getAllUsers"</span>;</div><div class="line">			<span class="comment">// 查询结果自动封装成List&lt;User&gt;返回</span></div><div class="line">			<span class="keyword">List</span>&lt;User&gt; lstUsers = session.selectList(statement);</div><div class="line"></div><div class="line">			<span class="comment">// int retResult = session.insert("statementA", new User());</span></div><div class="line">			<span class="comment">// retResult = session.update("statementB", new User());</span></div><div class="line">			<span class="comment">// retResult = session.delete("statementC", 1);</span></div><div class="line">			<span class="comment">// session.commit();</span></div><div class="line">		&#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125; <span class="keyword">finally</span> &#123;</div><div class="line">			session.close();</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><code>SqlSessionFactoryBuilder</code>实例的最佳作用域：方法作用域。</li>
<li><code>SqlSessionFactory</code>实例线程安全，一个应用只要一个，最佳作用域：应用作用域，如单例或静态单例模式。</li>
<li><code>SqlSession</code>实例线程不安全，不能被共享，每个线程都应该有自己的<code>SqlSession</code>实例，最佳的作用域：请求或方法作用域。<ul>
<li>不能将<code>SqlSession</code>实例引用放在类的静态域，类的实例变量也不行。</li>
<li>不能将<code>SqlSession</code>实例引用放在管理作用域中，如Servlet的<code>HttpSession</code>。</li>
<li>考虑<code>SqlSession</code>放在一个和HTTP请求对象相似的作用域中。<ul>
<li>每次收到HTTP请求，打开一个<code>SqlSession</code>，返回一个响应，就关闭它。</li>
</ul>
</li>
<li>一个<code>SqlSession</code>对应一次数据库会话，会话结束前，将其关闭，再次需要，再次创建。</li>
</ul>
</li>
</ul>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MyBatisUtil</span> &#123;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSessionFactory <span class="title">getSqlSessionFactory</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="comment">// 使用类加载器加载MyBatis配置文件</span></div><div class="line">		InputStream <span class="keyword">is</span> = MyBatisUtil.class.getClassLoader().getResourceAsStream(<span class="string">"conf.xml"</span>);</div><div class="line">		<span class="comment">// InputStream inputStream = org.apache.ibatis.io.Resources.getResourceAsStream("conf.xml");</span></div><div class="line">		<span class="comment">// 构建sqlSession工厂，不用手工关闭InputStream，build()方法会自动关闭输入流</span></div><div class="line">		SqlSessionFactory sessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(<span class="keyword">is</span>);</div><div class="line">		<span class="keyword">return</span> sessionFactory;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">getSqlSession</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="comment">// 创建sqlSession，需手动提交</span></div><div class="line">		<span class="keyword">return</span> getSqlSessionFactory().openSession();</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> SqlSession <span class="title">getSqlSession</span>(<span class="params">boolean isAutoCommit</span>) </span>&#123;</div><div class="line">		<span class="comment">// true：自动提交</span></div><div class="line">		<span class="keyword">return</span> getSqlSessionFactory().openSession(isAutoCommit);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>原始Dao法</p>
<ul>
<li>写Dao接口和Dao实现类。</li>
<li>向Dao实现类中注入<code>sqlSessionFactory</code>，在方法体内通过<code>sqlSessionFactory</code>创建<code>sqlSession</code>。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserDao</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">findUserById</span><span class="params">(<span class="keyword">int</span> id)</span> <span class="keyword">throws</span> Exception</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImpl</span> <span class="keyword">implements</span> <span class="title">UserDao</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="keyword">private</span> SqlSessionFactory sqlSessionFactory;</div><div class="line">	<span class="comment">// 没和Spring整合，这里通过构造函数注入</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">UserDaoImpl</span><span class="params">(SqlSessionFactory sqlSessionFactory)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.sqlSessionFactory = sqlSessionFactory;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">findUserById</span><span class="params">(<span class="keyword">int</span> id)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line">		User user = sqlSession.selectOne(<span class="string">"namespace.findUserById"</span>, id);</div><div class="line">		sqlSession.close();</div><div class="line">		<span class="keyword">return</span> user;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserDaoImplTest</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> SqlSessionFactory sqlSessionFactory;</div><div class="line">	<span class="comment">// 在执行本类所有测试方法之前先调用@Before方法，签名要求：public void，无参</span></div><div class="line">	<span class="meta">@Before</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setUp</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		InputStream inputStream = Resources.getResourceAsStream(<span class="string">"conf.xml"</span>);</div><div class="line">		sqlSessionFactory = <span class="keyword">new</span> SqlSessionFactoryBuilder().build(inputStream);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Test</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindUserById</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		UserDao userDao = <span class="keyword">new</span> UserDaoImpl(sqlSessionFactory);</div><div class="line">		User user = userDao.findUserById(<span class="number">1</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>Mapper代理方法</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// mapper接口，相当于dao接口，命名方式：表名加Mapper</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> User <span class="title">findUserById</span><span class="params">(<span class="keyword">int</span> id)</span> <span class="keyword">throws</span> Exception</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>编写对应的XML映射文件：</p>
<ul>
<li><p>UserMapper.xml中namespace对应UserMapper.java的完全限定名。</p>
</li>
<li><p>UserMapper.xml中statement的id对应UserMapper.java中方法名。</p>
</li>
<li><p>UserMapper.xml中statement的parameterType对应UserMapper.java的方法输入参数类型。</p>
</li>
<li><p>UserMapper.xml中statement的resultType对应UserMapperr.java的方法返回值类型。</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">SqlSession sqlSession = sqlSessionFactory.openSession();</div><div class="line"><span class="comment">// 自动生成mapper代理对象</span></div><div class="line">UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</div><div class="line">User user = userMapper.findUserById(<span class="number">1</span>);</div></pre></td></tr></table></figure>
<ul>
<li><p>mapper代理开发的问题</p>
<ul>
<li><p>输入参数的问题：mapper接口方法参数只能有一个。可以使用包装类型的POJO。</p>
</li>
<li><p>返回值的问题：如果mapper接口方法调用的statement中返回是多条记录，而方法的返回值为POJO，此时代理对象通过selectOne调用，但返回多条记录所以会报错。</p>
</li>
</ul>
</li>
<li><p>总结：</p>
  <figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">SqlSession session = sqlSessionFactory.openSession()<span class="comment">;</span></div><div class="line">try &#123;</div><div class="line">	<span class="keyword">Blog </span><span class="keyword">blog </span>= (<span class="keyword">Blog) </span>session.selectOne(<span class="string">"org.mybatis.example.BlogMapper.selectBlog"</span>, <span class="number">101</span>)<span class="comment">;</span></div><div class="line">&#125; finally &#123;</div><div class="line">	session.<span class="keyword">close();</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
  <figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">SqlSession session = sqlSessionFactory.openSession()<span class="comment">;</span></div><div class="line">try &#123;</div><div class="line">	<span class="keyword">BlogMapper </span>mapper = session.getMapper(<span class="keyword">BlogMapper.class);</span></div><div class="line">	<span class="keyword">Blog </span><span class="keyword">blog </span>= mapper.selectBlog(<span class="number">101</span>)<span class="comment">;</span></div><div class="line">&#125; finally &#123;</div><div class="line">	session.<span class="keyword">close();</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>字段名与实体类属性名不相同的冲突。</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> orders (</div><div class="line">	order_id <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT,</div><div class="line">	order_no <span class="built_in">VARCHAR</span>(<span class="number">20</span>), </div><div class="line">);</div></pre></td></tr></table></figure>
<figure class="highlight groovy"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> mmp.domain;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Order</span> &#123;</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id; <span class="comment">// id =&gt; order_id</span></div><div class="line">	<span class="keyword">private</span> String orderNo; <span class="comment">// orderNo ==&gt; order_no</span></div><div class="line">	<span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="comment">&lt;!-- 法一：别名 --&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"xxx"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"mmp.domain.Order"</span>&gt;</span></div><div class="line">	select order_id id, order_no orderNo from orders where order_id = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 法二：&lt;resultMap&gt;映射实体类属性名和表的字段名 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"xxx"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultMap</span>=<span class="string">"orderResultMap"</span>&gt;</span></div><div class="line">	select * from orders where order_id = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"mmp.domain.Order"</span> <span class="attr">id</span>=<span class="string">"orderResultMap"</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- id 映射主键字段 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"order_id"</span>/&gt;</span></div><div class="line">	<span class="comment">&lt;!-- result 映射非主键字段 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"orderNo"</span> <span class="attr">column</span>=<span class="string">"order_no"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li><p>查询条件有时无法封装为一个对象，只能携带多个参数，两种解决办法：</p>
<ul>
<li><p>利用<code>HashMap</code>（推荐）</p>
<figure class="highlight vbnet"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="keyword">select</span> id=<span class="string">"xxx"</span> parameterType=<span class="string">"map"</span> resultMap=<span class="string">"campaignStats"</span>&gt;</div><div class="line">	<span class="keyword">Select</span> * <span class="keyword">FROM</span> CampaignStats <span class="keyword">Where</span> statsDate &gt;= <span class="meta">#&#123;start&#125; AND statsDate &lt;= #&#123;<span class="meta-keyword">end</span>&#125;</span></div><div class="line">&lt;/<span class="keyword">select</span>&gt;</div></pre></td></tr></table></figure>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="built_in">List</span>&lt;Sta&gt; xxx(<span class="built_in">Date</span> start, <span class="built_in">Date</span> end) &#123;</div><div class="line">	SqlSession session = sqlSessionFactory.openSession();</div><div class="line">	try &#123;</div><div class="line">		<span class="built_in">Map</span>&lt;<span class="built_in">String</span>, <span class="built_in">Date</span>&gt; <span class="built_in">map</span> = <span class="literal">new</span> HashMap&lt;&gt;();</div><div class="line">		<span class="built_in">map</span>.put(<span class="string">"start"</span>, start);</div><div class="line">		<span class="built_in">map</span>.put(<span class="string">"end"</span>, end);</div><div class="line">		<span class="built_in">List</span>&lt;Sta&gt; <span class="built_in">list</span> = session.selectList(<span class="string">"Sta.xxx"</span>, <span class="built_in">map</span>);</div><div class="line">		<span class="keyword">return</span> <span class="built_in">list</span>;</div><div class="line">	&#125; finally &#123;</div><div class="line">		session.close();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>利用Mybatis的多个参数传递方法</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="comment">&lt;!-- 没有 parameterType --&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"xxx"</span> <span class="attr">resultMap</span>=<span class="string">"campaignStats"</span>&gt;</span></div><div class="line">	Select * FROM CampaignStats Where statsDate &gt;= #<span class="template-variable">&#123;param1&#125;</span><span class="xml"> AND statsDate <span class="tag">&lt;<span class="name">=</span> #</span></span><span class="template-variable">&#123;param2&#125;</span><span class="xml"><span class="tag"></span></span></div><div class="line">&lt;/<span class="attr">select</span>&gt;</div></pre></td></tr></table></figure>
<figure class="highlight lasso"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="built_in">List</span>&lt;Sta&gt; xxx(<span class="built_in">Date</span> start, <span class="built_in">Date</span> end) &#123;</div><div class="line">	SqlSession session = sqlSessionFactory.openSession();</div><div class="line">	try &#123;</div><div class="line">		<span class="built_in">List</span>&lt;Sta&gt; <span class="built_in">list</span> = session.selectList(<span class="string">"Sta.xxx"</span>, start, end);</div><div class="line">		<span class="keyword">return</span> <span class="built_in">list</span>;</div><div class="line">	&#125; finally &#123;</div><div class="line">		session.close();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<hr>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</div><div class="line">	<span class="comment">// 一些属性</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">UserCustom</span> <span class="keyword">extends</span> <span class="title">User</span> </span>&#123;</div><div class="line">	<span class="comment">// 添加一些属性</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserQueryVo</span> </span>&#123;</div><div class="line">	<span class="comment">// 用户查询条件</span></div><div class="line">	<span class="keyword">private</span> UserCustom userCustom;</div><div class="line">	<span class="comment">// 可以包装其它的查询条件</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="comment">&lt;!-- $</span></span><span class="template-variable">&#123;userCustom.username&#125;</span><span class="xml"><span class="comment">：取出POJO包装对象中用户名称 --&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findUserList"</span> <span class="attr">parameterType</span>=<span class="string">"xxx.UserQueryVo"</span> <span class="attr">resultType</span>=<span class="string">"xxx.UserCustom"</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- #</span><span class="template-variable">&#123;userCustom.sex&#125;</span><span class="xml"><span class="comment">中的userCustom是UserQueryVo类中的userCustom属性 --&gt;</span></span></div><div class="line">	SELECT * FROM user WHERE user.username LIKE '%$<span class="template-variable">&#123;userCustom.username&#125;</span><span class="xml">%'</span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> List&lt;UserCustom&gt; <span class="title">findUserList</span><span class="params">(UserQueryVo userQueryVo)</span> <span class="keyword">throws</span> Exception</span>;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">UserMapper userMapper sqlSession.getMapper(UserMapper.class);</div><div class="line"></div><div class="line"><span class="comment">// 创建包装对象，设置查询条件</span></div><div class="line">UserQueryVo userQueryVo = <span class="keyword">new</span> UserQueryVo();</div><div class="line">UserCustom userCustom = <span class="keyword">new</span> UserCustom();</div><div class="line"></div><div class="line">userCustom.setUsername(<span class="string">"xxx"</span>);</div><div class="line">userQueryVo.setUserCustom(userCustom);</div><div class="line"></div><div class="line">List&lt;UserCustom&gt; list = userMapper.findUserList(userQueryVo);</div></pre></td></tr></table></figure>

				</div>
				<!-- about -->
				
			</div>
			<!-- pagination -->
			
			<div class="comment-section">
	
	


</div>
		</div>
		
	</div>


		<footer>
			 
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

		</footer>
	</div>
	<!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script> -->
	<script src="/js/highlight.js"></script> 
	<script>hljs.initHighlightingOnLoad();var timeEnd = new Date();console.log('耗时：' + (timeEnd - timeStart));</script>
	<!-- <script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>-->
	<!-- material design -->
	<!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script> -->
	<!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>-->
	<!-- toc -->
	<!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script> -->
	<!-- <script src="/libs/tocify/jquery.tocify.custom.js"></script> -->
	<!-- <script src="/js/main.js"></script> -->
</body>
</html>
