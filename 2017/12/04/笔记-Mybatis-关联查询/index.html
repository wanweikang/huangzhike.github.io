<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
				<script>var timeStart = new Date();</script>
		
		<title>[笔记]-Mybatis-关联查询 | 一个放笔记的地方而已</title>
		
		<meta name="author" content="Huangzhike">
		
		
		<meta name="description" content="没有鸡汤，只有笔记">
		
		
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		
		<meta property="og:title" content="[笔记]-Mybatis-关联查询"/>
		
		<meta property="og:site_name" content="一个放笔记的地方而已"/>
		
		
		<!-- favicon -->
		<link rel="icon" type="image/ico" href="/ok.ico" sizes="32x32">
 


		<meta name="msapplication-TileColor" content="#009688">
		<meta name="msapplication-TileImage" content="/mstile-144x144.ico">
		<meta name="theme-color" content="#009688">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Didact+Gothic"> 

		<!-- favicon end -->
		<!-- <link href="//ok.ico" rel="icon"> -->
		
		<!-- toc -->
		<!-- <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">-->
		<!-- material design -->
		<!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">-->
		<link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
		 
		 
		<!-- <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>-->
		<!-- <script>window.jQuery || document.write('<script src="/libs/jquery-3.1.1.slim.min.js" type="text/javascript"><\/script>')</script>-->
	</head>

<body>
	<nav class="navbar navbar-default">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">菜单</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/">一个放笔记的地方而已</a>
           
		</div>
		<div id="navbar" class="collapse navbar-collapse">
			<ul class="nav navbar-nav navbar-right">
				
				<li>
					<a href="https://huangzhike.github.io/" title="">
						<i class="fa fa-home"></i>Index
					</a>
				</li>
				
				<li>
					<a href="https://huangzhike.github.io/archives" title="">
						<i class="fa fa-list"></i>Archives
					</a>
				</li>
				
				<li>
					<a href="https://github.com/huangzhike" title="">
						<i class="fa fa-github"></i>GitHub
					</a>
				</li>
				
			</ul>
		</div>
	</div>
</nav>

	<div class="container" >
		<div class="row">
	
		<div class="col-md-9 center-content">
			
			<div class="content">
				<!-- index -->
				
				<h2>[笔记]-Mybatis-关联查询</h2>
				
				<div>
					<span class="post-time">2017-12-04 00:23:17</span>
				</div>	
				
				<div class="article-content">
				<p><strong>12-30重新整理</strong></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> teacher (t_id <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT, t_name <span class="built_in">VARCHAR</span>(<span class="number">20</span>));</div><div class="line"></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">class</span> (c_id <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT, c_name <span class="built_in">VARCHAR</span>(<span class="number">20</span>), teacher_id <span class="built_in">INT</span>);</div><div class="line"></div><div class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> <span class="keyword">class</span> <span class="keyword">ADD</span> <span class="keyword">CONSTRAINT</span> fk_teacher_id FOREIGN <span class="keyword">KEY</span> (teacher_id) <span class="keyword">REFERENCES</span> teacher (t_id);</div><div class="line"></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> student (s_id <span class="built_in">INT</span> PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT, s_name <span class="built_in">VARCHAR</span>(<span class="number">20</span>), class_id <span class="built_in">INT</span>);</div></pre></td></tr></table></figure>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> Teacher &#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id; <span class="comment">// id ==&gt; t_id</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">String</span> name; <span class="comment">// name ==&gt; t_name</span></div><div class="line">	<span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight zephir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Classes</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id; <span class="comment">// id ==&gt; c_id</span></div><div class="line">	<span class="keyword">private</span> String name; <span class="comment">// name ==&gt; c_name</span></div><div class="line">	<span class="comment">// 一对一，一个class对一个teacher</span></div><div class="line">	<span class="keyword">private</span> Teacher teacher; <span class="comment">// teacher_id ==&gt; teacher</span></div><div class="line">	<span class="comment">// 一对多，一个class对多个student</span></div><div class="line">	<span class="keyword">private</span> <span class="keyword">List</span>&lt;Student&gt; students;</div><div class="line">	<span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">Student</span> &#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id; <span class="comment">// id ==&gt; s_id</span></div><div class="line">	<span class="keyword">private</span> String name; <span class="comment">// name ==&gt; s_name</span></div><div class="line">	 <span class="comment">// 多对一，多个student对一个class</span></div><div class="line">	<span class="keyword">private</span> Classes <span class="keyword">class</span>; <span class="comment">// class_id ==&gt; class</span></div><div class="line">	<span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>方式一：多表单独查询<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="comment">&lt;!-- 第一步，根据id查class --&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getClass"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultMap</span>=<span class="string">"ClassResultMap"</span>&gt;</span></div><div class="line">	select * from class where c_id = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"xxx.Classes"</span> <span class="attr">id</span>=<span class="string">"ClassResultMap"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"c_id"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"c_name"</span>/&gt;</span></div><div class="line">	<span class="comment">&lt;!-- property：对象属性的名称 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- javaType：对象属性的类型 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- select：使用另一个查询封装的结果 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"teacher"</span> <span class="attr">column</span>=<span class="string">"teacher_id"</span> <span class="attr">javaType</span>=<span class="string">"xxx.Teacher"</span> <span class="attr">select</span>=<span class="string">"getTeacher"</span>/&gt;</span></div><div class="line">	<span class="comment">&lt;!-- ofType：集合中元素的类型 --&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- 第二步，column="c_id"，getStudent --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"students"</span> <span class="attr">column</span>=<span class="string">"c_id"</span> <span class="attr">ofType</span>=<span class="string">"xxx.Student"</span> <span class="attr">select</span>=<span class="string">"getStudent"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 关于column，有的说对应外键字段，有的说是用来传递参数的，好像都对？？？两种查询方式用法不同？？？ --&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 第三步，根据第一步结果的c_id搜索student，一共查了两次 --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 一对多查询 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getStudent"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"xxx.Student"</span>&gt;</span></div><div class="line">	SELECT s_id id, s_name name FROM student WHERE class_id = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 一对一查询 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getTeacher"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"xxx.Teacher"</span>&gt;</span></div><div class="line">	SELECT t_id id, t_name name FROM teacher WHERE t_id = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>嵌套关联查询：先得到一个结果集，然后根据这个结果集的每一条记录进行关联查询。</p>
<p>假设嵌套查询就一个（<code>resultMap</code>内就一个<code>association</code>），查询1次，查询的结果集返回N条，关联查询语句会被执行N次，共需要访问数据库N+1次。</p>
<p>如果N比较大的话，数据库访问非常大。</p>
<p>可以延迟加载：<code>&lt;association&gt;</code>和<code>&lt;collection&gt;</code>。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">settings</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 延迟加载 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"lazyLoadingEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 深度延迟加载 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"aggressiveLazyLoading"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 开启二级缓存 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">"cacheEnabled"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">settings</span>&gt;</span></div></pre></td></tr></table></figure>
<p>延迟加载：关联查询时，推迟对关联对象的查询。</p>
<p>关联对象的查询与主加载对象的查询必须是分别进行的<code>select</code>语句，不能是多表连接查询。</p>
<p>多表连接查询，其实是对多个表连接后形成的一张表的查询。</p>
<p>如果不调用<code>class.getTeacher()</code>，就不会去查询<code>Teacher</code>。</p>
<p>也就是把<code>Class</code>和<code>Teacher</code>的查询当做两步，然而不太合适<code>Blog</code>，因为看<code>Blog</code>同时都看<code>Author</code>，查询数据库两次。</p>
<p>嵌套结果查询一次查出结果。</p>
<p>方式二：多表连接查询<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="comment">&lt;!-- 多张表进连为一张表后查询 --&gt;</span></span></div><div class="line"><span class="comment">&lt;!-- 一对一：根据classId查询对应的班级信息，包括老师 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getClassOneToOne"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultMap</span>=<span class="string">"ClassResultMap"</span>&gt;</span></div><div class="line">	select * from class c, teacher t where c.teacher_id = t.t_id and c.c_id = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 一对多：根据classId查询对应的班级信息，包括学生，老师 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getClassOneToMany"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultMap</span>=<span class="string">"ClassResultMap"</span>&gt;</span></div><div class="line">	select * from class c, teacher t, student s </div><div class="line">		where c.teacher_id = t.t_id </div><div class="line">		and c.c_id = s.class_id </div><div class="line">		and c.c_id = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- resultMap映射查询结果字段到实体对象 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"xxx.Classes"</span> <span class="attr">id</span>=<span class="string">"ClassResultMap"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"c_id"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"c_name"</span>/&gt;</span></div><div class="line">	<span class="comment">&lt;!-- association解决一对一关联 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"teacher"</span> <span class="attr">javaType</span>=<span class="string">"xxx.Teacher"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"t_id"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"t_name"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">association</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- collection解决一对多关联 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"students"</span> <span class="attr">ofType</span>=<span class="string">"xxx.Student"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"s_id"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"s_name"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">collection</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div></pre></td></tr></table></figure></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 分开写法 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"xxx.Classes"</span> <span class="attr">id</span>=<span class="string">"ClassResultMap"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"c_id"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"c_name"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"teacher"</span> <span class="attr">javaType</span>=<span class="string">"xxx.Teacher"</span> <span class="attr">resultMap</span>=<span class="string">"TeacherResultMap"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"students"</span> <span class="attr">ofType</span>=<span class="string">"xxx.Student"</span> <span class="attr">resultMap</span>=<span class="string">"StudentResultMap"</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"xxx.Teacher"</span> <span class="attr">id</span>=<span class="string">"TeacherResultMap"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"t_id"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"t_name"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"xxx.Student"</span> <span class="attr">id</span>=<span class="string">"StudentResultMap"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"s_id"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"s_name"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- resultMap支持继承 --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 假设之前的resultMap只有association元素没有collection元素 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"xxx.Classes"</span> <span class="attr">id</span>=<span class="string">"ClassResultMap2"</span> <span class="attr">extends</span>=<span class="string">"ClassResultMap"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"students"</span> <span class="attr">ofType</span>=<span class="string">"xxx.Student"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"s_id"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"s_name"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">collection</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div></pre></td></tr></table></figure>
<p>多对一其实就是一对一</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="comment">&lt;!-- 多个学生对一个班 --&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Student"</span> <span class="attr">id</span>=<span class="string">"StudentResultMap"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"s_id"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"s_name"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"class"</span> <span class="attr">javaType</span>=<span class="string">"Classes"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"c_id"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"name"</span> <span class="attr">column</span>=<span class="string">"c_name"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">association</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getStudent"</span> <span class="attr">resultMap</span>=<span class="string">"StudentResultMap"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></div><div class="line">	SELECT c.*, s.*</div><div class="line">	FROM class c, student s</div><div class="line">	WHERE c.id = s.class_id AND s.s_id = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure>
<p>合作者和作者的结构式相同的，但是给了不同的别名，可以用<code>resultMap</code>的<code>columnPrefix</code>属性：</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">&lt;select id=<span class="string">"xxx"</span> resultMap=<span class="string">"blogResultWithAuthor"</span>&gt;</div><div class="line">	SELECT</div><div class="line">		<span class="selector-tag">b</span><span class="selector-class">.id</span> blog_id,</div><div class="line">		<span class="selector-tag">b</span><span class="selector-class">.author_id</span> blog_author_id,</div><div class="line">		<span class="selector-tag">a</span><span class="selector-class">.id</span> author_id,</div><div class="line">		<span class="selector-tag">a</span><span class="selector-class">.username</span> author_username,</div><div class="line">		ca<span class="selector-class">.id</span> co_author_id,</div><div class="line">		ca<span class="selector-class">.username</span> co_author_username</div><div class="line">	FROM blog <span class="selector-tag">b</span></div><div class="line">	LEFT OUTER JOIN author <span class="selector-tag">a</span> ON <span class="selector-tag">b</span><span class="selector-class">.author_id</span> = <span class="selector-tag">a</span><span class="selector-class">.id</span></div><div class="line">	LEFT OUTER JOIN author ca ON <span class="selector-tag">b</span><span class="selector-class">.co_author_id</span> = ca<span class="selector-class">.id</span></div><div class="line">	WHERE <span class="selector-tag">b</span><span class="selector-class">.id</span> = #&#123;id&#125;</div><div class="line">&lt;/select&gt;</div><div class="line">&lt;resultMap id=<span class="string">"blogResultWithAuthor"</span> type=<span class="string">"Blog"</span>&gt;</div><div class="line">	&lt;id property=<span class="string">"id"</span> column=<span class="string">"blog_id"</span>/&gt;</div><div class="line">	&lt;association property=<span class="string">"author"</span> resultMap=<span class="string">"authorResult"</span>/&gt;</div><div class="line">	&lt;association property=<span class="string">"coAuthor"</span> resultMap=<span class="string">"authorResult"</span> columnPrefix=<span class="string">"co_"</span>/&gt;</div><div class="line">&lt;/resultMap&gt;</div><div class="line">&lt;resultMap id=<span class="string">"authorResult"</span> type=<span class="string">"author"</span>&gt;</div><div class="line">	&lt;id property=<span class="string">"id"</span> column=<span class="string">"author_id"</span>/&gt;</div><div class="line">	&lt;result property=<span class="string">"username"</span> column=<span class="string">"author_username"</span>/&gt;</div><div class="line">&lt;/resultMap&gt;</div></pre></td></tr></table></figure>
<p>如果查询的表id字段同名：<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"xxx"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultMap</span>=<span class="string">"resultAticleList"</span>&gt;</span></span></div><div class="line">	<span class="comment">&lt;!--为主键id赋别名，避免冲突--&gt;</span></div><div class="line">	select users.id, article.id aid</div><div class="line">		from users, article where users.id = article.userid and users.id = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Article"</span> <span class="attr">id</span>=<span class="string">"resultAticleList"</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 如果有别名，别名就是column --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"aid"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"title"</span> <span class="attr">column</span>=<span class="string">"title"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">"user"</span> <span class="attr">javaType</span>=<span class="string">"User"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">association</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>查询商品不仅能按商品名查询，还能够根据所属的商店查询。</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="comment">&lt;!-- 两张表，shop和product，shop的主键作为product的外键 --&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"xxx"</span> <span class="attr">resultMap</span>=<span class="string">"BaseResultMap"</span> <span class="attr">parameterType</span>=<span class="string">"Map"</span> &gt;</span></div><div class="line">	select </div><div class="line">	<span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"Base_Column_List"</span>/&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 查询条件不能放到where中 --&gt;</span></div><div class="line">	from oms_product op left join oms_shop os on op.op_shop = os.os_id</div><div class="line">	<span class="tag">&lt;<span class="name">where</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"opName != null and opName != ''"</span>&gt;</span>and op.op_name like #<span class="template-variable">&#123;opName&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></div><div class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"osName != null and osName != ''"</span>&gt;</span>and os.os_name like #<span class="template-variable">&#123;osName&#125;</span><span class="xml"><span class="tag">&lt;/<span class="name">if</span>&gt;</span></span></div><div class="line">	<span class="tag">&lt;/<span class="name">where</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"start != null and size != null"</span>&gt;</span></div><div class="line">		limit #<span class="template-variable">&#123;start&#125;</span><span class="xml">, #</span><span class="template-variable">&#123;size&#125;</span><span class="xml"></span></div><div class="line">	<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure>
<p><code>resultType</code>查询<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 创建一个POJO继承包括查询字段较多的类，包含两个表的字段，映射到上面</span></div><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">ClassesCustom</span> <span class="keyword">extends</span> <span class="title">Classes</span> </span>&#123;</div><div class="line">	<span class="comment">// 已继承了Classes所有属性</span></div><div class="line">	<span class="comment">// 再定义Teacher的属性</span></div><div class="line">	<span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- resultType --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getClassesCustom"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span> <span class="attr">resultType</span>=<span class="string">"xxx.ClassesCustom"</span>&gt;</span></div><div class="line">	...</div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure>
<p>自关联：自己既是一方，又是多方。</p>
<p>一个栏目，可以是一方，即父栏目，也可以是多方，即子栏目。表中有一个外键，表示该栏目的父栏目。</p>
<ul>
<li><p>一对多：在页面上点击父栏目，显示出其子栏目。</p>
<ul>
<li><p>查指定栏目的所有子孙栏目</p>
<figure class="highlight actionscript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewsLabel</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> Integer id;</div><div class="line">	<span class="keyword">private</span> Set&lt;NewsLabel&gt; children;</div><div class="line">	<span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"xxx.NewsLabel"</span> <span class="attr">id</span>=<span class="string">"NewsLabelMap"</span>&gt;</span></span></div><div class="line">	<span class="comment">&lt;!-- 即使字段名与属性名相同，也要写出映射关系 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 第二步，根据第一次查询的结果中的id传给column="id"，递归查询所有下级栏目 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"children"</span> <span class="attr">ofType</span>=<span class="string">"xxx.NewsLabel"</span> <span class="attr">select</span>=<span class="string">"selectChildren"</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 第一步 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectChildren"</span> <span class="attr">resultMap</span>=<span class="string">"NewsLabelMap"</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 第一次pid动态参数来自调用方法传递的实参，递归后来自上一次的查询结果id --&gt;</span></div><div class="line">	select id from newslabel where pid = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>查指定栏目及其所有子孙栏目</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectNewsLabelByParentId"</span> <span class="attr">resultMap</span>=<span class="string">"NewsLabelMap"</span>&gt;</span></span></div><div class="line">	select id from newslabel where pid = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"xxx.NewsLabel"</span> <span class="attr">id</span>=<span class="string">"NewsLabelMap"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"children"</span> <span class="attr">ofType</span>=<span class="string">"xxx.NewsLabel"</span> <span class="attr">select</span>=<span class="string">"selectNewsLabelByParentId"</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 第一步 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"selectNewsLabelById"</span> <span class="attr">resultMap</span>=<span class="string">"NewsLabelMap"</span>&gt;</span></div><div class="line">	select id from newslabel where pid = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>多对一：如在网页上显示当前页面的站内位置。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NewsLabel</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> Integer id;</div><div class="line">	<span class="keyword">private</span> NewsLabel <span class="keyword">parent</span>;</div><div class="line">	<span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
  <figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">&lt;resultMap type=<span class="string">"xxx.NewsLabel"</span> <span class="built_in">id</span>=<span class="string">"NewsLabelMap"</span>&gt;</div><div class="line">	&lt;<span class="built_in">id</span> <span class="keyword">property</span>=<span class="string">"id"</span> column=<span class="string">"id"</span>/&gt;</div><div class="line">	&lt;association <span class="keyword">property</span>=<span class="string">"parent"</span> javaType=<span class="string">"xxx.NewsLabel"</span> select=<span class="string">"selectParentByParentId"</span> column=<span class="string">"pid"</span>/&gt;</div><div class="line">&lt;/resultMap&gt;</div><div class="line"></div><div class="line">&lt;select <span class="built_in">id</span>=<span class="string">"selectParentByParentId"</span> resultMap=<span class="string">"NewsLabelMap"</span>&gt;</div><div class="line">	select <span class="built_in">id</span>, pid <span class="keyword">from</span> newslabel <span class="keyword">where</span> <span class="built_in">id</span> = <span class="comment">#&#123;id&#125;</span></div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>多对多</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">user</span> (<span class="keyword">id</span> <span class="built_in">int</span>(<span class="number">10</span>) PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT);</div><div class="line"></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">group</span> (<span class="keyword">group_id</span> <span class="built_in">int</span>(<span class="number">10</span>) PRIMARY <span class="keyword">KEY</span> AUTO_INCREMENT);</div><div class="line"></div><div class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> user_group (user_id <span class="built_in">int</span>(<span class="number">10</span>), <span class="keyword">group_id</span> <span class="built_in">int</span>(<span class="number">10</span>));</div></pre></td></tr></table></figure>
<figure class="highlight zephir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> id;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">List</span>&lt;Group&gt; groups;</div><div class="line">	<span class="comment">// ...</span></div><div class="line">	<span class="comment">// 若是双向关联，双方的属性中均有对方对象作为域属性</span></div><div class="line">	<span class="comment">// 各自的toString()方法时只让某一方可以输出另一方即可</span></div><div class="line">	<span class="comment">// 不要让双方的toString()方法均可输出对方，这样会形成递归调用</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight zephir"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Group</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> groupId;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">List</span>&lt;User&gt; users;</div><div class="line">	<span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight axapta"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserGroup</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> userId;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">int</span> groupId;</div><div class="line">	<span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>嵌套查询方式<br><figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"Group"</span> <span class="attr">id</span>=<span class="string">"resultGroupMap_1"</span>&gt;</span></span></div><div class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">"users"</span> <span class="attr">column</span>=<span class="string">"group_id"</span> <span class="attr">select</span>=<span class="string">"mmp.Maper.UserGroupMaper.getUsersByGroupId"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 第一步，得到查询结果group_id --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getGroup"</span> <span class="attr">resultMap</span>=<span class="string">"resultGroupMap_1"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></div><div class="line">	SELECT * FROM group WHERE group_id = #<span class="template-variable">&#123;id&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure></p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="comment">&lt;!-- 根据组id查所有用户 --&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">type</span>=<span class="string">"mmp.pojo.User"</span> <span class="attr">id</span>=<span class="string">"resultUserMap_2"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">"id"</span> <span class="attr">column</span>=<span class="string">"id"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 第二步，传入group_id --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"getUsersByGroupId"</span> <span class="attr">resultMap</span>=<span class="string">"resultUserMap_2"</span> <span class="attr">parameterType</span>=<span class="string">"int"</span>&gt;</span></div><div class="line">	SELECT u.*, ug.group_id</div><div class="line">	FROM user u, user_group ug</div><div class="line">	WHERE u.id = ug.user_id AND ug.group_id = #<span class="template-variable">&#123;group_id&#125;</span><span class="xml"></span></div><div class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></div></pre></td></tr></table></figure>

				</div>
				<!-- about -->
				
			</div>
			<!-- pagination -->
			
			<div class="comment-section">
	
	


</div>
		</div>
		
	</div>


		<footer>
			 
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

		</footer>
	</div>
	<!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script> -->
	<script src="/js/highlight.js"></script> 
	<script>hljs.initHighlightingOnLoad();var timeEnd = new Date();console.log('耗时：' + (timeEnd - timeStart));</script>
	<!-- <script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>-->
	<!-- material design -->
	<!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script> -->
	<!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>-->
	<!-- toc -->
	<!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script> -->
	<!-- <script src="/libs/tocify/jquery.tocify.custom.js"></script> -->
	<!-- <script src="/js/main.js"></script> -->
</body>
</html>
