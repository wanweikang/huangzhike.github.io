<!DOCTYPE HTML>
<html>
	<head><meta name="generator" content="Hexo 3.9.0">
		<meta charset="utf-8">
		<script src="/js/highlight.js"></script>
				<script>hljs.initHighlightingOnLoad();var timeStart = new Date();</script>
		
		<title>[笔记]-Mybatis-动态SQL | 学而时习之</title>
		
		<meta name="author" content="Huangzhike">
		
		
		<meta name="description" content="K.I.S.S">
		
		
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		
		<meta property="og:title" content="[笔记]-Mybatis-动态SQL">
		
		<meta property="og:site_name" content="学而时习之">
		
		
		<!-- favicon -->
		<link rel="icon" type="image/ico" href="/ok.ico" sizes="32x32">
 


		<meta name="msapplication-TileColor" content="#009688">
		<meta name="msapplication-TileImage" content="/mstile-144x144.ico">
		<meta name="theme-color" content="#009688">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Didact+Gothic"> 

		<!-- favicon end -->
		<!-- <link href="//ok.ico" rel="icon"> -->
		
		<!-- toc -->
		<!-- <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">-->
		<!-- material design -->
		<!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">-->
		<link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
		 
		 
		<!-- <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>-->
		<!-- <script>window.jQuery || document.write('<script src="/libs/jquery-3.1.1.slim.min.js" type="text/javascript"><\/script>')</script>-->
	</head>
</html>
<body>
	<nav class="navbar navbar-default">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">菜单</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/">学而时习之</a>
           
		</div>
		<div id="navbar" class="collapse navbar-collapse">
			<ul class="nav navbar-nav navbar-right">
				
				<li>
					<a href="https://huangzhike.github.io/" title="">
						<i class="fa fa-home"></i>Index
					</a>
				</li>
				
				<li>
					<a href="https://huangzhike.github.io/archives" title="">
						<i class="fa fa-list"></i>Archives
					</a>
				</li>
				
				<li>
					<a href="https://github.com/huangzhike" title="">
						<i class="fa fa-github"></i>GitHub
					</a>
				</li>
				
			</ul>
		</div>
	</div>
</nav>

	<div class="container" >
		<div class="row">
	
		<div class="col-md-9 center-content">
			
			<div class="content">
				<!-- index -->
				
				<h2>[笔记]-Mybatis-动态SQL</h2>
				
				<div>
					<div class="post-time">2017-12-04</div>
				</div>
				
				<div class="article-content">
				<p><strong>12-29重新整理</strong>，修改了一些错误</p>
<ul>
<li><code>if</code>：条件判断</li>
<li><code>choose</code>：(<code>when</code>, <code>otherwize</code>)，相当于<code>switch</code>，类似JSTL的<code>choose</code></li>
<li><code>trim</code>：对包含的内容加<code>prefix</code>或<code>suffix</code>，前缀或后缀</li>
<li><code>where</code>：简化SQL语句中<code>where</code>条件判断，智能处理<code>and</code>，<code>or</code>，不必担心多余导致语法错误</li>
<li><code>set</code>：更新</li>
<li><code>foreach</code>：<code>in</code>语句查询</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;xxx&quot; resultType=&quot;Blog&quot;&gt;</span><br><span class="line">	SELECT * FROM BLOG WHERE </span><br><span class="line">	&lt;if test=&quot;state != null&quot;&gt;</span><br><span class="line">		state = #&#123;state&#125;</span><br><span class="line">	&lt;/if&gt; </span><br><span class="line">	&lt;if test=&quot;author != null and author.name != null&quot;&gt;</span><br><span class="line">		AND author_name like #&#123;author.name&#125;</span><br><span class="line">	&lt;/if&gt;</span><br><span class="line">	&lt;!-- 如果没有一个匹配上，会变成：SELECT * FROM BLOG WHERE --&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;xxx&quot; resultType=&quot;Blog&quot;&gt;</span><br><span class="line">	SELECT * FROM BLOG </span><br><span class="line">	&lt;where&gt;</span><br><span class="line">		&lt;if test=&quot;state != null&quot;&gt;</span><br><span class="line">			state = #&#123;state&#125;</span><br><span class="line">		&lt;/if&gt; </span><br><span class="line">		&lt;if test=&quot;author != null and author.name != null and author.name !=&apos;&apos; &quot;&gt;</span><br><span class="line">			AND author_name LIKE CONCAT(CONCAT(&apos;%&apos;, #&#123;author.name, jdbcType = VARCHAR&#125;), &apos;%&apos;)</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">	&lt;/where&gt;</span><br><span class="line">	&lt;!-- 如果&lt;where/&gt;包含中有返回值的话，插入一个where --&gt;</span><br><span class="line">	&lt;!-- 如果返回的内容以AND或OR开头，剔除掉 --&gt;</span><br><span class="line">	&lt;!-- &lt;where/&gt;中不需要考虑空格，会智能加上 --&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;xxx&quot; resultType=&quot;Blog&quot;&gt;</span><br><span class="line">	SELECT * FROM BLOG WHERE state = &apos;ACTIVE&apos;</span><br><span class="line">	&lt;choose&gt;</span><br><span class="line">		&lt;when test=&quot;title != null&quot;&gt;</span><br><span class="line">			AND title like #&#123;title&#125;</span><br><span class="line">		&lt;/when&gt;</span><br><span class="line">		&lt;when test=&quot;author != null and author.name != null&quot;&gt;</span><br><span class="line">			AND author_name like #&#123;author.name&#125;</span><br><span class="line">		&lt;/when&gt;</span><br><span class="line">		&lt;otherwise&gt;</span><br><span class="line">			AND featured = 1</span><br><span class="line">		&lt;/otherwise&gt;</span><br><span class="line">	&lt;/choose&gt;</span><br><span class="line">	&lt;!-- 所有的when和otherwise中，只有一个输出，所有条件都不满足时输出otherwise中内容 --&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<p><code>prefix</code>和<code>suffix</code>：在包含的内容加上前缀或后缀。</p>
<p><code>prefixOverrides</code>和<code>suffixOverrides</code>：属性中指定的内容将被移除，插入<code>prefix</code>和<code>suffix</code>属性中指定的内容。</p>
<p><code>trim</code>代替<code>where</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;xxx&quot; parameterType=&quot;Blog&quot; resultType=&quot;Blog&quot;&gt;</span><br><span class="line">	select * from t_blog </span><br><span class="line">	&lt;trim prefix=&quot;where&quot; prefixOverrides=&quot;and |or&quot;&gt;</span><br><span class="line">		&lt;if test=&quot;title != null&quot;&gt;</span><br><span class="line">			title = #&#123;title&#125;</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">		&lt;if test=&quot;content != null&quot;&gt;</span><br><span class="line">			and content = #&#123;content&#125;</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">		&lt;if test=&quot;owner != null&quot;&gt;</span><br><span class="line">			or owner = #&#123;owner&#125;</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">	&lt;/trim&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></p>
<p><code>trim</code>代替<code>set</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;update id=&quot;xxx&quot; parameterType=&quot;User&quot;&gt;</span><br><span class="line">	UPDATE user</span><br><span class="line">	&lt;trim prefix=&quot;SET&quot; suffixOverrides=&quot;,&quot;&gt;</span><br><span class="line">		&lt;if test=&quot;username != null and username != &apos;&apos; &quot;&gt;</span><br><span class="line">			username = #&#123;username&#125;,</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">		&lt;if test=&quot;sex != null and sex != &apos;&apos; &quot;&gt;</span><br><span class="line">			sex = #&#123;sex&#125;,</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">		&lt;if test=&quot;birthday != null &quot;&gt;</span><br><span class="line">			birthday = #&#123;birthday&#125;,</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">	&lt;/trim&gt;</span><br><span class="line">	WHERE user_id = #&#123;user_id&#125;</span><br><span class="line">&lt;/update&gt;</span><br></pre></td></tr></table></figure></p>
<p><code>set</code>主要用于更新。</p>
<p><code>update</code>语句中没用<code>if</code>标签时，如果有一个参数为<code>null</code>，导致错误。</p>
<p><code>update</code>语句中使用<code>if</code>标签时，如果前面的<code>if</code>没有执行，或导致逗号多余错误。</p>
<p><code>set</code>标签动态前置<code>SET</code>关键字，同时消除无关的逗号。</p>
<p>用<code>if</code>+<code>set</code>标签后，如果某项为<code>null</code>则不更新，保持原值。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;update id=&quot;xxx&quot; parameterType=&quot;Blog&quot;&gt;</span><br><span class="line">	update t_blog</span><br><span class="line">	&lt;set&gt;</span><br><span class="line">		&lt;if test=&quot;title != null&quot;&gt;title = #&#123;title&#125;,&lt;/if&gt;</span><br><span class="line">		&lt;if test=&quot;content != null&quot;&gt;content = #&#123;content&#125;,&lt;/if&gt;</span><br><span class="line">		&lt;if test=&quot;owner != null&quot;&gt;owner = #&#123;owner&#125;&lt;/if&gt;</span><br><span class="line">	&lt;/set&gt;</span><br><span class="line">	where id = #&#123;id&#125;</span><br><span class="line">&lt;/update&gt;</span><br></pre></td></tr></table></figure>
<p><code>foreach</code>的主要构建<code>in</code>条件，迭代一个集合。</p>
<ul>
<li><code>item</code>：遍历的对象。</li>
<li><code>index</code>：迭代过程中，每次迭代到的位置。</li>
<li><code>open</code>：开始遍历时拼接的SQL串。</li>
<li><code>close</code>：结束遍历时拼接的SQL串。</li>
<li><code>separator</code>：遍历的两个对象中需要拼接的SQL串。</li>
<li><code>collection</code>：输入对象中的集合属性：<ul>
<li>传入的是单参数且是<code>List</code>。</li>
<li>传入的是单参数且是<code>array</code>数组。</li>
<li>传入多参数，需要封装成<code>Map</code>。</li>
</ul>
</li>
</ul>
<p>List<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;xxx&quot; resultType=&quot;Blog&quot;&gt;</span><br><span class="line">	select * from t_blog where id in</span><br><span class="line">	&lt;foreach collection=&quot;list&quot; index=&quot;index&quot; item=&quot;item&quot; open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot;&gt;</span><br><span class="line">		#&#123;item&#125;</span><br><span class="line">	&lt;/foreach&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;Blog&gt; xxx(List&lt;Integer&gt; ids);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">BlogMapper blogMapper = session.getMapper(BlogMapper.class);</span><br><span class="line"></span><br><span class="line">List&lt;Integer&gt; ids = new ArrayList&lt;&gt;();</span><br><span class="line">ids.add(1);</span><br><span class="line">ids.add(3);</span><br><span class="line"></span><br><span class="line">List&lt;Blog&gt; blogs = blogMapper.xxx(ids);</span><br><span class="line">for (Blog blog : blogs)</span><br><span class="line">	System.out.println(blog);</span><br></pre></td></tr></table></figure>
<p>数组<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;xxx&quot; resultType=&quot;Blog&quot;&gt;</span><br><span class="line">	select * from t_blog where id in</span><br><span class="line">	&lt;foreach collection=&quot;array&quot; index=&quot;index&quot; item=&quot;item&quot; open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot;&gt;</span><br><span class="line">		#&#123;item&#125;</span><br><span class="line">	&lt;/foreach&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;Blog&gt; xxx(int[] ids);</span><br></pre></td></tr></table></figure>
<p>Map<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;select id=&quot;xxx&quot; resultType=&quot;Blog&quot;&gt;</span><br><span class="line">	select * from t_blog where title like &quot;%&quot;#&#123;title&#125;&quot;%&quot; and id in</span><br><span class="line">	&lt;foreach collection=&quot;ids&quot; index=&quot;index&quot; item=&quot;item&quot; open=&quot;(&quot; separator=&quot;,&quot; close=&quot;)&quot;&gt;</span><br><span class="line">		#&#123;item&#125;</span><br><span class="line">	&lt;/foreach&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">public List&lt;Blog&gt; xxx(Map&lt;String, Object&gt; params);</span><br></pre></td></tr></table></figure>
<p>使用多个id进行查询，存储多个id的<code>List</code>放到UserQueryVo中作为一个属性：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">private List&lt;Integer&gt; ids;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM USER WHERE id = 1 OR id = 12 OR id = 17;</span><br><span class="line">SELECT * FROM USER WHERE id IN (1, 12, 17);</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- SQL片段 --&gt;</span><br><span class="line">&lt;sql id=&quot;query_user_where&quot;&gt;</span><br><span class="line">	&lt;if test=&quot;user != null&quot;&gt;</span><br><span class="line">		&lt;if test=&quot;user.username != null and user.username != &apos;&apos;&quot;&gt;</span><br><span class="line">			and user.username like &apos;%$&#123;user.username&#125;%&apos;</span><br><span class="line">		&lt;/if&gt;</span><br><span class="line">	&lt;/if&gt;</span><br><span class="line">	&lt;if test=&quot;ids != null&quot;&gt;</span><br><span class="line">		&lt;!-- 使用右边的sql拼接：AND (id = 1 OR id = 12 OR id = 17) --&gt;</span><br><span class="line">		&lt;foreach collection=&quot;ids&quot; item=&quot;user_id&quot; open=&quot;AND (&quot; close=&quot;)&quot; separator=&quot;OR&quot;&gt;</span><br><span class="line">			id=#&#123;user_id&#125;</span><br><span class="line">		&lt;/foreach&gt;</span><br><span class="line">	&lt;/if&gt;</span><br><span class="line">&lt;/sql&gt;</span><br><span class="line"></span><br><span class="line">&lt;select id=&quot;findUserList&quot; parameterType=&quot;UserQueryVo&quot; resultType=&quot;User&quot;&gt;</span><br><span class="line">	select * from user</span><br><span class="line">	&lt;where&gt;</span><br><span class="line">		&lt;!-- 引用SQL片段的id，如果refid指定的id不在本mapper文件中，需要在前面加上namespace --&gt;</span><br><span class="line">		&lt;include refid=&quot;query_user_where&quot;&gt;&lt;/include&gt;</span><br><span class="line">	&lt;/where&gt;</span><br><span class="line">&lt;/select&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 使用右边的sql拼接：AND id IN(1, 12, 17) --&gt;</span><br><span class="line">&lt;foreach collection=&quot;ids&quot; item=&quot;user_id&quot; open=&quot;AND id IN(&quot; close=&quot;)&quot; separator=&quot;,&quot;&gt;</span><br><span class="line">	#&#123;user_id&#125;</span><br><span class="line">&lt;/foreach&gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">UserMapper userMapper = sqlSession.getMapper(UserMapper.class);</span><br><span class="line"></span><br><span class="line">// 创建包装对象，设置查询条件</span><br><span class="line">UserQueryVo userQueryVo = new UserQueryVo();</span><br><span class="line">User user = new User();</span><br><span class="line">// 这里使用动态sql，如果不设置某个值，条件不会拼接在sql中</span><br><span class="line">user.setUsername(&quot;&quot;);</span><br><span class="line"></span><br><span class="line">// 传入多个id</span><br><span class="line">List&lt;Integer&gt; ids = new ArrayList&lt;Integer&gt;();</span><br><span class="line">ids.add(1);</span><br><span class="line">ids.add(12);</span><br><span class="line"></span><br><span class="line">userQueryVo.setIds(ids);</span><br><span class="line">userQueryVo.setUser(user);</span><br><span class="line"></span><br><span class="line">// 调用userMapper的方法</span><br><span class="line">List&lt;User&gt; list = userMapper.findUserList(userQueryVo);</span><br></pre></td></tr></table></figure>
<p>动态SQL若出现大于号<code>&gt;</code>、小于号<code>&lt;</code>、大于等于号<code>&gt;=</code>，小于等于号<code>&lt;=</code>，最好转换为实体符号，否则可能会出现解析出错问题。</p>
<p>特别是小于号<code>&lt;</code>，在XML中绝对不能出现。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// 提供CRUD对应的SQL语句</span><br><span class="line">public class CategoryDynaSqlProvider &#123;</span><br><span class="line">	public String list() &#123;</span><br><span class="line">		return new SQL().SELECT(&quot;*&quot;).FROM(&quot;category_&quot;).toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String get() &#123;</span><br><span class="line">		return new SQL().SELECT(&quot;*&quot;).FROM(&quot;category_&quot;).WHERE(&quot;id = #&#123;id&#125;&quot;).toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String add() &#123;</span><br><span class="line">		return new SQL().INSERT_INTO(&quot;category_&quot;).VALUES(&quot;name&quot;, &quot;#&#123;name&#125;&quot;).toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String update() &#123;</span><br><span class="line">		return new SQL().UPDATE(&quot;category_&quot;).SET(&quot;name = #&#123;name&#125;&quot;).WHERE(&quot;id = #&#123;id&#125;&quot;).toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	public String delete() &#123;</span><br><span class="line">		return new SQL().DELETE_FROM(&quot;category_&quot;).WHERE(&quot;id = #&#123;id&#125;&quot;).toString();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>手写SQL语句<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@Insert(&quot;insert into category_ (name) values (#&#123;name&#125;)&quot;)</span><br><span class="line">public int add(Category category);</span><br></pre></td></tr></table></figure></p>
<p>改成<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">// CategoryDynaSqlProvider的add方法</span><br><span class="line">@InsertProvider(type = CategoryDynaSqlProvider.class, method = &quot;add&quot;)</span><br><span class="line">public int add(Category category);</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public interface CategoryMapper &#123;</span><br><span class="line"></span><br><span class="line">	@InsertProvider(type = CategoryDynaSqlProvider.class, method = &quot;add&quot;)</span><br><span class="line">	public int add(Category category);</span><br><span class="line"></span><br><span class="line">	@DeleteProvider(type = CategoryDynaSqlProvider.class, method = &quot;delete&quot;)</span><br><span class="line">	public void delete(int id);</span><br><span class="line"></span><br><span class="line">	@SelectProvider(type = CategoryDynaSqlProvider.class, method = &quot;get&quot;)</span><br><span class="line">	public Category get(int id);</span><br><span class="line"></span><br><span class="line">	@UpdateProvider(type = CategoryDynaSqlProvider.class, method = &quot;update&quot;)</span><br><span class="line">	public int update(Category category);</span><br><span class="line"></span><br><span class="line">	@SelectProvider(type = CategoryDynaSqlProvider.class, method = &quot;list&quot;)</span><br><span class="line">	public List&lt;Category&gt; list();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

				</div>
				<!-- about -->
				
			</div>
			<!-- pagination -->
			
			<div class="comment-section">
	
	


</div>
		</div>
		
	</div>


		<footer>
			 
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

		</footer>
	</div>
	<!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script> -->

	<script>var timeEnd = new Date();console.log('耗时：' + (timeEnd - timeStart));</script>
	<!-- <script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>-->
	<!-- material design -->
	<!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script> -->
	<!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>-->
	<!-- toc -->
	<!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script> -->
	<!-- <script src="/libs/tocify/jquery.tocify.custom.js"></script> -->
	<!-- <script src="/js/main.js"></script> -->
</body>
</html>
