<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
				<script>var timeStart = new Date();</script>
		
		<title>[笔记]-Struts2 | 一个放笔记的地方而已</title>
		
		<meta name="author" content="Huangzhike">
		
		
		<meta name="description" content="用手记笔记，用心记笔记，用脑记笔记">
		
		
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		
		<meta property="og:title" content="[笔记]-Struts2"/>
		
		<meta property="og:site_name" content="一个放笔记的地方而已"/>
		
		
		<!-- favicon -->
		<link rel="icon" type="image/ico" href="/favicon.ico" sizes="32x32">
 


		<meta name="msapplication-TileColor" content="#009688">
		<meta name="msapplication-TileImage" content="/mstile-144x144.ico">
		<meta name="theme-color" content="#009688">

		    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Didact+Gothic"> 

		<!-- favicon end -->
		<!-- <link href="//favicon.ico" rel="icon"> -->
		
		<!-- toc -->
		<!-- <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">-->
		<!-- material design -->
		<!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">-->
		<link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
		 
		 
		<!-- <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>-->
		<!-- <script>window.jQuery || document.write('<script src="/libs/jquery-3.1.1.slim.min.js" type="text/javascript"><\/script>')</script>-->
	</head>

<body>
	<nav class="navbar navbar-default">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">菜单</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/">一个放笔记的地方而已</a>
           
		</div>
		<div id="navbar" class="collapse navbar-collapse">
			<ul class="nav navbar-nav navbar-right">
				
				<li>
					<a href="https://huangzhike.github.io/" title="">
						<i class="fa fa-home"></i>Index
					</a>
				</li>
				
				<li>
					<a href="https://huangzhike.github.io/archives" title="">
						<i class="fa fa-list"></i>Archives
					</a>
				</li>
				
				<li>
					<a href="https://github.com/huangzhike" title="我的主页">
						<i class="fa fa-github"></i>GitHub
					</a>
				</li>
				
			</ul>
		</div>
	</div>
</nav>

	<div class="container" >
		<div class="row">
	
		<div class="col-md-9 center-content">
			
			<div class="content">
				<!-- index -->
				
				<h2>[笔记]-Struts2</h2>
				
				<div>
					<span class="post-time">2017-12-21 09:55:17</span>
				</div>	
				
				<div class="article-content">
				<p><strong>12-28重新整理更新Struts2笔记</strong></p>
<p>web.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- org.apache.struts2.dispatcher.FilterDispatcher 在 Struts 2.1.3 中被废弃 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>struts2<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>WEB-INF/classes/struts.properties</p>
<p>struts.properties中属性可以在web.xml中用<code>init-param</code>，或在struts.xml中用<code>constant</code>替代。</p>
<figure class="highlight nix"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">struts.<span class="attr">devMode</span> = <span class="literal">true</span></div><div class="line">struts.i18n.<span class="attr">reload</span> = <span class="literal">true</span></div><div class="line">struts.configuration.xml.<span class="attr">reload</span> = <span class="literal">true</span></div><div class="line"><span class="comment">### Sets the port that the server is run on</span></div><div class="line">struts.url.http.<span class="attr">port</span> = <span class="number">8080</span></div></pre></td></tr></table></figure>
<p>log4j.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span> <span class="meta">?&gt;</span></span></div><div class="line"><span class="meta">&lt;!DOCTYPE log4j:configuration PUBLIC "-//log4j/log4j Configuration//EN" "log4j.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">log4j:configuration</span> <span class="attr">xmlns:log4j</span>=<span class="string">"http://jakarta.apache.org/log4j/"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">appender</span> <span class="attr">name</span>=<span class="string">"STDOUT"</span> <span class="attr">class</span>=<span class="string">"org.apache.log4j.ConsoleAppender"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">layout</span> <span class="attr">class</span>=<span class="string">"org.apache.log4j.PatternLayout"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"ConversionPattern"</span> <span class="attr">value</span>=<span class="string">"%d %-5p %c.%M:%L - %m%n"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">layout</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">appender</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- specify the logging level for loggers from other libraries --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"com.opensymphony"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">"DEBUG"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">logger</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">logger</span> <span class="attr">name</span>=<span class="string">"org.apache.struts2"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">level</span> <span class="attr">value</span>=<span class="string">"DEBUG"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">logger</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- for all other loggers log only info and above log messages --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">root</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">priority</span> <span class="attr">value</span>=<span class="string">"INFO"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">appender-ref</span> <span class="attr">ref</span>=<span class="string">"STDOUT"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">root</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">log4j:configuration</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>模型类<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> mmp.bean;</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MessageStore</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">String</span> message;</div><div class="line">	<span class="comment">// getters setters</span></div><div class="line">	<span class="keyword">public</span> MessageStore() &#123;</div><div class="line">		setMessage(<span class="string">"Hello Struts User"</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Action类<br><figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> mmp.action;</div><div class="line"></div><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</div><div class="line">	 <span class="comment">// 对应前台的参数</span></div><div class="line">	<span class="keyword">private</span> <span class="type">MessageStore</span> messageStore;</div><div class="line">	<span class="comment">// getters setters</span></div><div class="line"></div><div class="line">	public <span class="type">String</span> execute() <span class="keyword">throws</span> <span class="type">Exception</span> &#123;</div><div class="line">		messageStore = <span class="keyword">new</span> <span class="type">MessageStore</span>();</div><div class="line">		<span class="comment">// 前台jsp中要写成&lt;input type="text" name="messageStore.message"/&gt;</span></div><div class="line">		<span class="type">System</span>.out.println(messageStore.message);</div><div class="line">		<span class="keyword">return</span> <span class="type">SUCCESS</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>struts.xml<br><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="php"><span class="meta">&lt;?</span>xml version=<span class="string">"1.0"</span> encoding=<span class="string">"UTF-8"</span><span class="meta">?&gt;</span></span></div><div class="line"><span class="meta">&lt;!DOCTYPE struts PUBLIC</span></div><div class="line">	"-//Apache Software Foundation//DTD Struts Configuration 2.0//EN"</div><div class="line">	"http://struts.apache.org/dtds/struts-2.0.dtd"&gt;</div><div class="line"><span class="tag">&lt;<span class="name">struts</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 开发环境，查看日志 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.devMode"</span> <span class="attr">value</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 更改.action 为 .html 的扩展名 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- &lt;constant name="struts.action.extension" value="html"/&gt; --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 不使用扩展 http://localhost:8080/xxx/xxx --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">constant</span> <span class="attr">name</span>=<span class="string">"struts.action.extension"</span> <span class="attr">value</span>=<span class="string">""</span>/&gt;</span></div><div class="line">	<span class="comment">&lt;!-- namespace 命名空间 与下面的action组成URL --&gt;</span></div><div class="line"></div><div class="line">	<span class="comment">&lt;!-- &lt;include file="my-struts1.xml"/&gt; --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- &lt;include file="my-struts2.xml"/&gt; --&gt;</span></div><div class="line"></div><div class="line">	<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"basicstruts2"</span> <span class="attr">extends</span>=<span class="string">"struts-default"</span> <span class="attr">namespace</span>=<span class="string">"/"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"index"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">result</span>&gt;</span>index.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 映射一个action到class --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"hello"</span> <span class="attr">class</span>=<span class="string">"mmp.action.HelloWorldAction"</span> <span class="attr">method</span>=<span class="string">"execute"</span>&gt;</span></div><div class="line">			<span class="comment">&lt;!-- 映射一个结果success到View HelloWorld.jsp --&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span> <span class="attr">type</span>=<span class="string">"dispatcher"</span>&gt;</span>HelloWorld.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></div><div class="line">			<span class="comment">&lt;!-- type：使用什么方式进入，如重定向、转跳 --&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">action</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">package</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">struts</span>&gt;</span></div></pre></td></tr></table></figure></p>
<p>index.jsp<br><figure class="highlight fsharp"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">&lt;input <span class="class"><span class="keyword">type</span></span>=<span class="string">"text"</span> name=<span class="string">"messageStore.message"</span>&gt;</div><div class="line">&lt;input <span class="class"><span class="keyword">type</span></span>=<span class="string">"submit"</span> value=<span class="string">"submit"</span>&gt;</div></pre></td></tr></table></figure></p>
<p>View: HelloWorld.jsp<br><figure class="highlight erb"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span></span><span class="xml"><span class="tag">%&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">%</span></span><span class="ruby">@ taglib prefix=<span class="string">"s"</span> uri=<span class="string">"/struts-tags"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></div><div class="line"><span class="comment">&lt;!-- HelloWorldAction类的getMessageStore()方法返回值 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"messageStore.message"</span>/&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- EL表达式 --&gt;</span></div><div class="line"><span class="comment">&lt;!-- Struts通过Action的getter()方法返回对象 --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 通过request.setAttribute("messageStore", messageStore); 放在messageStore这个key上 --&gt;</span></div><div class="line">$&#123;messageStore.message&#125;</div></pre></td></tr></table></figure></p>
<p>index.jsp提交<code>messageStore.message</code>到action，action又跳转回HelloWorld.jsp把提交上来的显示出来。</p>
<p>提交数据是<code>messageStore.message</code>，会自动调用对应的Action的settter方法注入。</p>
<p>实现Action类三种方法</p>
<ul>
<li><p>直接用</p>
<figure class="highlight cs"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">HelloWorld</span> &#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="string">"ok"</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p><code>Action</code>接口</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld2</span> <span class="keyword">implements</span> <span class="title">Action</span> </span>&#123;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">execute</span><span class="params">()</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		<span class="keyword">return</span> SUCCESS;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>继承<code>ActionSupport</code>（最常用）</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">HelloWorld3</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	public <span class="type">String</span> execute() <span class="keyword">throws</span> <span class="type">Exception</span> &#123;</div><div class="line">		<span class="keyword">return</span> <span class="type">ERROR</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<p>要么有返回值，要么没有，返回值只能是<code>String</code>类型。</p>
<p>没有返回值，可以用<code>void</code>设置返回值为空，也可以用<code>return &quot;none&quot;;</code>，这种情况不需要在配置文件中写<code>result</code>。</p>
<p>继承的<code>ActionSupport</code>提供了字符串。<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Action</span> </span>&#123;</div><div class="line">	<span class="keyword">String</span> SUCCESS = <span class="string">"success"</span>;</div><div class="line">	<span class="keyword">String</span> NONE = <span class="string">"none"</span>;</div><div class="line">	<span class="keyword">String</span> ERROR = <span class="string">"error"</span>;</div><div class="line">	<span class="keyword">String</span> INPUT = <span class="string">"input"</span>;</div><div class="line">	<span class="keyword">String</span> LOGIN = <span class="string">"login"</span>;</div><div class="line">	<span class="keyword">String</span> execute() throws Exception;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>Action类访问方法</p>
<ul>
<li><p>使用<code>method</code>属性</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">&lt;action <span class="built_in">name</span>=<span class="string">"order"</span> <span class="built_in">class</span>=<span class="string">"xxx.OrderAction"</span> method=<span class="string">"add"</span>&gt;</div><div class="line">	&lt;<span class="literal">result</span> <span class="built_in">name</span>=<span class="string">"success"</span> type=<span class="string">"dispatcher"</span>&gt;<span class="keyword">error</span>.jsp&lt;/<span class="literal">result</span>&gt;</div><div class="line">&lt;/action&gt;</div></pre></td></tr></table></figure>
</li>
<li><p>通配符配置（Action中有很多方法）</p>
<figure class="highlight dust"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="comment">&lt;!-- 地址为useradd访问的是userAction的add方法 --&gt;</span></span></div><div class="line"><span class="tag">&lt;<span class="name">action</span> <span class="attr">name</span>=<span class="string">"user*"</span> <span class="attr">class</span>=<span class="string">"xxx.UserAction"</span> <span class="attr">method</span>=<span class="string">"</span></span><span class="template-variable">&#123;1&#125;</span><span class="xml"><span class="tag"><span class="string">"</span>&gt;</span></span></div><div class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>success.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<p>获取表单数据三种方法</p>
<ul>
<li><p><code>ActionContext</code>（用的比较少）</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="attribute">ActionContext actionContext</span> = ActionContext.getContext();</div><div class="line"><span class="attribute">Map map</span> = actionContext.getParameters();</div><div class="line"><span class="attribute">String username</span> = (String) map.get(<span class="string">"username"</span>);</div></pre></td></tr></table></figure>
</li>
<li><p><code>ServletActionContext</code>（继承<code>ActionContext</code>，类似Servlet获取）</p>
<figure class="highlight abnf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">HttpServletRequest request = ServletActionContext.getRequest()<span class="comment">;</span></div><div class="line">String username = request.getParameter(<span class="string">"username"</span>)<span class="comment">;</span></div><div class="line">System.out.println(username)<span class="comment">;</span></div></pre></td></tr></table></figure>
</li>
<li><p>接口注入</p>
<ul>
<li><p>属性封装：将表单的值封装到属性。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">Data</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</div><div class="line">	<span class="comment">// 属性名和表单名一致</span></div><div class="line">	<span class="keyword">private</span> <span class="type">String</span> username;</div><div class="line">	<span class="comment">// getters setters</span></div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	public <span class="type">String</span> execute() <span class="keyword">throws</span> <span class="type">Exception</span> &#123;</div><div class="line">		<span class="type">System</span>.out.println(username);</div><div class="line">		<span class="keyword">return</span> <span class="type">NONE</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>模型驱动封装：将表单的值封装到对象。实现接口<code>ModelDriven&lt;T&gt;</code> T为要封装Model。</p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">CustomerAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> <span class="title">implements</span> <span class="title">ModelDriven</span> </span>&#123;</div><div class="line">	<span class="comment">// 必须手动初始化</span></div><div class="line">	<span class="type">Customer</span> customer = <span class="keyword">new</span> <span class="type">Customer</span>();</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	public <span class="type">String</span> execute() <span class="keyword">throws</span> <span class="type">Exception</span> &#123;&#125;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	public <span class="type">Object</span> getModel() &#123;</div><div class="line">		<span class="comment">// 返回创建的对象</span></div><div class="line">		<span class="keyword">return</span> customer;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> Customer &#123;</div><div class="line">	<span class="keyword">String</span> name;</div><div class="line">	<span class="keyword">int</span> age;</div><div class="line">	<span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">s:form</span> <span class="attr">action</span>=<span class="string">"customerAction"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">s:textfield</span> <span class="attr">name</span>=<span class="string">"name"</span> <span class="attr">label</span>=<span class="string">"Name"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">s:textfield</span> <span class="attr">name</span>=<span class="string">"age"</span> <span class="attr">label</span>=<span class="string">"Age"</span> <span class="attr">value</span>=<span class="string">""</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">s:submit</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">s:form</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
<p>两个Session：</p>
<ul>
<li>servlet包下的<code>HttpSession</code></li>
<li>Struts自定义的<code>Session</code></li>
</ul>
<figure class="highlight protobuf"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">HttpServletRequest request = ServletActionContext.getRequest();</div><div class="line">HttpServletResponse response = ServletActionContext.getResponse();</div><div class="line">HttpSession session = ServletActionContext.getRequest().getSession();</div><div class="line">ServletContext context = ServletActionContext.getServletContext();</div><div class="line"></div><div class="line">Map m = ActionContext.getContext().getSession();</div><div class="line"><span class="comment">// 这个session以Map类出现，可以put值，其中的值和HttpSession中的值同步</span></div><div class="line"><span class="comment">// 通过EL表达式把session中的数据取出来</span></div><div class="line"></div><div class="line">ActionContext ctx = ActionContext.getContext();</div><div class="line"></div><div class="line">ctx.put(<span class="string">"name"</span>, <span class="string">"mdzz"</span>); <span class="comment">// request.setAttribute("name", "mdzz");</span></div><div class="line">Map session = ctx.getSession(); <span class="comment">// session</span></div><div class="line"></div><div class="line">HttpServletRequest request = ctx.get(org.apache.struts2.StrutsStatics.HTTP_REQUEST);</div><div class="line">HttpServletResponse response = ctx.get(org.apache.struts2.StrutsStatics.HTTP_RESPONSE);</div></pre></td></tr></table></figure>
<p>还有一种，官方建议使用：定义Action类实现<code>ServletRequestAware</code>、<code>ServletSessionAware</code>、<code>ServletContextAware</code>等接口。</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span>&gt;</span>/HelloWorld.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 等于 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"success"</span> <span class="attr">type</span>=<span class="string">"dispatcher"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"location"</span>&gt;</span>/HelloWorld.jsp<span class="tag">&lt;/<span class="name">param</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">result</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 默认dispatcher服务端跳转，使用RequestDispatcher.forward() --&gt;</span></div><div class="line"><span class="comment">&lt;!-- /WEB-INF/是防止jsp不经过action访问  --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"editProduct"</span>&gt;</span>WEB-INF/jsp/product/editProduct.jsp<span class="tag">&lt;/<span class="name">result</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 客户端跳转 redirect调用response.sendRedirect()方法，浏览器创建新请求 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"listProductAction"</span> <span class="attr">type</span>=<span class="string">"redirect"</span>&gt;</span>listProduct<span class="tag">&lt;/<span class="name">result</span>&gt;</span></div></pre></td></tr></table></figure>
<p>客户端跳转传参</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;action name=<span class="string">"addPageProduct"</span> <span class="class"><span class="keyword">class</span></span>=<span class="string">"xxx.ProductAction"</span> method=<span class="string">"addPage"</span>&gt;</div><div class="line">	<span class="xml"><span class="comment">&lt;!-- 参数传递  --&gt;</span></span></div><div class="line">	<span class="tag">&lt;<span class="name">result</span> <span class="attr">name</span>=<span class="string">"addPage"</span> <span class="attr">type</span>=<span class="string">"redirect"</span>&gt;</span>addProduct.jsp?name=$&#123;name&#125;<span class="tag">&lt;/<span class="name">result</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">action</span>&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="keyword">form</span> action=<span class="string">"addProduct"</span>&gt;</div><div class="line">	&lt;<span class="keyword">input</span> <span class="keyword">type</span>=<span class="string">"text"</span> name=<span class="string">"product.name"</span> value=<span class="string">"$&#123;param.name&#125;"</span>&gt;</div><div class="line">	&lt;<span class="keyword">input</span> <span class="keyword">type</span>=<span class="string">"submit"</span> value=<span class="string">"submit"</span>&gt;</div><div class="line">&lt;/<span class="keyword">form</span>&gt;</div></pre></td></tr></table></figure>
<figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductAction</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">String</span> name;</div><div class="line">	<span class="keyword">private</span> Product product;</div><div class="line">	<span class="keyword">private</span> List&lt;Product&gt; products;</div><div class="line">	<span class="comment">// ...</span></div><div class="line">	<span class="keyword">public</span> <span class="keyword">String</span> addPage() &#123;</div><div class="line">		<span class="comment">// 设置name的值</span></div><div class="line">		name = <span class="string">"xxx"</span>;</div><div class="line">		<span class="keyword">return</span> <span class="string">"addPage"</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>值栈是一组对象</p>
<ul>
<li>Temporary：在页面执行期间创建的temporary对象，如，JSP标签循环集合的当前迭代值。</li>
<li>Model：如果使用Model对象，则当前Model对象放在值堆栈上的action之前。</li>
<li>Action：正在执行的当前action对象。</li>
<li>命名对象：<code>#session</code>，<code>#request</code>，<code>#attr</code>和<code>#parameters</code>及所引用的相应的servlet作用域。</li>
</ul>
<p>OGNL是基于上下文的，使用<code>#</code>号来引用默认或根对象的属性，<code>ActionContext</code>映射以供OGNL使用。</p>
<ul>
<li><p><code>ActionContext</code>映射包含：</p>
<ul>
<li>应用程序 - 应用程序作用域变量</li>
<li>会话 - 会话作用域变量</li>
<li>根/值栈 - 所有的action变量都存储在这里</li>
<li>请求 - 请求作用域变量</li>
<li>参数 - 请求参数</li>
<li>属性 - 存储在页面，请求，会话和应用程序作用域中的属性</li>
</ul>
</li>
<li><p>Action对象在值栈中总是可用的，如果Action对象有x和y属性，可以直接使用。</p>
</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 如果session中有一个“login”属性 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">s:property</span> <span class="attr">value</span>=<span class="string">"#session.login"</span>/&gt;</span></div></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">HelloWorldAction</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="type">String</span> name;</div><div class="line"></div><div class="line">	public <span class="type">String</span> execute() <span class="keyword">throws</span> <span class="type">Exception</span> &#123;</div><div class="line">		<span class="comment">// 获取值栈对象</span></div><div class="line">		<span class="type">ValueStack</span> stack = <span class="type">ActionContext</span>.getContext().getValueStack();</div><div class="line"></div><div class="line">		<span class="type">Map</span>&lt;<span class="type">String</span>, <span class="type">Object</span>&gt; context = <span class="keyword">new</span> <span class="type">HashMap</span>&lt;&gt;();</div><div class="line">		context.put(<span class="string">"key1"</span>, <span class="keyword">new</span> <span class="type">String</span>(<span class="string">"This is key1"</span>));</div><div class="line">		context.put(<span class="string">"key2"</span>, <span class="keyword">new</span> <span class="type">String</span>(<span class="string">"This is key2"</span>));</div><div class="line"></div><div class="line">		<span class="comment">// 将对象放在值栈的顶部</span></div><div class="line">		stack.push(context);</div><div class="line"></div><div class="line">		<span class="comment">// stack.size(); 获取值栈中的对象数</span></div><div class="line">		<span class="comment">// stack.peek(); 获取值栈顶部的对象而不改变值栈</span></div><div class="line">		<span class="comment">// stack.pop(); 获取值栈顶部的对象，并将其从值栈中删除</span></div><div class="line">		<span class="comment">// 其它</span></div><div class="line">		<span class="comment">// void set(String key, Object o)：使用key在值栈上设置一个对象，使其可通过findValue()检索</span></div><div class="line">		<span class="comment">// void setValue(String expr, Object value)：由默认顺序在值栈的bean上设置属性</span></div><div class="line">		<span class="comment">// Object findValue(String expr)：默认搜索顺序对值栈查找值</span></div><div class="line">		<span class="comment">// void setDefaultType(Class defaultType)：设置在获取值时要转换的默认类型</span></div><div class="line"></div><div class="line">		<span class="keyword">return</span> <span class="string">"success"</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>在执行时会将action添加到值栈的顶部。</p>
<p>通常放置在值栈的方法是添加getters/setters的值到Action类，然后使用<code>&lt;s:property&gt;</code>标签访问。</p>
<figure class="highlight stata"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="keyword">form</span> action=<span class="string">"hello"</span>&gt;</div><div class="line">	&lt;<span class="keyword">input</span> <span class="keyword">type</span>=<span class="string">"text"</span> name=<span class="string">"name"</span>/&gt;</div><div class="line">	&lt;<span class="keyword">input</span> <span class="keyword">type</span>=<span class="string">"submit"</span> value=<span class="string">"SayHello"</span>/&gt;</div><div class="line">&lt;/<span class="keyword">form</span>&gt;</div></pre></td></tr></table></figure>
<figure class="highlight ceylon"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Entered <span class="keyword">value</span> : &lt;s:property <span class="keyword">value</span>=<span class="string">"name"</span>/&gt;</div><div class="line">Value <span class="keyword">of</span> key<span class="number">1</span> : &lt;s:property <span class="keyword">value</span>=<span class="string">"key1"</span>/&gt;</div><div class="line">Value <span class="keyword">of</span> key<span class="number">2</span> : &lt;s:property <span class="keyword">value</span>=<span class="string">"key2"</span>/&gt;</div></pre></td></tr></table></figure>
<p>Struts2 中文问题</p>
<p>提交数据时指定编码方式UTF-8<br><figure class="highlight erb"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></div></pre></td></tr></table></figure></p>
<p>指定解码方式为UTF-8</p>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;<span class="built_in">constant</span> <span class="built_in">name</span>=<span class="string">"struts.i18n.encoding"</span> value=<span class="string">"UTF-8"</span>/&gt;</div></pre></td></tr></table></figure>
<p>服务端跳转到jsp时，指定浏览器使用UTF-8显示</p>
<figure class="highlight erb"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="xml"><span class="tag">&lt;<span class="name">%</span></span></span><span class="ruby">@ page language=<span class="string">"java"</span> contentType=<span class="string">"text/html; charset=UTF-8"</span> pageEncoding=<span class="string">"UTF-8"</span> isELIgnored=<span class="string">"false"</span> </span><span class="xml"><span class="tag">%&gt;</span></span></div></pre></td></tr></table></figure>
<p>如果Action类中有一个<code>Integer</code>属性，Struts自动将请求参数转换为<code>Integer</code>属性。</p>
<p>使用自定义数据类型时，要添加自定义转换器。<br><figure class="highlight haxe"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Environment</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">String</span> name;</div><div class="line">	<span class="comment">// getters setters</span></div><div class="line">	<span class="keyword">public</span> Environment(<span class="keyword">String</span> name) &#123;</div><div class="line">		<span class="built_in">this</span>.name = name;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">SystemDetails</span> <span class="keyword">extends</span> <span class="title">ActionSupport</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="type">Environment</span> environment = <span class="keyword">new</span> <span class="type">Environment</span>(<span class="string">"Development"</span>);</div><div class="line">	<span class="comment">// ...</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight scala"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 将Environment转换为String</span></div><div class="line">public <span class="class"><span class="keyword">class</span> <span class="title">EnvironmentConverter</span> <span class="keyword">extends</span> <span class="title">StrutsTypeConverter</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	public <span class="type">Object</span> convertFromString(<span class="type">Map</span> context, <span class="type">String</span>[] values, <span class="type">Class</span> clazz) &#123;</div><div class="line">		<span class="type">Environment</span> env = <span class="keyword">new</span> <span class="type">Environment</span>(values[<span class="number">0</span>]);</div><div class="line">		<span class="keyword">return</span> env;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@Override</span></div><div class="line">	public <span class="type">String</span> convertToString(<span class="type">Map</span> context, <span class="type">Object</span> value) &#123;</div><div class="line">		<span class="type">Environment</span> env = (<span class="type">Environment</span>) value;</div><div class="line">		<span class="keyword">return</span> env == <span class="literal">null</span> ? <span class="literal">null</span> : env.getName();</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight applescript"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">&lt;s:<span class="keyword">property</span> value=<span class="string">"environment"</span>/&gt;</div></pre></td></tr></table></figure>
<p>两种方式注册转换器。</p>
<ul>
<li><p>如果只在特定的方法中使用，创建’[action-class]’-conversion.properties：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># environment是类中属性的名称，使用EnvironmentConverter来转换这个属性</span></div><div class="line"><span class="attr">environment</span>=mmp.struts2.EnvironmentConverter</div></pre></td></tr></table></figure>
</li>
<li><p>全局注册转换器，WEB-INF/classes/xwork-conversion.properties：</p>
<figure class="highlight mathematica"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"># 每次遇到类型为<span class="keyword">Environment</span>的对象时自动执行转换</div><div class="line">xxx.<span class="keyword">Environment</span> = mmp.struts2.EnvironmentConverter</div></pre></td></tr></table></figure>
</li>
</ul>

				</div>
				<!-- about -->
				
			</div>
			<!-- pagination -->
			
			<div class="comment-section">
	
	


</div>
		</div>
		
	</div>


		<footer>
			 
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

		</footer>
	</div>
	<!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script> -->
	<script src="/js/highlight.js"></script> 
	<script>hljs.initHighlightingOnLoad();var timeEnd = new Date();console.log('耗时：' + (timeEnd - timeStart));</script>
	<!-- <script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>-->
	<!-- material design -->
	<!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script> -->
	<!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>-->
	<!-- toc -->
	<!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script> -->
	<!-- <script src="/libs/tocify/jquery.tocify.custom.js"></script> -->
	<!-- <script src="/js/main.js"></script> -->
</body>
</html>
