<!DOCTYPE HTML>
<html>
	<head><meta name="generator" content="Hexo 3.9.0">
		<meta charset="utf-8">
		<script src="/js/highlight.js"></script>
				<script>hljs.initHighlightingOnLoad();var timeStart = new Date();</script>
		
		<title>[笔记]-SQL | 学而时习之</title>
		
		<meta name="author" content="Huangzhike">
		
		
		<meta name="description" content="K.I.S.S">
		
		
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		
		<meta property="og:title" content="[笔记]-SQL">
		
		<meta property="og:site_name" content="学而时习之">
		
		
		<!-- favicon -->
		<link rel="icon" type="image/ico" href="/ok.ico" sizes="32x32">
 


		<meta name="msapplication-TileColor" content="#009688">
		<meta name="msapplication-TileImage" content="/mstile-144x144.ico">
		<meta name="theme-color" content="#009688">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Didact+Gothic"> 

		<!-- favicon end -->
		<!-- <link href="//ok.ico" rel="icon"> -->
		
		<!-- toc -->
		<!-- <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">-->
		<!-- material design -->
		<!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">-->
		<link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
		 
		 
		<!-- <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>-->
		<!-- <script>window.jQuery || document.write('<script src="/libs/jquery-3.1.1.slim.min.js" type="text/javascript"><\/script>')</script>-->
	</head>
</html>
<body>
	<nav class="navbar navbar-default">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">菜单</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/">学而时习之</a>
           
		</div>
		<div id="navbar" class="collapse navbar-collapse">
			<ul class="nav navbar-nav navbar-right">
				
				<li>
					<a href="https://huangzhike.github.io/" title="">
						<i class="fa fa-home"></i>Index
					</a>
				</li>
				
				<li>
					<a href="https://huangzhike.github.io/archives" title="">
						<i class="fa fa-list"></i>Archives
					</a>
				</li>
				
				<li>
					<a href="https://github.com/huangzhike" title="">
						<i class="fa fa-github"></i>GitHub
					</a>
				</li>
				
			</ul>
		</div>
	</div>
</nav>

	<div class="container" >
		<div class="row">
	
		<div class="col-md-9 center-content">
			
			<div class="content">
				<!-- index -->
				
				<h2>[笔记]-SQL</h2>
				
				<div>
					<div class="post-time">2017-10-12</div>
				</div>
				
				<div class="article-content">
				<p>12-29 改了一下格式，强迫症受不了</p>
<p><strong>单条示例，不要联系上下文</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">-- 查看所有数据库</span><br><span class="line">SHOW DATABASES;</span><br><span class="line"></span><br><span class="line">-- DROP DATABASE EMP;</span><br><span class="line"></span><br><span class="line">-- 大小写不敏感</span><br><span class="line">CREATE DATABASE EMP;</span><br><span class="line"></span><br><span class="line">USE EMP;</span><br><span class="line"></span><br><span class="line">-- 删除表</span><br><span class="line">DROP TABLE IF EXISTS user;</span><br><span class="line"></span><br><span class="line">create table user (</span><br><span class="line">	id int auto_increment primary key, -- 自动增长 主键</span><br><span class="line">	name varchar(30) not null , -- varchar(30)：变长字符串，最大30 该列不能为空</span><br><span class="line">	age int default 18, -- 默认</span><br><span class="line">	birthday date</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- varchar：英文和数字用一个字节存放，汉字(unicode)用两个字节</span><br><span class="line">-- varchar2：统一使用两个字节</span><br><span class="line">-- 一般用varchar2，很少用varchar</span><br><span class="line"></span><br><span class="line">-- 查看当前数据库中所有表</span><br><span class="line">SHOW TABLES;</span><br><span class="line"></span><br><span class="line">-- 查看user表结构</span><br><span class="line">DESC user;</span><br><span class="line"></span><br><span class="line">-- 增加列（字段）</span><br><span class="line">alter table user add (kills number);</span><br><span class="line"></span><br><span class="line">-- 增加列时，如果数据表已经有了记录，除非给新加的列指定了默认值，否则不能指定not null</span><br><span class="line">alter table user add iq INT DEFAULT 18;</span><br><span class="line"></span><br><span class="line">alter table user add (</span><br><span class="line">	height INT DEFAULT 18,</span><br><span class="line">	timing DATE</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 修改列，修改只对以后的操作有用，之前无影响</span><br><span class="line">alter table user modify (name varchar2(300));</span><br><span class="line"></span><br><span class="line">-- 改列名</span><br><span class="line">alter table user change iq eq VARCHAR2(300);</span><br><span class="line"></span><br><span class="line">-- 删除列</span><br><span class="line">alter table user drop column kills;</span><br><span class="line"></span><br><span class="line">-- 单引号</span><br><span class="line">-- insert into 表名 (列名1, 列名2, 列名3) values (列值1, 列值2, 列值3)</span><br><span class="line">insert into user (name, age, birthday) values (&apos;mdzz&apos;, 22, &apos;2588-08-27&apos;);</span><br><span class="line"></span><br><span class="line">-- 如果不指定括号，必须全部列出，不确定的用 null</span><br><span class="line">insert into user values (99, &apos;mdzz&apos;, null, &apos;2030-02-21&apos;);</span><br><span class="line"></span><br><span class="line">-- 命令行插入中文乱码需要解决</span><br><span class="line"></span><br><span class="line">-- 修改一个字段</span><br><span class="line">-- 如果不跟where条件，意味着修改所有的行</span><br><span class="line">update user set age = 46 where id = 22;</span><br><span class="line"></span><br><span class="line">-- 修改多个字段</span><br><span class="line">update user set name = &apos;mdzz&apos;, age = 48, armor = 4 where id = 22;</span><br><span class="line"></span><br><span class="line">-- 删除数据</span><br><span class="line">delete from user where id = 21;</span><br><span class="line">-- delete操作可以回滚，只要在提交之前</span><br><span class="line"></span><br><span class="line">-- 不跟where，删除一个表里的所有数据</span><br><span class="line">delete from user;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line">-- 查询所有列，* 表示查询所有列，而不是所有行</span><br><span class="line">select * from hr.employees;</span><br><span class="line"></span><br><span class="line">-- 查询指定列：select 列1，列2，列n from 表名;</span><br><span class="line">select name, birthday from hr.employees;</span><br><span class="line"></span><br><span class="line">-- 查询所有人的department_id列，有的员工在同一个部门，会看到重复的department_id</span><br><span class="line">select department_id from hr.employees;</span><br><span class="line"></span><br><span class="line">-- 消除重复的department_id列</span><br><span class="line">select distinct department_id from hr.employees;</span><br><span class="line"></span><br><span class="line">-- 把姓和名分别显示在不同的字段中</span><br><span class="line">select last_name, first_name from hr.employees;</span><br><span class="line"></span><br><span class="line">-- 把姓和名连接在一起，并且显示在同一个字段中</span><br><span class="line">select last_name || first_name 姓名 from hr.employees;</span><br><span class="line"></span><br><span class="line">-- 在姓和名之间加上空格</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">-- 根据工资倒序（降序）</span><br><span class="line">select * from hr.employees order by salary desc;</span><br><span class="line"></span><br><span class="line">-- 升序（默认）</span><br><span class="line">select * from hr.employees order by salary asc;</span><br><span class="line">-- 多列作为排序条件：第一列排序条件相同时，根据第二列排序条件排序，依次类推</span><br><span class="line">-- 当列名1的值相同时按照列名2的值降序排</span><br><span class="line">-- select * from 表名 order by 列名1 ASC, 列名2 DESC;</span><br><span class="line"></span><br><span class="line">-- 在查询结果中，给一个查询结果列另取一个名字</span><br><span class="line">-- select 列名1 (as) 别名1, 列名2 (as) 别名2 from 表名;</span><br><span class="line">select salary * 12 &apos;年薪&apos; from hr.employees;</span><br><span class="line">select salary * 12 as &apos;年薪&apos; from hr.employees;</span><br><span class="line">select salary * 12 as 年薪 from hr.employees;</span><br><span class="line">select salary * 12 年薪 from hr.employees;</span><br><span class="line">-- 列可以做加、减、乘、除，遇到null加任何值都等于null的情况，要用ifnull()函数</span><br><span class="line">-- 将字符串做加减乘除运算，会把字符串当作0</span><br><span class="line">-- 字符串类型可以做连续运算(要用到concat()函数)</span><br><span class="line">-- select concat(列名1，列名2) from 表名;</span><br><span class="line">-- 其中列名的类型要为字符串</span><br><span class="line"></span><br><span class="line">-- 统计月薪高于5000的总数（有效行数）</span><br><span class="line">select count(*) from hr.employees e where e.salary &gt; 5000;</span><br><span class="line"></span><br><span class="line">-- 100部门薪水最高最低是多少</span><br><span class="line">select max(salary), min(salary) from hr.employees e where e.department_id = 100;</span><br><span class="line"></span><br><span class="line">-- 平均薪资（列的平均值）</span><br><span class="line">select avg(salary) from hr.employees e;</span><br><span class="line"></span><br><span class="line">-- 求列的总值，null 和字符串默认为0</span><br><span class="line">-- select sum(列名) from 表名;</span><br><span class="line"></span><br><span class="line">select avg(salary) from hr.employees e where e.department_id = 90;</span><br><span class="line">select avg(salary) from hr.employees e where e.department_id = 100;</span><br><span class="line">select avg(salary) from hr.employees e where e.department_id = 110;</span><br><span class="line">-- 等于</span><br><span class="line">select avg(salary), e.department_id from hr.employees e group by e.department_id;</span><br><span class="line">-- 分组的时候，查询的字段，只能是统计函数，或者被分组的字段department_id，不能是别的</span><br><span class="line">-- 按照department_id分组员工，分在一起的员工的department_id都是一样的，但他们别的字段是不一样的，所以不能够查询别的字段</span><br><span class="line">-- 查询结果只能为：作为分组条件的列和聚合函数</span><br><span class="line">-- 分组查询的信息都是组的信息，不能查到个人的信息，其中查询组的信息是通过聚合函数得到的</span><br><span class="line"></span><br><span class="line">-- 分组查询前，可以通过关键字where先把满足条件的人分出来，再分组</span><br><span class="line">-- select 分组列, 聚合函数 from 表名 where 条件 group by 分组列;</span><br><span class="line"></span><br><span class="line">-- 分组查询后，可以通过关键字having把组信息中满足条件的组再细分出来</span><br><span class="line">-- select 分组列, 聚合函数 from 表名 where 条件 group by 分组列 having 聚合函数或列名(条件);</span><br><span class="line"></span><br><span class="line">-- having：对分组函数进行条件判断</span><br><span class="line">-- 以部门进行分组，找出部门平均薪资高于5000的数据</span><br><span class="line">select avg(salary), e.department_id from hr.employees e group by e.department_id having avg(salary) &gt; 5000;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">-- 要么满足正数第二个是a，要么满足倒是第二个是a</span><br><span class="line">select * from hr.employees where first_name like &apos;%a_&apos; or first_name like &apos;_a%&apos;;</span><br><span class="line"></span><br><span class="line">-- 排除姓名里倒数第二个字母是a的员工</span><br><span class="line">select * from hr.employees where first_name not like &apos;%a_&apos;;</span><br><span class="line"></span><br><span class="line">-- 只查询工资高于5000的员工</span><br><span class="line">select * from hr.employees where salary &gt; 5000;</span><br><span class="line"></span><br><span class="line">-- 查询工资在3000到5000之间的闭区间，即取得到3000</span><br><span class="line">select * from hr.employees where salary between 3000 and 5000;</span><br><span class="line">-- 等于</span><br><span class="line">select * from hr.employees where salary &gt;= 3000 and salary &lt;= 5000;</span><br><span class="line"></span><br><span class="line">-- 薪水要么等于3000要么等于6000</span><br><span class="line">select * from hr.employees where salary in (3000, 6000);</span><br><span class="line"></span><br><span class="line">-- 选择：age, first 和 last 列，其中first列包含Max</span><br><span class="line">select first, last, age from hr.employees where first like &apos;%Max%&apos;;</span><br><span class="line"></span><br><span class="line">-- 名字里倒数第二个字母是a的员工</span><br><span class="line">-- %：任意匹配，有或者没有都可以</span><br><span class="line">-- _：有，并且只有一个</span><br><span class="line">select * from hr.employees where first_name like &apos;%a_&apos;;</span><br><span class="line"></span><br><span class="line">-- like表示模糊查询，%表示匹配任意数据，limit(MySQL) 从第0行开始，取5个数据</span><br><span class="line">select * from user where name like &apos;%m%&apos; or password like &apos;%m%&apos; limit 0, 5;</span><br><span class="line"></span><br><span class="line">-- 查询所在部门为null的员工</span><br><span class="line">select * from hr.employees where department_id is null;</span><br></pre></td></tr></table></figure>
<p>优先级是<code>select</code>&gt;<code>from</code>&gt;<code>where</code>&gt;<code>group by</code>&gt;<code>having</code>&gt;<code>order by</code></p>
<p>约束：添加在列上用来约束列</p>
<ul>
<li>唯一约束 <code>unique</code> 不可重复</li>
<li>非空约束 <code>not null</code> 不能为空</li>
<li>主键约束 <code>primary key</code> 通常给 id ，同时具备 <code>unique</code> 和 <code>not null</code> 约束</li>
<li><p>外键约束 <code>foreign key</code> ：</p>
<ul>
<li>外键是本表的某个字段，指向另一张表的主键（或有唯一约束的字段）</li>
<li>外键可以为空</li>
<li>外键可重复</li>
<li>一张表可以有多个外键</li>
</ul>
</li>
<li><p>创建表的时候设置约束</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">create table hero (</span><br><span class="line">	-- auto_increment必须添加在int类型后，指定主键自增长后，插入数据时可以给该主键设置null值</span><br><span class="line">	-- 主键自增长在群集环境下不好使，大部分情况下使用UUID作主键</span><br><span class="line">	id int primary key auto_increment,</span><br><span class="line">	name varchar2(30) not null unique</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>给约束命名</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">create table kill_record (</span><br><span class="line">	id int,</span><br><span class="line">	name varchar2(30),</span><br><span class="line">	killerid number, -- 击杀英雄的id</span><br><span class="line">	killedid number, -- 被击杀英雄的id</span><br><span class="line">	number_ number, -- 击杀了多少次（number是关键字，用number_作为字段名）</span><br><span class="line"></span><br><span class="line">	primary key(id),</span><br><span class="line"></span><br><span class="line">	constraint uk_hero_name unique (name),</span><br><span class="line">	-- 约束名称是自定义的，uk_hero_name 即指定的约束名称</span><br><span class="line">	-- uk 代表 unique</span><br><span class="line">	-- hero 代表 表名</span><br><span class="line">	-- name 代表 字段</span><br><span class="line"></span><br><span class="line">	constraint fk_killer_hero foreign key (killerid) references hero (id),</span><br><span class="line">	constraint fk_killed_hero foreign key (killedid) references hero (id)</span><br><span class="line">);</span><br><span class="line">-- 插入数据的时候，如果外键指向的id不存在会出错</span><br><span class="line">-- insert into kill_record (id, killerid, killedid, number_) values (1, 2, 300, 1);</span><br></pre></td></tr></table></figure>
</li>
<li><p>给已经存在的表增加约束</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">-- 表hero的id字段加上主键约束</span><br><span class="line">alter table hero add constraint pk_hero_id primary key (id);</span><br><span class="line">-- alter table hero add primary key (id);</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除约束</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">alter table hero drop constraint uk_hero_name</span><br><span class="line">-- 删除主键</span><br><span class="line">alter table emp drop primary key;</span><br></pre></td></tr></table></figure>
</li>
<li><p>概念模型</p>
<ul>
<li>在Java中表现为对象模型，如：User、Student。<ul>
<li>可以双向关联，而且引用的是对象，而不是一个主键。</li>
</ul>
</li>
<li>在数据库中表现为关系模型：表。<ul>
<li>只能多方引用一方，而且引用的是主键，而不是一整行记录。</li>
</ul>
</li>
</ul>
</li>
<li><p><code>one-one</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">create table husband (</span><br><span class="line">	hid int primary key auto_increment,</span><br><span class="line">	hname varchar(50)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">create table wife (</span><br><span class="line">	wid int primary key auto_increment,</span><br><span class="line">	wname varchar(50),</span><br><span class="line">	-- 外键引用自身表的主键</span><br><span class="line">	constraint fk_wife_husband foreign key (wid) references husband (hid)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>one-many</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">create table dept (</span><br><span class="line">	deptno int primary key auto_increment,</span><br><span class="line">	name varchar(50)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">create table emp (</span><br><span class="line">	empno int primary key auto_increment,</span><br><span class="line">	name varchar(50),</span><br><span class="line">	dno int,</span><br><span class="line">	-- 添加外键约束后，在emp表中对dno列赋值时应该考虑外键约束</span><br><span class="line">	constraint fk_emp_dept foreign key(dno) references dept (deptno)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>many-many</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">create table student (</span><br><span class="line">	sid int primary key auto_increment,</span><br><span class="line">	sname varchar(50)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">create table teacher (</span><br><span class="line">	tid int primary key auto_increment,</span><br><span class="line">	name varchar(50)</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">-- 使用中间表(关联表)</span><br><span class="line">create table stu_tea (</span><br><span class="line">	sid int,</span><br><span class="line">	tid int,</span><br><span class="line">	-- 在中间表中使用两个外键，分别引用其它两个表的主键</span><br><span class="line">	constraint fk_student foreign key(sid) references student(sid),</span><br><span class="line">	constraint fk_teacher foreign key(tid) references student(tid)</span><br><span class="line">);</span><br></pre></td></tr></table></figure>
</li>
<li><p>多表查询</p>
<ul>
<li>合并结果集（略）</li>
<li><p>连接查询</p>
<ul>
<li><p>内连接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">-- 方言</span><br><span class="line">-- where后的条件是主外键</span><br><span class="line">select * from emp, dept where emp.deptno = dept.deptno;</span><br><span class="line"></span><br><span class="line">-- 标准</span><br><span class="line">select * from emp inner join dept on emp.deptno = dept.deptno;</span><br><span class="line"></span><br><span class="line">-- 自然连接：自己找到两个表中相同的列，自己填全where条件</span><br><span class="line">-- select * from 表1 natural join 表2;</span><br></pre></td></tr></table></figure>
</li>
<li><p>外连接</p>
<ul>
<li><p>左外连接左表为主，左表中所有的记录无论是否满足条件，都打印出来，不满足的值用<code>null</code>填</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from emp left outer join dept on emp.deptno = dept.deptno;</span><br></pre></td></tr></table></figure>
</li>
<li><p>右外连接右表为主，右表中所有的记录无论是否满足条件，都打印出来，不满足的值用<code>null</code>填</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">select * from emp right outer join dept on emp.deptno = dept.deptno;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">-- 查询员工的名称，及员工所在部门的名称就需要同时从hr.employees表和hr.departments表里取数据</span><br><span class="line"></span><br><span class="line">-- 查询出员工名字和部门id</span><br><span class="line">select e.first_name, e.department_id from hr.employees e;</span><br><span class="line"></span><br><span class="line">-- 部门名称在hr.departments</span><br><span class="line">select d.department_id, d.department_name from hr.departments d;</span><br><span class="line"></span><br><span class="line">-- 员工名字和部门名称在不同的表，为了一次性把两个数据都查询出来，需要关联两张表</span><br><span class="line">SELECT e.first_name, d.department_name</span><br><span class="line">FROM hr.employees e</span><br><span class="line">	LEFT JOIN hr.departments d ON e.department_id = d.department_id;</span><br><span class="line"></span><br><span class="line">-- left join 是进行表关联</span><br><span class="line">-- on 指定关联字段</span><br></pre></td></tr></table></figure>
</li>
<li><p>子查询：通俗来讲，就是查询中有查询，将一条SQL语句的查询结果作为条件来执行另一条SQL语句。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">-- 查询本公司工资最高的员工的详细信息</span><br><span class="line"></span><br><span class="line">-- 错误，因为where条件中不能有聚合函数</span><br><span class="line">-- select * from amp where sal = max(sal);</span><br><span class="line"></span><br><span class="line">-- 子查询出现的位置</span><br><span class="line"></span><br><span class="line">-- where后作为条件</span><br><span class="line">select * from amp where sal = (select max(sal) from amp);</span><br><span class="line"></span><br><span class="line">-- from后作为二次查询</span><br><span class="line">select e.empno, e.ename from (select * from amp where deptno = 30) as e where 条件;</span><br><span class="line"></span><br><span class="line">-- 查询出Bruce的月薪，得到数据是6000</span><br><span class="line">select e.salary from hr.employees e where e.first_name = &apos;Bruce&apos;;</span><br><span class="line">-- 统计月薪高于6000的人数</span><br><span class="line">select count(*) from hr.employees e where e.salary &gt; 6000.00;</span><br><span class="line"></span><br><span class="line">-- 小括号里的SQL即为子查询</span><br><span class="line">select count(*) from hr.employees e where e.salary &gt; </span><br><span class="line">	(select e.salary from hr.employees e where e.first_name = &apos;Bruce&apos;);</span><br><span class="line"></span><br><span class="line">-- 使用rownum进行分页查询</span><br><span class="line">-- 查出薪水最高的5-10条数据</span><br><span class="line">select * from </span><br><span class="line">	(select rownum r, e1.* from </span><br><span class="line">		(</span><br><span class="line">		select e.* from hr.employees e  order by e.salary desc</span><br><span class="line">		) e1</span><br><span class="line">	) e2 where e2.r &gt;= 5 and e2.r &lt;= 10;</span><br></pre></td></tr></table></figure>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Oracle序列：作为id插入到表中，使用序列<code>sequence</code>作为id自增长，每次插入数据，id自动增加。</p>
<ul>
<li><p>创建<code>sequence</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">-- 创建了一个名为hero_seq的序列</span><br><span class="line">create sequence hero_seq</span><br><span class="line">	-- 从1开始</span><br><span class="line">	increment by 1 </span><br><span class="line">	-- 每次增加1</span><br><span class="line">	start with 1 </span><br><span class="line">	-- 最大值是9999999</span><br><span class="line">	maxvalue 9999999</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用<code>sequnce</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 获取hero_seq的下一个值</span><br><span class="line">select hero_seq.nextval from dual;</span><br><span class="line"></span><br><span class="line">-- 获取hero_seq的当前值</span><br><span class="line">select hero_seq.currval from dual;</span><br></pre></td></tr></table></figure>
</li>
<li><p>作为id插入到表中</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">insert into hero (id, name, hp, mp) values (hero_seq.nextval, &apos;炸弹人&apos;, 450, 200);</span><br><span class="line"></span><br><span class="line">-- 执行上述代码多次，再执行查询语句</span><br><span class="line">-- 后面再增加的数据的id就是自动增加的</span><br><span class="line">select * from hero;</span><br><span class="line"></span><br><span class="line">insert into hero (id, name, hp, mp) values (999, &apos;炸弹人&apos;, 450, 200);</span><br><span class="line"></span><br><span class="line">-- 提交，否则数据库不会生效</span><br><span class="line">commit;</span><br></pre></td></tr></table></figure>
</li>
</ul>

				</div>
				<!-- about -->
				
			</div>
			<!-- pagination -->
			
			<div class="comment-section">
	
	


</div>
		</div>
		
	</div>


		<footer>
			 
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

		</footer>
	</div>
	<!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script> -->

	<script>var timeEnd = new Date();console.log('耗时：' + (timeEnd - timeStart));</script>
	<!-- <script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>-->
	<!-- material design -->
	<!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script> -->
	<!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>-->
	<!-- toc -->
	<!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script> -->
	<!-- <script src="/libs/tocify/jquery.tocify.custom.js"></script> -->
	<!-- <script src="/js/main.js"></script> -->
</body>
</html>
