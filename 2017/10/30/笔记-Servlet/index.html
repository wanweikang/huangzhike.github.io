<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <script>
            var timeStart = new Date();
        </script>
        
        <title>[ç¬”è®°]-Servlet | ğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒ•ğŸŒ–ğŸŒ—ğŸŒ˜</title>
        
        <meta name="author" content="huangzhike">
        
        
        <meta name="description" content="12-31é‡æ–°æ•´ç†
&amp;lt;display-name&gt;&amp;lt;/display-name&gt;
&amp;lt;!-- é…ç½®WEBåº”ç”¨çš„åˆå§‹åŒ–å‚æ•° --&gt;
&amp;lt;context-param&gt;
    &amp;lt;param-name&gt;url&amp;lt;/param-name&gt;
    &amp;lt;param-value&gt;">
        
        
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        
        <meta property="og:title" content="[ç¬”è®°]-Servlet"/>
        
        <meta property="og:site_name" content="ğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒ•ğŸŒ–ğŸŒ—ğŸŒ˜"/>
        
        
        <!-- favicon -->
        <link rel="icon" type="image/ico" href="/ok.ico" sizes="32x32">
        <meta name="msapplication-TileColor" content="#009688">
        <meta name="msapplication-TileImage" content="/mstile-144x144.ico">
        <meta name="theme-color" content="#009688">
        <!-- favicon end -->
        <!-- <link href="//ok.ico" rel="icon"> -->
        
        <!-- toc -->
        <!-- <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css"> -->
        <!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
        <!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">-->
        <!-- material design -->
        <!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
        <!-- <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css"> -->
        <!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
        <!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css"> -->
        <!--<link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">-->
        <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
        <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
        <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
        
        <!-- <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>-->
        <!-- <script>window.jQuery || document.write('<script src="/libs/jquery-3.1.1.slim.min.js" type="text/javascript"><\/script>')</script>-->
    <meta name="generator" content="Hexo 4.2.1"></head>

<body>
    <nav class="navbar navbar-default">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">èœå•</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" title="ä¸‹ä¸€å¥æ˜¯ï¼šå®¢æœ‰å¯äººæœŸä¸æ¥ã€‚å°æ—¶å€™ï¼Œå–œæ¬¢é åœ¨é˜³å°ä¸Šï¼Œä¸€è¾¹å¹é£ï¼Œä¸€è¾¹çœ‹ä¹¦ï¼Œå–œæ¬¢è¯»ä¹¦å—ï¼Œéªšå¹´ï¼Ÿ" href="/">ä¹¦å½“å¿«æ„è¯»æ˜“å°½</a>
           
		</div>
		<div id="navbar" class="collapse navbar-collapse">
			<ul class="nav navbar-nav navbar-right">
				
				<li>
					<a href="https://huangzhike.github.io/archives" title="">
						<i class="fa fa-list"></i>Archives
					</a>
				</li>
				
				<li>
					<a href="https://github.com/huangzhike" target="_blank" rel="noopener" title="">
						<i class="fa fa-github"></i>GitHub
					</a>
				</li>
				
			</ul>
		</div>
	</div>
</nav>

    <div class="container" >
        <div class="row">
	
		<div class="col-md-9 center-content">
			
			<div class="content">
				<!-- index -->
				
				<h2>[ç¬”è®°]-Servlet</h2>
				
				<div>
					<div class="post-time">2017-10-30</div>
				</div>
				
				<div class="article-content">
				<p><strong>12-31é‡æ–°æ•´ç†</strong></p>
<pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>display-name</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>display-name</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- é…ç½®WEBåº”ç”¨çš„åˆå§‹åŒ–å‚æ•° --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>context-param</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">></span></span>url<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">></span></span>jdbc:mysql://localhost:3306/test<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>context-param</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>welcome-file-list</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>welcome-file</span><span class="token punctuation">></span></span>index.jsp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>welcome-file</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>welcome-file-list</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- æ³¨å†ŒServlet --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>ServletMdzz<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-class</span><span class="token punctuation">></span></span>mmp.servlet.study.ServletMdzz<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-class</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!--é…ç½®ServletMdzzçš„åˆå§‹åŒ–å‚æ•° --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">></span></span>name<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">></span></span>mmp<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>init-param</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-name</span><span class="token punctuation">></span></span>password<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-name</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>param-value</span><span class="token punctuation">></span></span>123<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>param-value</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>init-param</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- å¯åŠ¨æ—¶è£…è½½å¹¶åˆ›å»ºServletçš„å®ä¾‹å¯¹è±¡ã€è°ƒç”¨init()æ–¹æ³• --></span>
    <span class="token comment" spellcheck="true">&lt;!-- ç”¨é€”ï¼šä¸ºæ•´ä¸ªwebåº”ç”¨åˆ›å»ºå¿…è¦çš„æ•°æ®åº“è¡¨å’Œæ•°æ® --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>load-on-startup</span><span class="token punctuation">></span></span>1<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>load-on-startup</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- æŠŠServletæ˜ å°„åˆ°URL --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-mapping</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>servlet-name</span><span class="token punctuation">></span></span>ServletMdzz<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-name</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- è®¿é—® http://localhost:8080/JavaWeb/mdzz.htm --></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>url-pattern</span><span class="token punctuation">></span></span>/mdzz.htm<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>url-pattern</span><span class="token punctuation">></span></span>
    <span class="token comment" spellcheck="true">&lt;!-- å‡¡åœ¨web.xmlæ–‡ä»¶ä¸­æ‰¾ä¸åˆ°åŒ¹é…çš„&lt;servlet-mapping>ï¼Œéƒ½äº¤ç»™ç¼ºçœServlet --></span>
    <span class="token comment" spellcheck="true">&lt;!-- &lt;url-pattern>/&lt;/url-pattern> --></span>
    <span class="token comment" spellcheck="true">&lt;!-- &lt;url-pattern>/*&lt;/url-pattern> --></span>
    <span class="token comment" spellcheck="true">&lt;!-- &lt;url-pattern>*.xx&lt;/url-pattern> --></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>servlet-mapping</span><span class="token punctuation">></span></span>
<span class="token comment" spellcheck="true">&lt;!-- å¦‚æœåŒ¹é…å¤šä¸ªURLæ˜ å°„ï¼Œæ‰§è¡Œå…·ä½“çš„é‚£ä¸ª --></span></code></pre>
<pre class=" language-java"><code class="language-java"><span class="token keyword">package</span> mmp<span class="token punctuation">.</span>servlet<span class="token punctuation">.</span>study<span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ServletMdzz</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// å®¹å™¨åœ¨åˆ›å»ºServletå®ä¾‹æ—¶ï¼Œè‡ªåŠ¨å°†åˆå§‹åŒ–å‚æ•°å°è£…åˆ°ServletConfigå¯¹è±¡ä¸­</span>
    <span class="token comment" spellcheck="true">// åœ¨è°ƒç”¨servletçš„initæ–¹æ³•æ—¶ï¼Œå°†ServletConfigå¯¹è±¡ä¼ ç»™servlet</span>
    <span class="token comment" spellcheck="true">// é€šè¿‡ServletConfigå¯¹è±¡å°±å¯å¾—åˆ°å½“å‰servletçš„åˆå§‹åŒ–å‚æ•°</span>
    <span class="token keyword">private</span> ServletConfig config<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>ServletConfig config<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// é‡å†™äº†init(ServletConfig config)æ–¹æ³•ï¼Œè¦è°ƒç”¨çˆ¶ç±»çš„initæ–¹æ³•ï¼Œå¤„ç†è·å–ServletContextå¯¹è±¡çš„å¼•ç”¨</span>
        <span class="token comment" spellcheck="true">// å¦åˆ™this.getServletContext();å‡ºç°ç©ºæŒ‡é’ˆå¼‚å¸¸</span>
        <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>config <span class="token operator">=</span> config<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> 
            <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>

        response<span class="token punctuation">.</span><span class="token function">setContentType</span><span class="token punctuation">(</span><span class="token string">"text/html;charset=utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è·å–æŒ‡å®šçš„åˆå§‹åŒ–å‚æ•°</span>
        String paramVal <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>config<span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>paramVal<span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span><span class="token string">"&lt;hr/>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è·å–Servletæ‰€æœ‰åˆå§‹åŒ–å‚æ•°</span>
        Enumeration<span class="token operator">&lt;</span>String<span class="token operator">></span> e <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">getInitParameterNames</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">while</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span><span class="token function">hasMoreElements</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            String name <span class="token operator">=</span> e<span class="token punctuation">.</span><span class="token function">nextElement</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            String value <span class="token operator">=</span> config<span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
            response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>name <span class="token operator">+</span> <span class="token string">"="</span> <span class="token operator">+</span> value <span class="token operator">+</span> <span class="token string">"&lt;br/>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        ServletContext context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è·å–Webåº”ç”¨çš„åˆå§‹åŒ–å‚æ•°</span>
        String contextInitParam <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getInitParameter</span><span class="token punctuation">(</span><span class="token string">"url"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">print</span><span class="token punctuation">(</span>contextInitParam<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doPost</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> 
            <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">doGet</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>Servletçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸå†…ï¼ŒServletçš„<code>init()</code>æ–¹æ³•åªè°ƒç”¨ä¸€æ¬¡ã€‚</p>
<p>å¤šæ¬¡è¯·æ±‚Servletï¼Œåªåˆ›å»ºä¸€ä¸ªServletå®ä¾‹ï¼ŒWebå®¹å™¨é€€å‡ºï¼Œå®ä¾‹æ‰é”€æ¯ã€‚</p>
<p>æ¯æ¬¡è¯·æ±‚Servletéƒ½è°ƒç”¨ä¸€æ¬¡<code>service()</code>æ–¹æ³•ã€‚</p>
<p>æ¯æ¬¡è¯·æ±‚Servletéƒ½åˆ›å»ºä¸€ä¸ªæ–°çš„<code>HttpServletRequest</code>å¯¹è±¡å’Œ<code>HttpServletResponse</code>å¯¹è±¡ï¼Œç„¶åä½œä¸ºå‚æ•°ä¼ é€’ç»™<code>service()</code>æ–¹æ³•ï¼Œ<code>service()</code>æ–¹æ³•å†æ ¹æ®è¯·æ±‚æ–¹å¼åˆ†åˆ«è°ƒç”¨<code>doXxx()</code>æ–¹æ³•ã€‚</p>
<p>WEBå®¹å™¨åœ¨å¯åŠ¨æ—¶ï¼Œä¸ºæ¯ä¸ªWEBåº”ç”¨ç¨‹åºåˆ›å»ºä¸€ä¸ªå¯¹åº”çš„<code>ServletContext</code>å¯¹è±¡ï¼Œä»£è¡¨å½“å‰Webåº”ç”¨ï¼Œapplicationã€‚</p>
<p>ä¸€ä¸ªWEBåº”ç”¨çš„æ‰€æœ‰Servletå…±äº«ä¸€ä¸ª<code>ServletContext</code>å¯¹è±¡ï¼ŒServleté—´å¯é€šè¿‡<code>ServletContext</code>å®ç°é€šè®¯ã€‚</p>
<pre class=" language-java"><code class="language-java">String data <span class="token operator">=</span> <span class="token string">"xxx"</span><span class="token punctuation">;</span>
ServletContext context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getServletConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
context<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// å°†dataå­˜å‚¨åˆ°ServletContextå¯¹è±¡ä¸­</span></code></pre>
<pre class=" language-java"><code class="language-java">ServletContext context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
String data <span class="token operator">=</span> <span class="token punctuation">(</span>String<span class="token punctuation">)</span> context<span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">"data"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>ServletContextå®ç°è¯·æ±‚è½¬å‘</p>
<pre class=" language-java"><code class="language-java">ServletContext context <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// è·å–è¯·æ±‚è½¬å‘å¯¹è±¡RequestDispatcher</span>
RequestDispatcher rd <span class="token operator">=</span> context<span class="token punctuation">.</span><span class="token function">getRequestDispatcher</span><span class="token punctuation">(</span><span class="token string">"/servlet/ServletXxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// forwardæ–¹æ³•å®ç°è¯·æ±‚è½¬å‘ï¼Œå½“å‰é¡µé¢ä¸è¾“å‡ºï¼Œå’Œincludeæ–¹æ³•ä¸ä¸€æ ·</span>
rd<span class="token punctuation">.</span><span class="token function">forward</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span> </code></pre>
<p>ServletContextè¯»å–èµ„æºæ–‡ä»¶</p>
<pre class=" language-java"><code class="language-java">response<span class="token punctuation">.</span><span class="token function">setHeader</span><span class="token punctuation">(</span><span class="token string">"content-type"</span><span class="token punctuation">,</span> <span class="token string">"text/html;charset=UTF-8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// /ä»£è¡¨é¡¹ç›®æ ¹ç›®å½•WebRoot</span>
<span class="token comment" spellcheck="true">// String path = "/db.properties";</span>
<span class="token comment" spellcheck="true">// String path = "/WEB-INF/classes/db.properties"</span>
<span class="token comment" spellcheck="true">// String path = "/WEB-INF/classes/mmp/servlet/study/db.properties"</span>

<span class="token comment" spellcheck="true">// è·å–ç»å¯¹è·¯å¾„</span>
String path <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getRealPath</span><span class="token punctuation">(</span><span class="token string">"/WEB-INF/classes/db/config/db.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// è·å–æ–‡ä»¶å</span>
<span class="token comment" spellcheck="true">// String filename = path.substring(path.lastIndexOf("\\") + 1);</span>

InputStream in <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getServletContext</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span>path<span class="token punctuation">)</span><span class="token punctuation">;</span>

Properties prop <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Properties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

prop<span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>

String driver <span class="token operator">=</span> prop<span class="token punctuation">.</span><span class="token function">getProperty</span><span class="token punctuation">(</span><span class="token string">"driver"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>MessageFormat<span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"driver={0}"</span><span class="token punctuation">,</span> driver<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>ç±»è£…è½½å™¨è¯»å–èµ„æºæ–‡ä»¶</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// è·å–è£…è½½å½“å‰ç±»çš„ç±»è£…è½½å™¨</span>
ClassLoader loader <span class="token operator">=</span> ServletContextTest<span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">.</span><span class="token function">getClassLoader</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment" spellcheck="true">// srcä¸‹çš„db1.propertiesé…ç½®æ–‡ä»¶</span>
InputStream in <span class="token operator">=</span> loader<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"db.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment" spellcheck="true">// srcä¸‹çš„mmp.servlet.studyåŒ…ä¸­çš„db4.propertiesé…ç½®æ–‡ä»¶</span>
InputStream in <span class="token operator">=</span> loader<span class="token punctuation">.</span><span class="token function">getResourceAsStream</span><span class="token punctuation">(</span><span class="token string">"mmp/servlet/study/db.properties"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>JSPå’ŒServletéƒ½æ˜¯å•ä¾‹å¤šçº¿ç¨‹çš„ï¼Œå®ä¾‹å˜é‡ä¼šå¼•èµ·é—®é¢˜ã€‚</p>
<p>å¹¶å‘è®¿é—®åŒä¸€ä¸ªServletæ—¶ï¼Œæ¯ä¸ªè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹ï¼Œå¹¶åœ¨è¿™ä¸ªçº¿ç¨‹ä¸Šè°ƒç”¨Servletçš„serviceæ–¹æ³•ï¼Œserviceæ–¹æ³•å¦‚æœè®¿é—®äº†åŒä¸€ä¸ªèµ„æºçš„è¯ï¼Œå¯èƒ½å¼•å‘çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</p>
<p>ä¸å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> 
        <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// iåœ¨æ–¹æ³•å†…å®šä¹‰ï¼Œå±€éƒ¨å˜é‡ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½æœ‰è‡ªå·±çš„iå˜é‡</span>
    <span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    i<span class="token operator">++</span><span class="token punctuation">;</span>
    response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>å­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼š</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">// iå®šä¹‰æˆå…¨å±€å˜é‡ï¼Œå¤šçº¿ç¨‹å¹¶å‘è®¿é—®å˜é‡iæ—¶ï¼Œå­˜åœ¨çº¿ç¨‹å®‰å…¨é—®é¢˜</span>
<span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span>
        <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>
    i<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
        Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class=" language-java"><code class="language-java"><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>

<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> 
        <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">// Servletä¸èƒ½ç”¨è¿™ç§æ–¹å¼ï¼Œå‡å¦‚æœ‰9999ä¸ªäººåŒæ—¶è®¿é—®ï¼Œåé¢çš„çº¿ç¨‹åªèƒ½æ’é˜Ÿç­‰å€™</span>
    <span class="token keyword">synchronized</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// æ¯ä¸ªå¯¹è±¡éƒ½æœ‰æŠŠé”ï¼Œè¿™é‡ŒthisæŒ‡Servletå¯¹è±¡</span>
        i<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            Thread<span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1000</span> <span class="token operator">*</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">InterruptedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        response<span class="token punctuation">.</span><span class="token function">getWriter</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>å®ç°äº†<code>SingleThreadModel</code>æ ‡è®°æ¥å£ï¼ˆDeprecatedï¼‰ï¼Œå°†ä»¥å•çº¿ç¨‹è°ƒç”¨å…¶serviceæ–¹æ³•ã€‚</p>
<p>å¹¶ä¸èƒ½çœŸæ­£è§£å†³é—®é¢˜ï¼Œå› ä¸ºä¼šåˆ›å»ºå¤šä¸ªServletå®ä¾‹å¯¹è±¡ã€‚</p>
<p>æ ‡è®°æ¥å£ï¼šæ¥å£ä¸­æ²¡æœ‰å®šä¹‰ä»»ä½•æ–¹æ³•å’Œå¸¸é‡ã€‚</p>
<ul>
<li>å®ç°äº†<code>Cloneable</code>æ¥å£ï¼Œå¯¹è±¡å°±å¯ä»¥è¢«å…‹éš†ã€‚</li>
<li>å®ç°äº†<code>Serializable</code>æ¥å£ï¼Œå¯¹è±¡å°±å¯ä»¥è¢«åºåˆ—åŒ–ã€‚</li>
</ul>
<hr>
<p>åŸºäºServletç”Ÿå‘½å‘¨æœŸçš„é¡µé¢ç‚¹å‡»è®¡æ•°å™¨ï¼š</p>
<ul>
<li><p><code>init()</code>æ–¹æ³•ä¸­åˆå§‹åŒ–ä¸€ä¸ªå…¨å±€å˜é‡ã€‚</p>
</li>
<li><p>æ¯æ¬¡è°ƒç”¨<code>doGet()</code>æˆ–<code>doPost()</code>æ–¹æ³•æ—¶ï¼Œå¢åŠ å…¨å±€å˜é‡ã€‚</p>
</li>
<li><p>å¯ä»¥ä½¿ç”¨æ•°æ®åº“è¡¨å­˜å‚¨<code>destroy()</code>æ–¹æ³•ä¸­çš„å…¨å±€å˜é‡ï¼Œä¸‹æ¬¡åˆå§‹åŒ–æ—¶ï¼Œå¯ä»¥åœ¨<code>init()</code>æ–¹æ³•è¯»å–ã€‚</p>
</li>
<li><p>è®¡ç®—ä¸€ä¸ªä¼šè¯å†…ä¸€ä¸ªé¡µé¢çš„ç‚¹é‡å‡»ï¼Œå¯ä»¥ä½¿ç”¨<code>isNew()</code>æ–¹æ³•æŸ¥çœ‹è¯¥ä¼šè¯å†…æ˜¯å¦å·²ç‚¹å‡»è¿‡ã€‚</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">PageHitCounter</span> <span class="token keyword">extends</span> <span class="token class-name">HttpServlet</span> <span class="token punctuation">{</span>
  <span class="token keyword">private</span> <span class="token keyword">int</span> hitCount<span class="token punctuation">;</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment" spellcheck="true">// Reset hit counter.</span>
      hitCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doGet</span><span class="token punctuation">(</span>HttpServletRequest request<span class="token punctuation">,</span> HttpServletResponse response<span class="token punctuation">)</span> 
          <span class="token keyword">throws</span> ServletException<span class="token punctuation">,</span> IOException <span class="token punctuation">{</span>
      hitCount<span class="token operator">++</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
</li>
</ul>
<p>åŸºäºè¿‡æ»¤å™¨ç”Ÿå‘½å‘¨æœŸçš„é¡µé¢ç‚¹å‡»è®¡æ•°å™¨ï¼š</p>
<ul>
<li><code>init()</code>æ–¹æ³•ä¸­åˆå§‹åŒ–ä¸€ä¸ªå…¨å±€å˜é‡ã€‚</li>
<li>æ¯æ¬¡è°ƒç”¨<code>doFilter</code>æ–¹æ³•æ—¶ï¼Œå¢åŠ å…¨å±€å˜é‡ã€‚</li>
<li>å¯ä»¥ä½¿ç”¨æ•°æ®åº“è¡¨å­˜å‚¨è¿‡æ»¤å™¨çš„<code>destroy()</code>æ–¹æ³•ä¸­çš„å…¨å±€å˜é‡çš„å€¼ï¼Œä¸‹æ¬¡åˆå§‹åŒ–æ—¶ï¼Œå¯ä»¥åœ¨<code>init()</code>æ–¹æ³•è¯»å–ã€‚</li>
</ul>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SiteHitCounter</span> <span class="token keyword">implements</span> <span class="token class-name">Filter</span> <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> hitCount<span class="token punctuation">;</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">init</span><span class="token punctuation">(</span>FilterConfig config<span class="token punctuation">)</span> <span class="token keyword">throws</span> ServletException <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// Reset hit counter.</span>
        hitCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">doFilter</span><span class="token punctuation">(</span>ServletRequest request<span class="token punctuation">,</span> ServletResponse response<span class="token punctuation">,</span> FilterChain chain<span class="token punctuation">)</span>
            <span class="token keyword">throws</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>IOException<span class="token punctuation">,</span> ServletException <span class="token punctuation">{</span>
        hitCount<span class="token operator">++</span><span class="token punctuation">;</span>
        chain<span class="token punctuation">.</span><span class="token function">doFilter</span><span class="token punctuation">(</span>request<span class="token punctuation">,</span> response<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">destroy</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>

				</div>
				<!-- about -->
				
			</div>
			<!-- pagination -->
			
			<div class="comment-section">
	
	


</div>
		</div>
		
	</div>


        <footer>
             
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

        </footer>
    </div>
    <!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script> -->
    <script>
        var timeEnd = new Date();
        console.log('è€—æ—¶ï¼š' + (timeEnd - timeStart));
        document.addEventListener('DOMContentLoaded', (event) => {
            document.querySelectorAll('pre').forEach((block) => {
                block.classList.add("line-numbers");
            });
        });
    </script>
    <!-- <script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>-->
    <!-- material design -->
    <!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script> -->
    <!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>-->
    <!-- toc -->
    <!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script> -->
    <!-- <script src="/libs/tocify/jquery.tocify.custom.js"></script> -->
    <!-- <script src="/js/main.js"></script> -->
    <script src="/js/prism.js"></script>
</body>
</html>
