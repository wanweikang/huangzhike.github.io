<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
				<script>var timeStart = new Date();</script>
		
		<title>[笔记]-SpringMVC-注解式开发 | 一个放笔记的地方而已</title>
		
		<meta name="author" content="Huangzhike">
		
		
		<meta name="description" content="没有鸡汤，只有笔记">
		
		
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		
		<meta property="og:title" content="[笔记]-SpringMVC-注解式开发"/>
		
		<meta property="og:site_name" content="一个放笔记的地方而已"/>
		
		
		<!-- favicon -->
		<link rel="icon" type="image/ico" href="/ok.ico" sizes="32x32">
 


		<meta name="msapplication-TileColor" content="#009688">
		<meta name="msapplication-TileImage" content="/mstile-144x144.ico">
		<meta name="theme-color" content="#009688">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Didact+Gothic"> 

		<!-- favicon end -->
		<!-- <link href="//ok.ico" rel="icon"> -->
		
		<!-- toc -->
		<!-- <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">-->
		<!-- material design -->
		<!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">-->
		<link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
		 
		 
		<!-- <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>-->
		<!-- <script>window.jQuery || document.write('<script src="/libs/jquery-3.1.1.slim.min.js" type="text/javascript"><\/script>')</script>-->
	</head>

<body>
	<nav class="navbar navbar-default">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">菜单</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/">一个放笔记的地方而已</a>
           
		</div>
		<div id="navbar" class="collapse navbar-collapse">
			<ul class="nav navbar-nav navbar-right">
				
				<li>
					<a href="https://huangzhike.github.io/" title="">
						<i class="fa fa-home"></i>Index
					</a>
				</li>
				
				<li>
					<a href="https://huangzhike.github.io/archives" title="">
						<i class="fa fa-list"></i>Archives
					</a>
				</li>
				
				<li>
					<a href="https://github.com/huangzhike" title="">
						<i class="fa fa-github"></i>GitHub
					</a>
				</li>
				
			</ul>
		</div>
	</div>
</nav>

	<div class="container" >
		<div class="row">
	
		<div class="col-md-9 center-content">
			
			<div class="content">
				<!-- index -->
				
				<h2>[笔记]-SpringMVC-注解式开发</h2>
				
				<div>
					<span class="post-time">2017-11-25 10:24:17</span>
				</div>	
				
				<div class="article-content">
				<p><strong>1-3重新整理</strong></p>
<p>注解式开发：处理器基于注解，无需在配置文件中逐个注册处理器，通过对类与方法的注解完成注册。</p>
<ul>
<li>注解替换的是配置文件中对于处理器的注册部分。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 激活SpringMVC注解扫描，如@Controller和@RequestMapping --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 默认扫描的包路径，base-package后的内容只是包路径，不能把类名也写出来 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"mmp"</span>/&gt;</span></div><div class="line"></div><div class="line"><span class="tag">&lt;<span class="name">context:annotation-config</span>/&gt;</span></div><div class="line"></div><div class="line"><span class="comment">&lt;!-- 注解驱动 --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 默认加载很多参数绑定方法，如JSON转换解析器 --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 不用配置RequestMappingHandlerMapping和RequestMappingHandlerAdapter --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></div></pre></td></tr></table></figure>
<p><code>@Controller</code>：说明是处理器类；</p>
<p><code>@RequestMapping</code>：请求到处理器方法的映射；</p>
<p><code>@RequestParam</code>：请求参数到处理器方法的方法参数的绑定；</p>
<p><code>@ModelAttribute</code>：请求参数到命令对象的绑定；</p>
<p><code>@InitBinder</code>：自定义数据绑定注册支持，将请求参数转换到命令对象属性的对应类型；</p>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="meta">@RequestMapping(value = <span class="meta-string">"/login.do"</span>)</span> <span class="comment">// 通用映射前缀</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Login</span> </span>&#123;</div><div class="line">	<span class="meta">@RequestMapping(value=<span class="meta-string">"/login2.do"</span>)</span> <span class="comment">// 映射窄化  </span></div><div class="line">	<span class="keyword">public</span> ModelAndView hello()&#123;</div><div class="line"></div><div class="line">		ModelAndView mv = new ModelAndView();</div><div class="line">		mv.addObject(<span class="string">"message"</span>, <span class="string">"Hello World!"</span>);</div><div class="line">		<span class="comment">// 设置逻辑视图名，视图解析器会根据该名字解析到具体的视图页面</span></div><div class="line">		mv.setViewName(<span class="string">"login"</span>);</div><div class="line">		<span class="keyword">return</span> mv; <span class="comment">// 模型数据和逻辑视图名</span></div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>URL：<code>http://xxx/xxx/login/login2.do</code></p>
<hr>
<p>处理器方法可以包含五类参数，由系统自动赋值。</p>
<ul>
<li>HttpServletRequest</li>
<li>HttpServletResponse</li>
<li>HttpSession</li>
<li>Model（承载数据）</li>
<li>请求参数</li>
</ul>
<hr>
<p><code>@RequestMapping(value={&quot;/login.do&quot;, &quot;/user/login.do&quot;})</code>。</p>
<p><code>@RequestMapping(value=&quot;/users/{userId}&quot;)</code>：{xxx}占位符，匹配”/users/123456”或”/users/abcd”。</p>
<p><code>@RequestMapping(value=&quot;/users/**&quot;)</code>:匹配”/users/abc/abc”。</p>
<p><code>@RequestMapping(value=&quot;/model?&quot;)</code>:匹配”/model1”或”/modela”，不匹配”/model”或”/modelaa”。</p>
<p><code>@RequestMapping(value=&quot;/model*&quot;)</code>:匹配”/modelabc”或”/model”，不匹配”/modelabc/abc”。</p>
<p><code>@RequestMapping(value=&quot;/model/*&quot;)</code>:匹配”/model/abc”，不匹配”/modelabc”。</p>
<p><code>@RequestMapping(value=&quot;/model/**/{modelId}&quot;)</code>：匹配”/model/abc/abc/123”或”/model/123”。</p>
<p><code>@RequestMapping(value=&quot;/login/{userId:\\d+}.do&quot;)</code>:{变量名:正则表达式}，匹配”/login/123.do”，不匹配”/login/abc.do”。</p>
<hr>
<p>@RequestMapping 中 params 属性中定义了请求中必须携带的参数的要求。</p>
<p><code>@RequestMapping(value=&quot;/xxx.do&quot;, params={&quot;name&quot;, &quot;age&quot;})</code>：请求中必须携带参数name与age。</p>
<p><code>@RequestMapping(value=&quot;/xxx.do&quot;, params={&quot;!name&quot;, &quot;age&quot;})</code>：请求中必须携带参数age，不能携带name。</p>
<p><code>@RequestMapping(value=&quot;/xxx.do&quot;, params={&quot;name=mdzz&quot;, &quot;ag = 23&quot;})</code>：请求中必须携带参数name，值为mdzz；必须携带age，值为23。</p>
<p><code>@RequestMapping(value=&quot;/xxx.do&quot;, params=&quot;name != mdzz&quot;)</code>：请求中必须携带参数name，值不能为mdzz。</p>
<hr>
<p><code>RequestMethod.GET</code>与<code>RequestMethod.POST</code></p>
<ul>
<li>表单请求：默认GET，可以指定POST</li>
<li>AJAX请求：默认GET，可以指定POST</li>
<li>地址栏请求：GET请求</li>
<li>超链接请求：GET请求</li>
<li>src资源路径请求：GET请求</li>
</ul>
<hr>
<p>Spring4.3中引进<code>@GetMapping</code>组合注解，等于<code>@RequestMapping(method = RequestMethod.GET)</code>。</p>
<p><code>@RequestParam</code>校正请求参数名，URL携带的参数名与处理方法中的参数名不同时，在处理方法参数前，添加<code>@RequestParam(&quot;请求参数名&quot;)</code>，将请求参数绑定控制器方法参数。</p>
<ul>
<li>value：指定请求参数的名称。</li>
<li>required：是否必须，boolean类型。</li>
<li>defaultValue：默认值。若请求 URI 中没有，当前方法参数将取该默认值。</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// http://localhost:8080/HelloSpringMVC/user?name=admin</span></div><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RequestParamExampleController</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@RequestMapping(<span class="meta-string">"/user"</span>)</span></div><div class="line">	<span class="keyword">public</span> String userInfo(Model model, </div><div class="line">		<span class="meta">@RequestParam(value = <span class="meta-string">"name"</span>, defaultValue = <span class="meta-string">"Guest"</span>)</span> String name) &#123;</div><div class="line">		<span class="comment">// 如果@RequestParam注解的参数是int基本类型，但是required=false</span></div><div class="line">		<span class="comment">// 这时如果不传参数值会报错，因为不传值，会赋值为null给int</span></div><div class="line">		<span class="comment">// 建议使用包装类型代替基本类型，用Integer代替int</span></div><div class="line">		model.addAttribute(<span class="string">"name"</span>, name);</div><div class="line">		<span class="keyword">return</span> <span class="string">"userInfo"</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<p><code>@PathVariable</code>：处理器方法中接收的请求参数，可以来自请求携带的参数，也可以来自于请求<code>URI</code>中的变量，即路径变量。</p>
<ul>
<li><p>不指定参数，默认其参数名，即路径变量名与用于接收其值的属性名相同。</p>
</li>
<li><p>若路径变量名与接收其值的属性名不同，<code>@PathVariable</code>可通过参数指出路径变量名称。</p>
</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// http://localhost:8080/xxx/web/fe/default/en/document/8108/spring-mvc-for-beginners</span></div><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PathVariableExampleController</span> </span>&#123;</div><div class="line">	<span class="comment">// URI模板，@PathVariable注释将一个方法参数绑定到一个变量的值</span></div><div class="line">	<span class="meta">@RequestMapping(<span class="meta-string">"/web/fe/&#123;sitePrefix&#125;/&#123;language&#125;/document/&#123;id&#125;/&#123;naturalText&#125;"</span>)</span></div><div class="line">	<span class="keyword">public</span> String documentView(Model model, </div><div class="line">			<span class="meta">@PathVariable(value = <span class="meta-string">"sitePrefix"</span>)</span> String sitePrefix,</div><div class="line">			<span class="meta">@PathVariable(value = <span class="meta-string">"language"</span>)</span> String language, </div><div class="line">			<span class="meta">@PathVariable(value = <span class="meta-string">"id"</span>)</span> <span class="built_in">Long</span> id,</div><div class="line">			<span class="meta">@PathVariable(value = <span class="meta-string">"naturalText"</span>)</span> String naturalText) &#123;</div><div class="line"></div><div class="line">		model.addAttribute(<span class="string">"sitePrefix"</span>, sitePrefix);</div><div class="line">		model.addAttribute(<span class="string">"language"</span>, language);</div><div class="line">		model.addAttribute(<span class="string">"id"</span>, id);</div><div class="line">		model.addAttribute(<span class="string">"naturalText"</span>, naturalText);</div><div class="line">		<span class="comment">// ...</span></div><div class="line">		<span class="keyword">return</span> <span class="string">"documentView"</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<figure class="highlight arduino"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line">@Controller</div><div class="line"><span class="keyword">public</span> <span class="keyword">class</span> Login &#123;</div><div class="line"></div><div class="line">	@RequestMapping(value = <span class="string">"welcome"</span>)</div><div class="line">	<span class="keyword">public</span> <span class="keyword">String</span> welcome() &#123;</div><div class="line">		<span class="built_in">return</span> <span class="string">"welcome"</span>; <span class="comment">// 返回welcome.jsp</span></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	@RequestMapping(value = <span class="string">"login"</span>)</div><div class="line">	<span class="keyword">public</span> ModelAndView login() &#123;</div><div class="line">		ModelAndView mav = <span class="keyword">new</span> ModelAndView();</div><div class="line">		mav.setViewName(<span class="string">"welcome"</span>); <span class="comment">// 返回的文件名</span></div><div class="line">		mav.addObject(<span class="string">"message"</span>, <span class="string">"hello kitty"</span>);</div><div class="line"></div><div class="line">		<span class="comment">// Map</span></div><div class="line">		Map&lt;<span class="keyword">String</span>, <span class="keyword">String</span>&gt; <span class="built_in">map</span> = <span class="keyword">new</span> HashMap&lt;&gt;();</div><div class="line">		<span class="built_in">map</span>.<span class="built_in">put</span>(<span class="string">"zhangsan"</span>, <span class="string">"北京"</span>);</div><div class="line"></div><div class="line">		mav.addObject(<span class="string">"map"</span>, <span class="built_in">map</span>);</div><div class="line">		<span class="comment">// 返回到DispatcherServlet</span></div><div class="line">		<span class="built_in">return</span> mav;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	@RequestMapping(value = <span class="string">"logout"</span>)</div><div class="line">	<span class="keyword">public</span> ModelAndView logout() &#123;</div><div class="line">		<span class="keyword">String</span> message = <span class="string">""</span>;</div><div class="line">		<span class="built_in">return</span> <span class="keyword">new</span> ModelAndView(<span class="string">"logout"</span>, <span class="string">"message"</span>, message);</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProductController</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/addProduct"</span>)</div><div class="line">	<span class="function"><span class="keyword">public</span> ModelAndView <span class="title">add</span><span class="params">(Product product)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		ModelAndView mav = <span class="keyword">new</span> ModelAndView(<span class="string">"showProduct"</span>);</div><div class="line">		<span class="comment">// 参数product会默认被当做值加入到ModelAndView中，等于：</span></div><div class="line">		<span class="comment">// mav.addObject("product", product);</span></div><div class="line">		<span class="keyword">return</span> mav;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><code>ModelAndView</code>即模型与视图，<code>addObject()</code>方法向模型添加数据，<code>setViewName()</code>方法向模型添加视图名称。</p>
<p><code>ModelAndView</code>的模型对象是<code>ModelMap</code>，本质是个<code>HashMap</code>。</p>
<ul>
<li><code>ModelMap</code>替代<code>request.getAttribute()</code>/<code>request.setAttribute()</code><figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="regexp">//</span> 相当于request.setAttribute(<span class="string">"name"</span>, student.getName());</div><div class="line">model.addAttribute(<span class="string">"name"</span>, student.getName());</div></pre></td></tr></table></figure>
</li>
</ul>
<hr>
<p>处理器方法，返回值有四种：</p>
<ul>
<li>第一种：<code>ModelAndView</code></li>
<li>第二种：<code>String</code></li>
<li>第三种：无返回值<code>void</code></li>
<li><p>第四种：返回自定义对象</p>
</li>
<li><p>返回<code>ModelAndView</code></p>
<ul>
<li>处理器方法需要跳转到其它资源，又要在跳转的资源间传递数据，返回<code>ModelAndView</code>较好。</li>
<li>返回<code>ModelAndView</code>，则需要定义<code>ModelAndView</code>对象，若只跳转不传递数据，或只传递数据不跳转（如Ajax），返回<code>ModelAndView</code>，总是有部分多余。</li>
</ul>
</li>
<li><p>返回<code>String</code></p>
<ul>
<li><code>return &quot;editItem&quot;;</code>：逻辑视图名，视图解析器转换为物理视图地址。</li>
<li>也可以直接返回物理视图名，此时不需要在视图解析器中配置前辍与后辍。</li>
</ul>
</li>
<li><p>返回<code>void</code></p>
<ul>
<li>方法参数中放入<code>HttpServletRequest</code>或<code>HttpSession</code>，可以直接将数据放入到<code>request</code>、<code>session</code>域中，也可通过<code>request.getServletContext()</code>获取<code>ServletContext</code>，将数据放入到<code>application</code>域中，然后完成请求转发与重定向。<ul>
<li>请求转发：<code>request.getRequestDispatcher(&quot;/WEB-INF/jsp/editItem.jsp&quot;).forward(request, response);</code>。</li>
<li>重定向：<code>response.sendRedirect(&quot;指定页面的完整路径&quot;);</code>。</li>
</ul>
</li>
<li>AJAX响应：处理器对请求处理后，无需跳转，返回<code>void</code>。</li>
</ul>
</li>
<li><p>返回<code>Object</code></p>
<ul>
<li>返回的<code>Object</code>对象不是逻辑视图，而是在页面显示的数据，用<code>@ResponseBody</code>注解，将转换后的<code>JSON</code>数据放入到响应体中。</li>
</ul>
</li>
</ul>
<hr>
<p>请求转发与重定向</p>
<ul>
<li><p>跳转的资源类型：跳转到页面与跳转到其它处理器。</p>
</li>
<li><p>处理器向其它资源跳转：请求转发与重定向。</p>
<ul>
<li>请求转发的页面，可以是<code>WEB-INF</code>中页面；<ul>
<li><code>forward</code>：地址栏URL不变。</li>
</ul>
</li>
<li>重定向的页面，不能为<code>WEB-INF</code>中的，重定向相当于再发一次请求，用户不能直接访问<code>WEB-INF</code>中资源。<ul>
<li><code>redirect</code>：地址栏URL改变。</li>
</ul>
</li>
</ul>
</li>
</ul>
<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Login</span> </span>&#123;</div><div class="line"></div><div class="line">	<span class="comment">// 转发</span></div><div class="line">	<span class="meta">@RequestMapping(<span class="meta-string">"/login.do"</span>)</span></div><div class="line">	<span class="keyword">public</span> String login(HttpServletRequest request, HttpServletResponse response) &#123;</div><div class="line">		request.setAttribute(<span class="string">"message"</span>, <span class="string">"hello"</span>);</div><div class="line">		<span class="comment">// 关于这里的斜杠，应该是代表根目录，如果同处根目录下，就可以不用斜杠？</span></div><div class="line">		<span class="keyword">return</span> <span class="string">"forward:/index.do"</span>; <span class="comment">// forward在跳转后可以取到message值</span></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@RequestMapping(<span class="meta-string">"/index.do"</span>)</span></div><div class="line">	<span class="keyword">public</span> String index(HttpServletRequest request, HttpServletResponse response) &#123;</div><div class="line">		<span class="keyword">return</span> <span class="string">"welcome"</span>;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="comment">// 重定向</span></div><div class="line">	<span class="meta">@RequestMapping(<span class="meta-string">"/logout.do"</span>)</span></div><div class="line">	<span class="keyword">public</span> String logout(HttpServletRequest request, HttpServletResponse response) &#123;</div><div class="line">		request.setAttribute(<span class="string">"message"</span>, <span class="string">"hello"</span>);</div><div class="line">		<span class="keyword">return</span> <span class="string">"redirect:/register.do"</span>; <span class="comment">// redirect在跳转后无法取到message值</span></div><div class="line">	&#125;</div><div class="line"></div><div class="line">	<span class="meta">@RequestMapping(<span class="meta-string">"/register.do"</span>)</span></div><div class="line">	<span class="keyword">public</span> String register(HttpServletRequest request, HttpServletResponse response) &#123;</div><div class="line">		<span class="keyword">return</span> <span class="string">"register"</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li><p>返回<code>ModelAndView</code>时的请求转发</p>
<ul>
<li>默认：<ul>
<li><code>return new ModelAndView(&quot;other&quot;);</code></li>
</ul>
</li>
<li>显式指出<ul>
<li>请求转发到页面，此时视图不会与视图解析器中的前辍与后辍拼接，必须写出相对于项目根的路径：<ul>
<li><code>return new ModelAndView(&quot;forward:/WEB-INF/jsp/show.jsp&quot;);</code></li>
</ul>
</li>
<li>请求转发到其它Controller：<ul>
<li><code>return new ModelAndView(&quot;forward:other.do&quot;);</code></li>
</ul>
</li>
</ul>
</li>
<li>请求转发向下传递数据，除了<code>request</code>，<code>session</code>外，还可存放于<code>ModelAndView</code>的<code>Model</code>中，页面通过EL表达式访问。</li>
</ul>
</li>
<li><p>返回<code>ModelAndView</code>时的重定向</p>
<ul>
<li>重定向到页面，视图不会与前辍与后辍拼接，必须写出相对于项目根的路径：<ul>
<li><code>return new ModelAndView(&quot;redirect:/show.jsp&quot;);</code></li>
</ul>
</li>
<li>重定向到其它Controller：<ul>
<li><code>return new ModelAndView(&quot;redirect:other.do&quot;);</code></li>
</ul>
</li>
<li>重定向的目标资源中，无法访问用户<code>request</code>中的数据，可以通过<code>ModelAndView</code>的<code>Model</code>携带参数。<ul>
<li>将<code>map</code>中的<code>key-value</code>，以请求参数的形式放到请求的<code>URL</code>后。</li>
<li>放入到<code>Model</code>中的<code>value</code>，只能是基本类型与<code>String</code>。</li>
<li><code>map</code>中的<code>key-value</code>以请求参数的形式放到了请求<code>URL</code>后，可以通过EL表达式中的请求参数<code>param</code>读取。</li>
</ul>
</li>
</ul>
</li>
<li><p>返回<code>String</code>时的请求转发</p>
<ul>
<li>同样不会进行前辍与后辍的拼接。<ul>
<li><code>return &quot;forward:/index.do&quot;;</code></li>
</ul>
</li>
<li>此时不能用<code>ModelAndView</code>传递数据，因为<code>ModelAndView</code>对象是局部变量，方法结束变量销毁。</li>
<li>当处理器接收到请求参数后，发现接收参数的处理器方法形参为包装类对象，除了会将参数封装为对象传递给形参外，还会存放到<code>request</code>域中。<figure class="highlight kotlin"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping(<span class="meta-string">"/logout.do"</span>)</span></div><div class="line"><span class="keyword">public</span> String logout(Person person) &#123;</div><div class="line">	<span class="comment">// 对象已存入request域</span></div><div class="line">	<span class="keyword">return</span> <span class="string">"redirect:/register.do"</span>; </div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
</li>
<li><p>返回<code>String</code>时的重定向</p>
<ul>
<li><code>return &quot;redirect:/register.do&quot;;</code></li>
<li>重定向时，向下传递参数值<ul>
<li>重定向到页面<ul>
<li>请求<code>URL</code></li>
<li><code>HttpSession</code></li>
<li><code>Model</code>形参<ul>
<li>该方式同样也是将参数拼接到了重定向请求的<code>URL</code>后，只能是基本类型数据。</li>
</ul>
</li>
<li><code>RedirectAttributes</code>形参的<code>addAttribute()</code><ul>
<li>需要注册MVC注解驱动。</li>
<li>该方式同样也是将参数拼接到了重定向请求的<code>URL</code>后，只能是基本类型数据。</li>
</ul>
</li>
</ul>
</li>
<li>重定向到Controller<ul>
<li>请求<code>URL</code>后携带</li>
<li><code>HttpSession</code></li>
<li><code>Model</code>形参</li>
<li><code>RedirectAttributes</code>形参的<code>addAttibute()</code></li>
<li><code>RedirectAttributes</code>形参的<code>addFlushAttibute()</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>返回<code>void</code>时的请求转发</p>
<ul>
<li><code>request.getRequestDispatcher(&quot;目标页面&quot;).forward(request, response);</code>。</li>
<li>向下一级传递数据<ul>
<li>将数据放到<code>request</code>或<code>session</code>中。</li>
<li>不能放到<code>Model</code>、<code>RedirectAttributes</code>中，因为它们的数据都是通过拼接到处理器方法的返回值中，作为请求的一部分向下传递，没有返回值，便无法向下传递了。</li>
</ul>
</li>
</ul>
</li>
<li><p>返回<code>void</code>时的重定向</p>
<ul>
<li><code>response.sendRedirect(&quot;目标页面&quot;);</code>。</li>
<li>若有数据向下一级传递，将数据放到<code>session</code>中。</li>
</ul>
</li>
</ul>

				</div>
				<!-- about -->
				
			</div>
			<!-- pagination -->
			
			<div class="comment-section">
	
	


</div>
		</div>
		
	</div>


		<footer>
			 
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

		</footer>
	</div>
	<!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script> -->
	<script src="/js/highlight.js"></script> 
	<script>hljs.initHighlightingOnLoad();var timeEnd = new Date();console.log('耗时：' + (timeEnd - timeStart));</script>
	<!-- <script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>-->
	<!-- material design -->
	<!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script> -->
	<!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>-->
	<!-- toc -->
	<!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script> -->
	<!-- <script src="/libs/tocify/jquery.tocify.custom.js"></script> -->
	<!-- <script src="/js/main.js"></script> -->
</body>
</html>
