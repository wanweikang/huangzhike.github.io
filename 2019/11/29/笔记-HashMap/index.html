<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <script>
            var timeStart = new Date();
        </script>
        
        <title>[ç¬”è®°]-HashMap | ğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒ•ğŸŒ–ğŸŒ—ğŸŒ˜</title>
        
        <meta name="author" content="huangzhike">
        
        
        <meta name="description" content="jdk1.8.0_211

HashMap
public class HashMap&amp;lt;K, V&gt; extends AbstractMap&amp;lt;K, V&gt; implements Map&amp;lt;K, V&gt;, Cloneable, Serializable {

    /**
     * é»˜è®¤">
        
        
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        
        <meta property="og:title" content="[ç¬”è®°]-HashMap"/>
        
        <meta property="og:site_name" content="ğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒ•ğŸŒ–ğŸŒ—ğŸŒ˜"/>
        
        
        <!-- favicon -->
        <link rel="icon" type="image/ico" href="/ok.ico" sizes="32x32">
        <meta name="msapplication-TileColor" content="#009688">
        <meta name="msapplication-TileImage" content="/mstile-144x144.ico">
        <meta name="theme-color" content="#009688">
        <!-- favicon end -->
        <!-- <link href="//ok.ico" rel="icon"> -->
        
        <!-- toc -->
        <!-- <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css"> -->
        <!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
        <!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">-->
        <!-- material design -->
        <!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
        <!-- <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css"> -->
        <!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
        <!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css"> -->
        <!--<link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">-->
        <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
        <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
        <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
        
        <!-- <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>-->
        <!-- <script>window.jQuery || document.write('<script src="/libs/jquery-3.1.1.slim.min.js" type="text/javascript"><\/script>')</script>-->
    <meta name="generator" content="Hexo 4.2.1"></head>

<body>
    <nav class="navbar navbar-default">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">èœå•</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" title="ä¸‹ä¸€å¥æ˜¯ï¼šå®¢æœ‰å¯äººæœŸä¸æ¥ã€‚å°æ—¶å€™ï¼Œå–œæ¬¢é åœ¨é˜³å°ä¸Šï¼Œä¸€è¾¹å¹é£ï¼Œä¸€è¾¹çœ‹ä¹¦ï¼Œå–œæ¬¢è¯»ä¹¦å—ï¼Œéªšå¹´ï¼Ÿ" href="/">ä¹¦å½“å¿«æ„è¯»æ˜“å°½</a>
           
		</div>
		<div id="navbar" class="collapse navbar-collapse">
			<ul class="nav navbar-nav navbar-right">
				
				<li>
					<a href="https://huangzhike.github.io/archives" title="">
						<i class="fa fa-list"></i>Archives
					</a>
				</li>
				
				<li>
					<a href="https://github.com/huangzhike" target="_blank" rel="noopener" title="">
						<i class="fa fa-github"></i>GitHub
					</a>
				</li>
				
			</ul>
		</div>
	</div>
</nav>

    <div class="container" >
        <div class="row">
	
		<div class="col-md-9 center-content">
			
			<div class="content">
				<!-- index -->
				
				<h2>[ç¬”è®°]-HashMap</h2>
				
				<div>
					<div class="post-time">2019-11-29</div>
				</div>
				
				<div class="article-content">
				<p>jdk1.8.0_211</p>
<hr>
<p>HashMap</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">HashMap</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name">AbstractMap</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">Map</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">,</span> Cloneable<span class="token punctuation">,</span> Serializable <span class="token punctuation">{</span>

    <span class="token comment" spellcheck="true">/**
     * é»˜è®¤åˆå§‹å®¹é‡ï¼ŒæŒ‡çš„æ˜¯æ•°ç»„çš„é•¿åº¦ï¼Œä¸æ˜¯å“ˆå¸Œè¡¨ä¸­çš„èŠ‚ç‚¹æ•°é‡ï¼Œ1 * 2^4 = 16ï¼Œå¿…é¡»æ˜¯2çš„å¹‚
     * å¦‚æœcapacityä¸º2çš„æŒ‡æ•°å¹‚ï¼Œåœ¨å¯»å€æ—¶ï¼Œhash &amp; (capacity - 1) == hash % capacityï¼Œç›¸å½“äºå–æ¨¡ï¼Œæé«˜è®¡ç®—é€Ÿåº¦
     * è€Œä¸”å› ä¸ºæ•°ç»„çš„å®¹é‡ä¸€èˆ¬éƒ½ä¸ä¼šå¤ªå¤§ï¼Œä¹Ÿå°±æ˜¯è¯´(capacity - 1)çš„é«˜ä½åŸºæœ¬éƒ½æ˜¯0ï¼Œé‚£ä¹ˆå‚ä¸&amp;å“ˆå¸Œçš„æœ‰æ•ˆæ•°å­—åŸºæœ¬æ¥è‡ªä½ä½
     * å¦‚æœæ˜¯2çš„å¹‚ï¼Œå¦‚16ï¼ŒäºŒè¿›åˆ¶è¡¨ç¤ºä¸º10000ï¼Œ(capacity - 1) = 15ï¼ŒäºŒè¿›åˆ¶ä¸º1111ï¼Œä½¿å¾—&amp;å“ˆå¸Œå€¼çš„äºŒè¿›åˆ¶ä½å…¨ä¸º1ï¼Œæ•£åˆ—èŒƒå›´æ›´å¹¿ï¼Œå‡å°‘å“ˆå¸Œå†²çª
     * è€Œä¸”è¿™æ ·æ–¹ä¾¿æ‰©å®¹ï¼Œç›¸åŒçš„å“ˆå¸Œé‡æ–°å®šä½æ—¶ï¼Œè¦ä¹ˆåœ¨åŸä½ç½®ï¼Œè¦ä¹ˆåç§»åŸå®¹é‡
     */</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> DEFAULT_INITIAL_CAPACITY <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// aka 16</span>

    <span class="token comment" spellcheck="true">/**
     * æœ€å¤§å®¹é‡ï¼ŒæŒ‡çš„æ˜¯æ•°ç»„çš„æœ€å¤§é•¿åº¦ï¼Œ1 * 2^30
     */</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAXIMUM_CAPACITY <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">&lt;&lt;</span> <span class="token number">30</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * é»˜è®¤çš„åŠ è½½å› å­
     */</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">float</span> DEFAULT_LOAD_FACTOR <span class="token operator">=</span> <span class="token number">0.75f</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * æ ‘åŒ–é˜ˆå€¼ï¼Œé“¾è¡¨é•¿åº¦åˆ°è¾¾æ—¶éœ€è¦è½¬åŒ–ä¸ºçº¢é»‘æ ‘
     */</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> TREEIFY_THRESHOLD <span class="token operator">=</span> <span class="token number">8</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * éæ ‘åŒ–é˜ˆå€¼ï¼Œæ‰©å®¹æ—¶ï¼Œå°è¯•å°†æ ‘åˆ‡åˆ†ä¸ºä¸¤æ¡é“¾è¡¨ï¼Œå½“é“¾è¡¨é•¿åº¦å°äºæ­¤é˜ˆå€¼æ—¶ï¼Œå°†é“¾è¡¨è½¬åŒ–ä¸ºæ™®é€šé“¾è¡¨
     */</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> UNTREEIFY_THRESHOLD <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * æœ€å°æ ‘åŒ–å®¹é‡ï¼Œå½“æ•°ç»„é•¿åº¦æœªè¾¾åˆ°æ—¶ä¸ä¼šè¿›è¡Œçº¢é»‘æ ‘è½¬åŒ–ï¼Œåªæ˜¯æ‰©å®¹å’Œæ‹†åˆ†é“¾è¡¨
     */</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MIN_TREEIFY_CAPACITY <span class="token operator">=</span> <span class="token number">64</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * æ ¹èŠ‚ç‚¹æ•°ç»„é›†åˆï¼Œç”¨transientè¯´æ˜ä¸èƒ½åºåˆ—åŒ–ï¼Œç™¾åº¦äº†ä¸€ä¸‹ï¼Œæ‰¾åˆ°ä¸€ä¸ªè§£é‡Šï¼š
     * HashMapçš„å“ˆå¸Œå€¼æ˜¯ä¾èµ–Object#hashCodeæ–¹æ³•çš„ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯nativeæ–¹æ³•ï¼Œä¸åŒçš„è™šæ‹Ÿæœºå®ç°å¯èƒ½ä¸ä¸€æ ·ï¼Œæ‰€ä»¥æ˜¯ä¸ºäº†é¿å…è·¨è™šæ‹Ÿæœºæ—¶çš„é—®é¢˜
     * åºåˆ—åŒ–æ—¶æ˜¯é€šè¿‡writeObjectæ–¹æ³•çš„ï¼Œéå†å…ƒç´ åºåˆ—åŒ–ï¼Œè¿™æ ·å¯ä»¥æ ¹æ®å…ƒç´ çš„æ•°é‡è€Œä¸æ˜¯æ•°ç»„çš„é•¿åº¦æ§åˆ¶æ¶ˆè€—çš„ç©ºé—´
     */</span>
    <span class="token keyword">transient</span> Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> table<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * é”®å€¼å¯¹é›†åˆ
     */</span>
    <span class="token keyword">transient</span> Set<span class="token operator">&lt;</span>Entry<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">>></span> entrySet<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * å“ˆå¸Œè¡¨çš„å¤§å°ï¼ŒèŠ‚ç‚¹çš„æ•°é‡
     */</span>
    <span class="token keyword">transient</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * å“ˆå¸Œè¡¨çš„ä¿®æ”¹æ¬¡æ•°ï¼ŒFailFast
     */</span>
    <span class="token keyword">transient</span> <span class="token keyword">int</span> modCount<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * å“ˆå¸Œè¡¨çš„é˜ˆå€¼ï¼ŒèŠ‚ç‚¹æ•°é‡è¾¾åˆ°åå°±ä¼šæ‰©å®¹ï¼Œç­‰äºå®¹é‡ä¹˜ä»¥åŠ è½½å› å­
     * ä¸è¿‡ä¸ºä»€ä¹ˆæ˜¯æ•°ç»„çš„å®¹é‡*åŠ è½½å› å­å‘¢ï¼Ÿè¿™ä¸ªåŠ è½½å› å­æ˜¯æ€ä¹ˆç®—çš„ï¼Ÿ
     * ä¸€èˆ¬æƒ…å†µä¸‹éƒ½æ˜¯ç›´æ¥åŸé˜ˆå€¼ç¿»å€ï¼Œæ•°ç»„æ‰©å®¹ä¹Ÿæ˜¯ç›´æ¥ç¿»å€
     */</span>
    <span class="token keyword">int</span> threshold<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * åŠ è½½å› å­ï¼Œå¼€å§‹æ‰©å®¹æ—¶çš„å…ƒç´ æ¯”ä¾‹
     * å¤ªå¤§ä¼šå¯¼è‡´å†²çªå˜å¤šï¼ŒæŸ¥æ‰¾æ•ˆç‡ä¸‹é™ï¼Œå¤ªå°ä¼šé¢‘ç¹æ‰©å®¹ï¼Œå½±å“æ€§èƒ½
     * æ‰€ä»¥åˆå§‹åŒ–æ—¶åº”è¯¥è®¾ç½®åˆç†çš„å®¹é‡å’ŒåŠ è½½å› å­
     */</span>
    <span class="token keyword">final</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">;</span>

<span class="token punctuation">}</span></code></pre>
<p>HashMap$Node</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">static</span> <span class="token keyword">class</span> <span class="token class-name">Node</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">Entry</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token keyword">final</span> <span class="token keyword">int</span> hash<span class="token punctuation">;</span>

        <span class="token keyword">final</span> K key<span class="token punctuation">;</span>

        V value<span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">/**
         * å•å‘é“¾è¡¨èŠ‚ç‚¹ï¼ŒæŒ‡å‘åç»§èŠ‚ç‚¹
         */</span>
        Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> next<span class="token punctuation">;</span>

    <span class="token punctuation">}</span></code></pre>
<p>HashMap$TreeNode</p>
<pre class=" language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**
     * è¿™é‡ŒTreeNodeç»§æ‰¿äº†LinkedHashMapçš„Entryï¼Œæ‰€ä»¥è¿˜ä¼šæœ‰beforeå’Œafterä¸¤ä¸ªåŒå‘æŒ‡é’ˆï¼Œä¸è¿‡HashMapæ˜¯ç”¨ä¸åˆ°çš„ï¼Œè€Œæ˜¯ç»™LinkedHashMapç”¨
     * ä¸æ˜ç™½ä¸ºä»€ä¹ˆä½¿ç”¨è¿™ä¹ˆéš¾çœ‹çš„æ–¹å¼ï¼Œå¦‚æœéœ€è¦å…¼å®¹HashMapçš„Nodeã€TreeNodeå’ŒLinkedHashMapè‡ªå·±çš„Entryçš„è¯
     * ä¸ºä»€ä¹ˆä¸åˆ†åˆ«ç»§æ‰¿å‘¢ï¼ŒNodeEntryç»§æ‰¿Nodeï¼ŒTreeNodeEntryç»§æ‰¿TreeNodeï¼Œè¿™æ ·ä¸æ˜¯æ›´å¥½å—
     */</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">class</span> <span class="token class-name">TreeNode</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name">LinkedHashMap<span class="token punctuation">.</span>Entry</span><span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> <span class="token punctuation">{</span>

       <span class="token comment" spellcheck="true">/**
        * çº¢é»‘æ ‘èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹å¼•ç”¨
        */</span>
        TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> parent<span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// red-black tree links</span>

        <span class="token comment" spellcheck="true">/**
         * çº¢é»‘æ ‘èŠ‚ç‚¹çš„å·¦å­©å­å¼•ç”¨
         */</span>
        TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> left<span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">/**
         * çº¢é»‘æ ‘èŠ‚ç‚¹çš„å³å­©å­å¼•ç”¨
         */</span>
        TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> right<span class="token punctuation">;</span>

        <span class="token comment" spellcheck="true">/**
         * åŒå‘é“¾è¡¨èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹å¼•ç”¨
         * è¯´æ˜¯åŒå‘ï¼Œå› ä¸ºHashMapçš„TreeNodeç»§æ‰¿äº†LinkedHashMapçš„Entryï¼Œè€ŒLinkedHashMapçš„Entryç»§æ‰¿äº†HashMapçš„Node
         * æ‰€ä»¥è¿˜æœ‰ä¸€ä¸ªæŒ‡å‘å‰é©±èŠ‚ç‚¹çš„å¼•ç”¨nextï¼Œåœ¨é“¾è¡¨èŠ‚ç‚¹è½¬åŒ–ä¸ºçº¢é»‘æ ‘èŠ‚ç‚¹æ—¶ä¿ç•™
         */</span>
        TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> prev<span class="token punctuation">;</span>    <span class="token comment" spellcheck="true">// needed to unlink next upon deletion</span>

        <span class="token keyword">boolean</span> red<span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>æ„é€ æ–¹æ³•</p>
<p>HashMap</p>
<pre class=" language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**
     * æ ¹æ®æŒ‡å®šçš„åˆå§‹å®¹é‡å’ŒåŠ è½½å› å­åˆå§‹åŒ–HashMap
     */</span>
    <span class="token keyword">public</span> <span class="token function">HashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">,</span> <span class="token keyword">float</span> loadFactor<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// ...</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loadFactor <span class="token operator">=</span> loadFactor<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// æ ¹æ®åˆå§‹å®¹é‡è®¡ç®—æ‰©å®¹çš„é˜ˆå€¼ï¼Œè¿”å›çš„æ˜¯æœ€æ¥è¿‘åˆå§‹å®¹é‡çš„2çš„Næ¬¡æ–¹å®¹é‡ï¼Œå¿…é¡»æ˜¯2^N</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>threshold <span class="token operator">=</span> <span class="token function">tableSizeFor</span><span class="token punctuation">(</span>initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">HashMap</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">(</span>initialCapacity<span class="token punctuation">,</span> DEFAULT_LOAD_FACTOR<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">HashMap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// ä½¿ç”¨é»˜è®¤çš„åŠ è½½å› å­</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loadFactor <span class="token operator">=</span> DEFAULT_LOAD_FACTOR<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// all other fields defaulted</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">public</span> <span class="token function">HashMap</span><span class="token punctuation">(</span>Map<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">K</span><span class="token punctuation">,</span> <span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">V</span><span class="token operator">></span> m<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>loadFactor <span class="token operator">=</span> DEFAULT_LOAD_FACTOR<span class="token punctuation">;</span>
        <span class="token function">putMapEntries</span><span class="token punctuation">(</span>m<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>HashMap#tableSizeFor</p>
<pre class=" language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**
     * è·å–å¤§äºç­‰äºæŒ‡å®šå®¹é‡çš„æœ€å°2æ¬¡å¹‚
     */</span>
    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">tableSizeFor</span><span class="token punctuation">(</span><span class="token keyword">int</span> cap<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// é¿å…ä¼ å…¥2æ¬¡å¹‚ï¼Œå¦‚8æ—¶ï¼Œè¿”å›16</span>
        <span class="token keyword">int</span> n <span class="token operator">=</span> cap <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">1</span><span class="token punctuation">;</span>
        n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">2</span><span class="token punctuation">;</span>
        n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">4</span><span class="token punctuation">;</span>
        n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">8</span><span class="token punctuation">;</span>
        n <span class="token operator">|=</span> n <span class="token operator">>>></span> <span class="token number">16</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>n <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token punctuation">(</span>n <span class="token operator">>=</span> MAXIMUM_CAPACITY<span class="token punctuation">)</span> <span class="token operator">?</span> MAXIMUM_CAPACITY <span class="token operator">:</span> n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<hr>
<p>HashMap#put</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">public</span> V <span class="token function">put</span><span class="token punctuation">(</span>K key<span class="token punctuation">,</span> V value<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// è®¡ç®—Keyçš„å“ˆå¸Œå€¼ï¼Œå†æ”¾å…¥</span>
        <span class="token keyword">return</span> <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>HashMap#hash</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> <span class="token function">hash</span><span class="token punctuation">(</span>Object key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> h<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">/*
         * å› ä¸ºObject#hashCodeä½ä½ç›¸åŒçš„å¯èƒ½æ€§æ¯”è¾ƒå¤§
         * æŠŠä¸€ä¸ª32ä½çš„Intç±»å‹æ— ç¬¦å·å³ç§»16ä½ï¼Œç›¸å½“äºæŠŠé«˜ä½ç§»åˆ°ä½ä½ï¼Œå†å’ŒåŸå€¼åšå¼‚æˆ–è¿ç®—ï¼Œè¿™æ ·å¯ä»¥é™ä½å“ˆå¸Œå†²çªçš„å‡ ç‡
         * å¯¹äºKeyä¸ºnullçš„æƒ…å†µï¼Œæ”¾åœ¨æ•°ç»„çš„ç¬¬ä¸€ä¸ªä½ç½®
         */</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>key <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> <span class="token punctuation">(</span>h <span class="token operator">=</span> key<span class="token punctuation">.</span><span class="token function">hashCode</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>h <span class="token operator">>>></span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>HashMap#putVal</p>
<pre class=" language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**
     * çº¿ç¨‹ä¸å®‰å…¨ï¼Œå‡å¦‚ä¸¤ä¸ªçº¿ç¨‹åŒæ—¶Putæ•°æ®ï¼Œå¹¶ä¸”æ­¤æ—¶ä¸¤ä¸ªKeyå‘ç”Ÿäº†å†²çªï¼Œåˆ™å¯èƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹çš„å€¼ä¼šè¢«è¦†ç›–
     */</span>
    <span class="token keyword">final</span> V <span class="token function">putVal</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> K key<span class="token punctuation">,</span> V value<span class="token punctuation">,</span> <span class="token keyword">boolean</span> onlyIfAbsent<span class="token punctuation">,</span> <span class="token keyword">boolean</span> evict<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span>
        Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> p<span class="token punctuation">;</span>
        <span class="token keyword">int</span> n<span class="token punctuation">,</span> i<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å¦‚æœæ•°ç»„ä¸ºç©ºï¼Œè¿˜æ²¡æ·»åŠ æ•°æ®ï¼Œå³ç¬¬ä¸€æ¬¡Put</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">==</span> null <span class="token operator">||</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true">// æ‰©å®¹ï¼Œåˆå§‹åŒ–æ•°ç»„ï¼Œè¿”å›åˆå§‹åŒ–åçš„æ•°ç»„é•¿åº¦</span>
            n <span class="token operator">=</span> <span class="token punctuation">(</span>tab <span class="token operator">=</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è¿”å›æ•°ç»„ä¸­è¯¥å“ˆå¸Œå¯¹åº”çš„èŠ‚ç‚¹ï¼Œå¦‚æœè¿˜æ²¡è¢«å ä½</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">=</span> tab<span class="token punctuation">[</span>i <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">==</span> null<span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true">// ç›´æ¥åˆ›å»ºä¸€ä¸ªæ–°èŠ‚ç‚¹æ’å…¥æ•°ç»„</span>
            tab<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// è¯´æ˜å‘ç”Ÿäº†å“ˆå¸Œå†²çª</span>
            Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> e<span class="token punctuation">;</span>
            K k<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// å¦‚æœå·²ç»å­˜åœ¨çš„PrevèŠ‚ç‚¹çš„å“ˆå¸Œå’Œæ–°èŠ‚ç‚¹çš„å“ˆå¸Œå€¼ç›¸ç­‰ &amp;&amp; ä¸¤ä¸ªèŠ‚ç‚¹çš„Keyä¹Ÿä¸€æ ·ï¼Œ==æˆ–equalsï¼Œæ‰€ä»¥Keyéœ€è¦é‡å†™equalsæ–¹æ³•</span>
            <span class="token comment" spellcheck="true">// æ‰¾åˆ°äº†Keyå¯¹åº”çš„èŠ‚ç‚¹</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                e <span class="token operator">=</span> p<span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
                <span class="token comment" spellcheck="true">// å¦‚æœKeyä¸ç›¸ç­‰ï¼Œå¹¶ä¸”å·²å­˜åœ¨çš„èŠ‚ç‚¹æ˜¯çº¢é»‘æ ‘çš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆéå†æ ‘ï¼Œå¦‚æœæ‰¾åˆ°Keyå¯¹åº”çš„èŠ‚ç‚¹å°±è¿”å›è¯¥èŠ‚ç‚¹ï¼Œå¦åˆ™æ’å…¥æ–°çš„èŠ‚ç‚¹</span>
                e <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">)</span> p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">putTreeVal</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> tab<span class="token punctuation">,</span> hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// å¦‚æœKeyä¸ç›¸ç­‰ï¼Œå¹¶ä¸”ä¹‹å‰å·²å­˜åœ¨çš„èŠ‚ç‚¹æ˜¯é“¾è¡¨çš„èŠ‚ç‚¹ï¼Œé‚£ä¹ˆä»å¤´éå†é“¾è¡¨ï¼ŒåŒæ—¶ç´¯è®¡é“¾è¡¨é•¿åº¦</span>
                <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> binCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token operator">++</span>binCount<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">// ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œè¯´æ˜åˆ°äº†é“¾è¡¨å°¾</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token comment" spellcheck="true">// åˆ›å»ºæ–°çš„é“¾è¡¨èŠ‚ç‚¹ï¼Œå°†æ–°èŠ‚ç‚¹æ’å…¥é“¾è¡¨å°¾</span>
                        p<span class="token punctuation">.</span>next <span class="token operator">=</span> <span class="token function">newNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token comment" spellcheck="true">// å¦‚æœåŠ å…¥æ–°èŠ‚ç‚¹åï¼Œé“¾è¡¨çš„é•¿åº¦åˆ°è¾¾äº†é˜ˆå€¼ï¼Œé‚£ä¹ˆæŠŠé“¾è¡¨è½¬åŒ–ä¸ºçº¢é»‘æ ‘</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>binCount <span class="token operator">>=</span> TREEIFY_THRESHOLD <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// -1 for 1st</span>
                            <span class="token function">treeifyBin</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> hash<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token comment" spellcheck="true">// å¦‚æœåœ¨é“¾è¡¨ä¸­æ‰¾åˆ°äº†å“ˆå¸Œå€¼ç›¸ç­‰çš„èŠ‚ç‚¹ &amp;&amp; ä¸¤ä¸ªèŠ‚ç‚¹çš„Keyä¹Ÿä¸€æ ·ï¼Œ==æˆ–equals</span>
                    <span class="token comment" spellcheck="true">// æ‰¾åˆ°äº†Keyå¯¹åº”çš„èŠ‚ç‚¹</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token keyword">break</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ç»§ç»­éå†</span>
                    p <span class="token operator">=</span> e<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment" spellcheck="true">// è¯´æ˜æ‰¾åˆ°äº†Keyå¯¹åº”çš„èŠ‚ç‚¹</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// existing mapping for key</span>
                <span class="token comment" spellcheck="true">// åŸæœ¬çš„å€¼</span>
                V oldValue <span class="token operator">=</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// æ˜¯å¦è¦†ç›–æ—§å€¼</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>onlyIfAbsent <span class="token operator">||</span> oldValue <span class="token operator">==</span> null<span class="token punctuation">)</span>
                    e<span class="token punctuation">.</span>value <span class="token operator">=</span> value<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// è¿™ä¸ªå›è°ƒä¹Ÿæ˜¯ç©ºæ–¹æ³•ï¼ŒLinkedHashMapå®ç°</span>
                <span class="token function">afterNodeAccess</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// è¿”å›æ—§çš„å€¼</span>
                <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">// ä¿®æ”¹æ¬¡æ•°è‡ªå¢</span>
        <span class="token operator">++</span>modCount<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// èŠ‚ç‚¹çš„æ•°é‡è‡ªå¢ï¼Œå¦‚æœHashMapä¸­çš„å…ƒç´ æ•°é‡å¤§äºé˜ˆå€¼ï¼Œé‚£ä¹ˆæ‰©å®¹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">++</span>size <span class="token operator">></span> threshold<span class="token punctuation">)</span>
            <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// ç©ºæ–¹æ³•ï¼Œæ’å…¥èŠ‚ç‚¹åçš„å›è°ƒï¼ŒLinkedHashMapå®ç°</span>
        <span class="token function">afterNodeInsertion</span><span class="token punctuation">(</span>evict<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è¯´æ˜ä¸å­˜åœ¨ç›¸ç­‰çš„Key</span>
        <span class="token keyword">return</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>HashMap#resize</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">final</span> Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> oldTab <span class="token operator">=</span> table<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// æ‰©å®¹å‰çš„æ•°ç»„å®¹é‡</span>
        <span class="token keyword">int</span> oldCap <span class="token operator">=</span> <span class="token punctuation">(</span>oldTab <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token number">0</span> <span class="token operator">:</span> oldTab<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// æ‰©å®¹å‰çš„é˜ˆå€¼</span>
        <span class="token keyword">int</span> oldThr <span class="token operator">=</span> threshold<span class="token punctuation">;</span>
        <span class="token keyword">int</span> newCap<span class="token punctuation">,</span> newThr <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å¦‚æœæ•°ç»„å·²ç»åˆå§‹åŒ–</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// å¦‚æœæ•°ç»„å®¹é‡è¶…å‡ºäº†æœ€å¤§å®¹é‡ï¼Œè®¾ç½®æ–°é˜ˆå€¼ä¸ºæœ€å¤§ï¼Œå¹¶ä¸”ä¸å†æ‰©å®¹</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>oldCap <span class="token operator">>=</span> MAXIMUM_CAPACITY<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                threshold <span class="token operator">=</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">;</span>
                <span class="token keyword">return</span> oldTab<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
            <span class="token comment" spellcheck="true">// å¦åˆ™æ‰©å®¹ï¼Œæ•°ç»„å®¹é‡ç¿»å€</span>
            <span class="token comment" spellcheck="true">// å¦‚æœæ‰©å®¹åçš„æ•°ç»„å®¹é‡å°äºæœ€å¤§å®¹é‡é™åˆ¶ï¼Œå¹¶ä¸”æ‰©å®¹å‰çš„æ•°ç»„å®¹é‡å¤§äºç­‰äºé»˜è®¤å®¹é‡ï¼Œé‚£ä¹ˆé˜ˆå€¼ç¿»å€</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>newCap <span class="token operator">=</span> oldCap <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&lt;</span> MAXIMUM_CAPACITY <span class="token operator">&amp;&amp;</span> oldCap <span class="token operator">>=</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">)</span>
                newThr <span class="token operator">=</span> oldThr <span class="token operator">&lt;&lt;</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// double threshold</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">// å¦‚æœæ•°ç»„è¿˜æ²¡åˆå§‹åŒ–ï¼Œå¹¶ä¸”æ‰©å®¹å‰çš„é˜ˆå€¼å¤§äºé›¶ï¼Œå³åˆå§‹åŒ–HashMapæ—¶è®¾ç½®äº†é˜ˆå€¼ï¼Œç¬¬ä¸€æ¬¡Putçš„æƒ…å†µ</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>oldThr <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// initial capacity was placed in threshold</span>
            <span class="token comment" spellcheck="true">// åˆå§‹åŒ–æ•°ç»„çš„é•¿åº¦ä¸ºé˜ˆå€¼çš„å¤§å°</span>
            newCap <span class="token operator">=</span> oldThr<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// æ•°ç»„è¿˜æ²¡åˆå§‹åŒ–ï¼Œå¹¶ä¸”åŸæœ¬çš„é˜ˆå€¼ç­‰äºé›¶ï¼Œå³åˆå§‹åŒ–HashMapæ—¶ä¸ä¼ å‚æ•°ï¼Œç¬¬ä¸€æ¬¡Putçš„æƒ…å†µ</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>               <span class="token comment" spellcheck="true">// zero initial threshold signifies using defaults</span>
            <span class="token comment" spellcheck="true">// åˆå§‹åŒ–æ•°ç»„å®¹é‡ä¸ºé»˜è®¤çš„åˆå§‹å®¹é‡</span>
            newCap <span class="token operator">=</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// åˆå§‹åŒ–é˜ˆå€¼ä¸ºé»˜è®¤åŠ è½½å› å­ä¸é»˜è®¤åˆå§‹å®¹é‡çš„ä¹˜ç§¯</span>
            newThr <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> <span class="token punctuation">(</span>DEFAULT_LOAD_FACTOR <span class="token operator">*</span> DEFAULT_INITIAL_CAPACITY<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">// å¦‚æœæ–°çš„é˜ˆå€¼ä¸ºé›¶ï¼Œé‚£ä¹ˆæŠŠæ–°çš„é˜ˆå€¼æ”¹ä¸ºæ•°ç»„å®¹é‡ä¸åŠ è½½å› å­çš„ä¹˜ç§¯ï¼Œä½†æ˜¯ä¸èƒ½è¶…è¿‡æœ€å¤§å®¹é‡é™åˆ¶</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>newThr <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">float</span> ft <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> newCap <span class="token operator">*</span> loadFactor<span class="token punctuation">;</span>
            newThr <span class="token operator">=</span> <span class="token punctuation">(</span>newCap <span class="token operator">&lt;</span> MAXIMUM_CAPACITY <span class="token operator">&amp;&amp;</span> ft <span class="token operator">&lt;</span> <span class="token punctuation">(</span><span class="token keyword">float</span><span class="token punctuation">)</span> MAXIMUM_CAPACITY <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token keyword">int</span><span class="token punctuation">)</span> ft <span class="token operator">:</span> Integer<span class="token punctuation">.</span>MAX_VALUE<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        threshold <span class="token operator">=</span> newThr<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// æ ¹æ®æ–°çš„æ•°ç»„å®¹é‡åˆå§‹åŒ–æ–°çš„æ•°ç»„</span>
        <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token string">"rawtypes"</span><span class="token punctuation">,</span> <span class="token string">"unchecked"</span><span class="token punctuation">}</span><span class="token punctuation">)</span> Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> newTab <span class="token operator">=</span> <span class="token punctuation">(</span>Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">new</span> <span class="token class-name">Node</span><span class="token punctuation">[</span>newCap<span class="token punctuation">]</span><span class="token punctuation">;</span>
        table <span class="token operator">=</span> newTab<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å¦‚æœåŸæœ¬æ•°ç»„å·²ç»åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦æ‰©å®¹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>oldTab <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// éå†åŸæœ¬æ•°ç»„çš„èŠ‚ç‚¹</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> j <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> j <span class="token operator">&lt;</span> oldCap<span class="token punctuation">;</span> <span class="token operator">++</span>j<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> e<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// è·å–æ•°ç»„å¯¹åº”ä½ç½®çš„èŠ‚ç‚¹ï¼Œå¦‚æœå­˜åœ¨</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">// å…ˆç½®ç©ºå¼•ç”¨</span>
                    oldTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> null<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// å¦‚æœè¯¥èŠ‚ç‚¹æ²¡æœ‰åç»­èŠ‚ç‚¹</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>next <span class="token operator">==</span> null<span class="token punctuation">)</span>
                        <span class="token comment" spellcheck="true">// æ ¹æ®å“ˆå¸Œç›´æ¥æ·»åŠ åˆ°æ–°æ•°ç»„å¯¹åº”ä½ç½®å°±è¡Œäº†</span>
                        newTab<span class="token punctuation">[</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> <span class="token punctuation">(</span>newCap <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
                        <span class="token comment" spellcheck="true">// å¦‚æœè¯¥èŠ‚ç‚¹æ˜¯ä¸ªçº¢é»‘æ ‘èŠ‚ç‚¹</span>
                    <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>e <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
                        <span class="token comment" spellcheck="true">// ä»è¯¥æ ¹èŠ‚ç‚¹å¼€å§‹ï¼ŒæŠŠæ ‘æ‹†åˆ†æˆä¸¤æ¡é“¾è¡¨æˆ–æ ‘ï¼Œå¹¶æ·»åŠ åˆ°æ–°æ•°ç»„</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span>TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">)</span> e<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> newTab<span class="token punctuation">,</span> j<span class="token punctuation">,</span> oldCap<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token comment" spellcheck="true">// å¦‚æœè¯¥èŠ‚ç‚¹æ˜¯ä¸ªé“¾è¡¨èŠ‚ç‚¹</span>
                    <span class="token keyword">else</span> <span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// preserve order</span>
                        Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> loHead <span class="token operator">=</span> null<span class="token punctuation">,</span> loTail <span class="token operator">=</span> null<span class="token punctuation">;</span>
                        Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> hiHead <span class="token operator">=</span> null<span class="token punctuation">,</span> hiTail <span class="token operator">=</span> null<span class="token punctuation">;</span>
                        Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> next<span class="token punctuation">;</span>
                        <span class="token comment" spellcheck="true">// å¼€å§‹éå†é“¾è¡¨</span>
                        <span class="token keyword">do</span> <span class="token punctuation">{</span>
                            next <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
                            <span class="token comment" spellcheck="true">// å°†è¯¥é“¾è¡¨æ‹†åˆ†ä¸ºé«˜ä½ä¸¤æ¡é“¾è¡¨ï¼ŒåŒæ—¶ä¿æŒé¡ºåº</span>
                            <span class="token comment" spellcheck="true">/*
                             * (n - 1) &amp; hash)
                             * å‡è®¾æ•°ç»„é•¿åº¦ä¸º16ï¼Œå³10000ï¼Œå‡1å°±æ˜¯15ï¼Œå³01111ï¼Œæ‰©å®¹åï¼Œæ•°ç»„é•¿åº¦ç”±16å˜æˆ32ï¼Œå³10000
                             * æƒ…å†µä¸€ï¼šå‡è®¾å“ˆå¸Œå€¼ä¸º1353ï¼Œå³010101001001ï¼Œè¿™é‡Œå³èµ·ç¬¬äº”ä½æ˜¯0
                             * 16 &amp; 1353 = 0, 15 &amp; 1353 = 9, 31 &amp; 1353 = 9
                             * æ‰€ä»¥æ‰©å®¹åä¸‹æ ‡ä¹Ÿæ˜¯ä¸å˜çš„
                             * æƒ…å†µäºŒï¼šå‡è®¾å“ˆå¸Œå€¼ä¸º1361ï¼Œå³010101010001ï¼Œè¿™é‡Œå³èµ·ç¬¬äº”ä½æ˜¯1
                             * 16 &amp; 1361 = 16 !=0, 15 &amp; 1361 = 1, 31 &amp; 1361 = 17
                             * æ‰€ä»¥æ‰©å®¹åä¸‹æ ‡åç§»äº†16ï¼Œåˆšå¥½æ˜¯æ‰©å®¹çš„é•¿åº¦
                             */</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> oldCap<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                                <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">==</span> null<span class="token punctuation">)</span>
                                    loHead <span class="token operator">=</span> e<span class="token punctuation">;</span>
                                <span class="token keyword">else</span>
                                    loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>
                                loTail <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
                                <span class="token comment" spellcheck="true">// ...</span>
                            <span class="token punctuation">}</span>
                        <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> next<span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>loTail <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> null<span class="token punctuation">;</span>
                            <span class="token comment" spellcheck="true">// ä½é“¾è¡¨æ’å…¥åˆ°æ–°æ•°ç»„çš„ä½ç½®å’Œæ—§æ•°ç»„çš„ä½ç½®ä¸€æ ·</span>
                            newTab<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> loHead<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>hiTail <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            hiTail<span class="token punctuation">.</span>next <span class="token operator">=</span> null<span class="token punctuation">;</span>
                            <span class="token comment" spellcheck="true">// é«˜é“¾è¡¨çš„æ’å…¥ä½ç½®åç§»æ‰©å®¹çš„é•¿åº¦</span>
                            <span class="token comment" spellcheck="true">// æ‰€ä»¥è¿ç§»çš„æ—¶å€™ï¼ŒèŠ‚ç‚¹è¦ä¹ˆåœ¨åŸä½ç½®ï¼Œè¦ä¹ˆåœ¨åŸä½ç½®åç§»åŸå®¹é‡é•¿åº¦</span>
                            newTab<span class="token punctuation">[</span>j <span class="token operator">+</span> oldCap<span class="token punctuation">]</span> <span class="token operator">=</span> hiHead<span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> newTab<span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>HashMap$TreeNode#split</p>
<pre class=" language-java"><code class="language-java">        <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">split</span><span class="token punctuation">(</span>HashMap<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> map<span class="token punctuation">,</span> Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">,</span> <span class="token keyword">int</span> index<span class="token punctuation">,</span> <span class="token keyword">int</span> bit<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> b <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// Relink into lo and hi lists, preserving order</span>
            <span class="token comment" spellcheck="true">// åˆ‡åˆ†æˆä¸¤æ¡é“¾è¡¨ï¼Œä¿ç•™é¡ºåº</span>
            TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> loHead <span class="token operator">=</span> null<span class="token punctuation">,</span> loTail <span class="token operator">=</span> null<span class="token punctuation">;</span>
            TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> hiHead <span class="token operator">=</span> null<span class="token punctuation">,</span> hiTail <span class="token operator">=</span> null<span class="token punctuation">;</span>
            <span class="token keyword">int</span> lc <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> hc <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// çº¢é»‘æ ‘èŠ‚ç‚¹æ˜¯ç”±é“¾è¡¨èŠ‚ç‚¹è½¬åŒ–è€Œæ¥çš„ï¼Œä¿ç•™äº†åŸæœ¬å•å‘é“¾è¡¨çš„åç»§èŠ‚ç‚¹çš„æŒ‡é’ˆçš„åŒæ—¶ï¼Œè¿˜åŠ äº†ä¸€ä¸ªå‰é©±èŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œæ‰€ä»¥è¿˜æ˜¯ä¸€ä¸ªåŒå‘é“¾è¡¨</span>
            <span class="token comment" spellcheck="true">// è¿™é‡Œæ˜¯ä»å½“å‰èŠ‚ç‚¹å¼€å§‹å‘åéå†ï¼Œå½“æˆé“¾è¡¨æ¥ä½¿ç”¨ï¼Œç®€åŒ–äº†éå†ï¼Œä¸ç”¨åƒéå†äºŒå‰æ ‘é‚£æ ·ç¹çä½æ•ˆ</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> e <span class="token operator">=</span> b<span class="token punctuation">,</span> next<span class="token punctuation">;</span> e <span class="token operator">!=</span> null<span class="token punctuation">;</span> e <span class="token operator">=</span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// å…ˆè·å–å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹</span>
                next <span class="token operator">=</span> <span class="token punctuation">(</span>TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">)</span> e<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// å†æ–­å¼€å½“å‰èŠ‚ç‚¹å¯¹å®ƒçš„å¼•ç”¨</span>
                e<span class="token punctuation">.</span>next <span class="token operator">=</span> null<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// å¦‚æœæŠŠå½“å‰èŠ‚ç‚¹åˆ†åˆ°ä½é“¾è¡¨</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">&amp;</span> bit<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">// å°†å½“å‰èŠ‚ç‚¹è¿½åŠ åˆ°ä½é“¾è¡¨å°¾ï¼Œå¦‚æœä½é“¾è¡¨è¿˜æ²¡æœ‰èŠ‚ç‚¹</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>prev <span class="token operator">=</span> loTail<span class="token punctuation">)</span> <span class="token operator">==</span> null<span class="token punctuation">)</span>
                        <span class="token comment" spellcheck="true">// é‚£å°±æ˜¯ä½é“¾è¡¨çš„å¤´èŠ‚ç‚¹</span>
                        loHead <span class="token operator">=</span> e<span class="token punctuation">;</span>
                        <span class="token comment" spellcheck="true">// å·²ç»å­˜åœ¨å°¾èŠ‚ç‚¹</span>
                    <span class="token keyword">else</span>
                        <span class="token comment" spellcheck="true">// åŒå‘é“¾è¡¨ï¼Œè¿˜æœ‰ä¸€ä¸ªæŒ‡é’ˆ</span>
                        loTail<span class="token punctuation">.</span>next <span class="token operator">=</span> e<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// æ›´æ–°ä½é“¾è¡¨å°¾çš„èŠ‚ç‚¹</span>
                    loTail <span class="token operator">=</span> e<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// ç»Ÿè®¡æ–°çš„ä½é“¾è¡¨çš„èŠ‚ç‚¹æ•°é‡</span>
                    <span class="token operator">++</span>lc<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment" spellcheck="true">// å¦‚æœæŠŠå½“å‰èŠ‚ç‚¹åˆ†åˆ°é«˜é“¾è¡¨</span>
                <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">// ...</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment" spellcheck="true">// å¦‚æœæœ‰èŠ‚ç‚¹åˆ†åˆ°ä½é“¾è¡¨</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>loHead <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// å¦‚æœä½é“¾è¡¨çš„é•¿åº¦å°äºé˜ˆå€¼</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>lc <span class="token operator">&lt;=</span> UNTREEIFY_THRESHOLD<span class="token punctuation">)</span>
                    <span class="token comment" spellcheck="true">// éå†å°†çº¢é»‘æ ‘èŠ‚ç‚¹è½¬ä¸ºæ™®é€šçš„é“¾è¡¨èŠ‚ç‚¹ï¼Œæ’å…¥å›æ•°ç»„çš„åŸä½ç½®</span>
                    tab<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> loHead<span class="token punctuation">.</span><span class="token function">untreeify</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">// å…ˆæŠŠä½é“¾è¡¨çš„å¤´èŠ‚ç‚¹æ’å›åŸä½</span>
                    tab<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> loHead<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// å¦‚æœæœ‰é«˜é“¾è¡¨ï¼Œæ‰æŠŠä½é“¾è¡¨è½¬ä¸ºæ–°çš„çº¢é»‘æ ‘</span>
                    <span class="token comment" spellcheck="true">// å› ä¸ºå¦‚æœé«˜é“¾è¡¨ä¸å­˜åœ¨ï¼Œè¯´æ˜åŸæ¥æ‰€æœ‰çš„æ ‘èŠ‚ç‚¹ä»åœ¨ä½é“¾è¡¨ä¸Šï¼Œæ ‘ç»“æ„ä¸å˜ï¼Œä¸éœ€è¦è½¬åŒ–</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>hiHead <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">// (else is already treeified)</span>
                        loHead<span class="token punctuation">.</span><span class="token function">treeify</span><span class="token punctuation">(</span>tab<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>hiHead <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>hc <span class="token operator">&lt;=</span> UNTREEIFY_THRESHOLD<span class="token punctuation">)</span>
                    <span class="token comment" spellcheck="true">// åˆ†å‰²æ ‘å‰æ˜¯è¦æ‰©å®¹çš„ï¼Œé«˜é“¾è¡¨å°±åç§»æ‰©å®¹çš„é•¿åº¦æ’å…¥</span>
                    tab<span class="token punctuation">[</span>index <span class="token operator">+</span> bit<span class="token punctuation">]</span> <span class="token operator">=</span> hiHead<span class="token punctuation">.</span><span class="token function">untreeify</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    tab<span class="token punctuation">[</span>index <span class="token operator">+</span> bit<span class="token punctuation">]</span> <span class="token operator">=</span> hiHead<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>loHead <span class="token operator">!=</span> null<span class="token punctuation">)</span>
                        hiHead<span class="token punctuation">.</span><span class="token function">treeify</span><span class="token punctuation">(</span>tab<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span></code></pre>
<p>HashMap$TreeNode#putTreeVal</p>
<pre class=" language-java"><code class="language-java">        <span class="token keyword">final</span> TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> <span class="token function">putTreeVal</span><span class="token punctuation">(</span>HashMap<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> map<span class="token punctuation">,</span> Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">,</span> <span class="token keyword">int</span> h<span class="token punctuation">,</span> K k<span class="token punctuation">,</span> V v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> kc <span class="token operator">=</span> null<span class="token punctuation">;</span>
            <span class="token keyword">boolean</span> searched <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// çº¢é»‘æ ‘çš„æ ¹èŠ‚ç‚¹</span>
            TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> root <span class="token operator">=</span> <span class="token punctuation">(</span>parent <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">root</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// ä»æ ¹èŠ‚ç‚¹å¼€å§‹å‘ä¸‹éå†</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> p <span class="token operator">=</span> root<span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> dir<span class="token punctuation">,</span> ph<span class="token punctuation">;</span>
                K pk<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// å…ˆæ¯”è¾ƒå“ˆå¸Œå€¼ï¼Œå¦‚æœè¦æ’å…¥çš„èŠ‚ç‚¹çš„å“ˆå¸Œå€¼å°äºå½“å‰èŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¦æ’åˆ°å·¦è¾¹</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ph <span class="token operator">=</span> p<span class="token punctuation">.</span>hash<span class="token punctuation">)</span> <span class="token operator">></span> h<span class="token punctuation">)</span>
                    dir <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// å¦‚æœå“ˆå¸Œå€¼å¤§äºå½“å‰èŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¦æ’åˆ°å³è¾¹</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ph <span class="token operator">&lt;</span> h<span class="token punctuation">)</span>
                    dir <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// å¦‚æœå“ˆå¸Œå€¼ç›¸ç­‰ï¼Œå¹¶ä¸”Keyä¹Ÿç›¸ç­‰ï¼Œ== || equalsï¼Œè¯´æ˜æ‰¾åˆ°äº†èŠ‚ç‚¹ï¼Œç›´æ¥è¿”å›</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pk <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> k <span class="token operator">||</span> <span class="token punctuation">(</span>k <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> k<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>pk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> p<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// å¦‚æœå“ˆå¸Œå€¼ç›¸ç­‰ï¼Œä½†æ˜¯Keyä¸ç›¸ç­‰</span>
                    <span class="token comment" spellcheck="true">// å¦‚æœKeyå®ç°äº†Comparableæ¥å£ï¼Œè°ƒç”¨Comparable#compareToæ¯”è¾ƒï¼Œå¦‚æœæ¯”è¾ƒè¿˜ç›¸ç­‰</span>
                    <span class="token comment" spellcheck="true">// å¦å¤–è¿™é‡ŒcomparableClassForæ–¹æ³•ä¼šä¿å­˜å½“å‰èŠ‚ç‚¹çš„ç±»å‹ï¼Œç„¶åcompareComparablesæ–¹æ³•æ¯”è¾ƒæ—¶ï¼Œå¦‚æœå’Œæ’å…¥çš„èŠ‚ç‚¹ä¸æ˜¯åŒä¸€ç±»å‹ï¼Œåˆ™è®¤ä¸ºç›¸ç­‰</span>
                    <span class="token comment" spellcheck="true">// æ¯”å¦‚HashMapçš„Keyæ˜¯Objectç±»å‹ï¼Œå½“å‰èŠ‚ç‚¹çš„Keyå¯èƒ½æ˜¯Stringï¼Œæ–°æ’å…¥çš„èŠ‚ç‚¹çš„Keyå¯èƒ½æ˜¯Integer</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>kc <span class="token operator">==</span> null <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>kc <span class="token operator">=</span> <span class="token function">comparableClassFor</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>dir <span class="token operator">=</span> <span class="token function">compareComparables</span><span class="token punctuation">(</span>kc<span class="token punctuation">,</span> k<span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">// åªæœç´¢ä¸€æ¬¡ï¼Œå› ä¸ºä¸‹é¢çš„æ–¹æ³•ä¼šéå†å­æ ‘æ¯”è¾ƒï¼Œä¸éœ€è¦é‡å¤æŸ¥æ‰¾</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>searched<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> q<span class="token punctuation">,</span> ch<span class="token punctuation">;</span>
                        searched <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                        <span class="token comment" spellcheck="true">// ä»è¯¥èŠ‚ç‚¹å¼€å§‹ï¼Œå…ˆåéå†å·¦å³å­æ ‘ï¼Œå¦‚æœæ‰¾åˆ°äº†å°±ç›´æ¥è¿”å›æ‰¾åˆ°çš„èŠ‚ç‚¹</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>ch <span class="token operator">=</span> p<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>q <span class="token operator">=</span> ch<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> k<span class="token punctuation">,</span> kc<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ch <span class="token operator">=</span> p<span class="token punctuation">.</span>right<span class="token punctuation">)</span> <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>q <span class="token operator">=</span> ch<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> k<span class="token punctuation">,</span> kc<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">)</span>
                            <span class="token keyword">return</span> q<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span>
                    <span class="token comment" spellcheck="true">// å¦‚æœä¸¤è€…å“ˆå¸Œå€¼ç›¸ç­‰ï¼Œä½†æ˜¯å­æ ‘æ— æ³•æ‰¾åˆ°å¯¹åº”çš„èŠ‚ç‚¹æ—¶ï¼Œä½¿ç”¨System#identityHashCodeåšæœ€åçš„æ¯”è¾ƒ</span>
                    <span class="token comment" spellcheck="true">// System#identityHashCodeæ˜¯æ ¹æ®å†…å­˜åœ°å€è®¡ç®—å“ˆå¸Œå€¼çš„</span>
                    dir <span class="token operator">=</span> <span class="token function">tieBreakOrder</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> xp <span class="token operator">=</span> p<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// æ ¹æ®ä¸Šé¢è®¡ç®—çš„å€¼ï¼Œåˆ¤æ–­æ’å…¥åˆ°å·¦è¿˜æ˜¯å³å­èŠ‚ç‚¹</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">=</span> <span class="token punctuation">(</span>dir <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> p<span class="token punctuation">.</span>left <span class="token operator">:</span> p<span class="token punctuation">.</span>right<span class="token punctuation">)</span> <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> xpn <span class="token operator">=</span> xp<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// æ–°å»ºä¸€ä¸ªçº¢é»‘æ ‘èŠ‚ç‚¹</span>
                    TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> x <span class="token operator">=</span> map<span class="token punctuation">.</span><span class="token function">newTreeNode</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> k<span class="token punctuation">,</span> v<span class="token punctuation">,</span> xpn<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// æ’å…¥</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>dir <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
                        xp<span class="token punctuation">.</span>left <span class="token operator">=</span> x<span class="token punctuation">;</span>
                    <span class="token keyword">else</span>
                        xp<span class="token punctuation">.</span>right <span class="token operator">=</span> x<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// æ›´æ–°åŒå‘é“¾è¡¨èŠ‚ç‚¹çš„æŒ‡é’ˆ</span>
                    xp<span class="token punctuation">.</span>next <span class="token operator">=</span> x<span class="token punctuation">;</span>
                    x<span class="token punctuation">.</span>parent <span class="token operator">=</span> x<span class="token punctuation">.</span>prev <span class="token operator">=</span> xp<span class="token punctuation">;</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>xpn <span class="token operator">!=</span> null<span class="token punctuation">)</span>
                        <span class="token punctuation">(</span><span class="token punctuation">(</span>TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">)</span> xpn<span class="token punctuation">)</span><span class="token punctuation">.</span>prev <span class="token operator">=</span> x<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// æ’å…¥åï¼Œæ‰§è¡Œçº¢é»‘æ ‘å¹³è¡¡ï¼Œå¹¶ç”¨å¹³è¡¡åçš„æ ¹èŠ‚ç‚¹æ›´æ–°æ•°ç»„çš„ä½ç½®ï¼ŒåŒæ—¶å°†æ–°çš„æ ¹èŠ‚ç‚¹å˜æˆåŒå‘é“¾è¡¨çš„å¤´èŠ‚ç‚¹</span>
                    <span class="token function">moveRootToFront</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> <span class="token function">balanceInsertion</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> null<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span></code></pre>
<p>HashMap$TreeNode#find</p>
<pre class=" language-java"><code class="language-java">        <span class="token keyword">final</span> TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> <span class="token function">find</span><span class="token punctuation">(</span><span class="token keyword">int</span> h<span class="token punctuation">,</span> Object k<span class="token punctuation">,</span> Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> kc<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// Presentå½“å‰èŠ‚ç‚¹</span>
            TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> p <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// éå†äºŒå‰æ ‘</span>
            <span class="token keyword">do</span> <span class="token punctuation">{</span>
                <span class="token keyword">int</span> ph<span class="token punctuation">,</span> dir<span class="token punctuation">;</span>
                K pk<span class="token punctuation">;</span>
                TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> pl <span class="token operator">=</span> p<span class="token punctuation">.</span>left<span class="token punctuation">,</span> pr <span class="token operator">=</span> p<span class="token punctuation">.</span>right<span class="token punctuation">,</span> q<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// å¦‚æœæ¯”å½“å‰èŠ‚ç‚¹çš„å“ˆå¸Œå°ï¼Œä»å·¦å­©å­ç»§ç»­æ‰¾</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ph <span class="token operator">=</span> p<span class="token punctuation">.</span>hash<span class="token punctuation">)</span> <span class="token operator">></span> h<span class="token punctuation">)</span>
                    p <span class="token operator">=</span> pl<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// å¦‚æœæ¯”å½“å‰èŠ‚ç‚¹çš„å“ˆå¸Œå¤§ï¼Œä»å³å­©å­ç»§ç»­æ‰¾</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ph <span class="token operator">&lt;</span> h<span class="token punctuation">)</span>
                    p <span class="token operator">=</span> pr<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// å¦‚æœåˆšå¥½æ‰¾åˆ°ï¼Œç›´æ¥è¿”å›</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>pk <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> k <span class="token operator">||</span> <span class="token punctuation">(</span>k <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> k<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>pk<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                    <span class="token keyword">return</span> p<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// å¦‚æœå·¦å­©å­åˆ°å¤´äº†ï¼Œä»å³å­©å­ç»§ç»­æ‰¾</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>pl <span class="token operator">==</span> null<span class="token punctuation">)</span>
                    p <span class="token operator">=</span> pr<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// å¦‚æœå³å­©å­åˆ°å¤´äº†ï¼Œä»å·¦å­©å­ç»§ç»­</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>pr <span class="token operator">==</span> null<span class="token punctuation">)</span>
                    p <span class="token operator">=</span> pl<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// å¦‚æœå“ˆå¸Œç›¸ç­‰ï¼Œå¦‚æœKeyå®ç°äº†Comparableæ¥å£ï¼Œè¿˜è¦å†æ¯”è¾ƒä¸€æ¬¡ï¼Œå†³å®šä¸‹æ¬¡ä»å“ªè¾¹æ‰¾</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>kc <span class="token operator">!=</span> null <span class="token operator">||</span> <span class="token punctuation">(</span>kc <span class="token operator">=</span> <span class="token function">comparableClassFor</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>dir <span class="token operator">=</span> <span class="token function">compareComparables</span><span class="token punctuation">(</span>kc<span class="token punctuation">,</span> k<span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span>
                    p <span class="token operator">=</span> <span class="token punctuation">(</span>dir <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> pl <span class="token operator">:</span> pr<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// éƒ½ä¸è¡Œï¼Œä»å³è¾¹å­æ ‘æ‰¾ï¼Œæ‰¾åˆ°å°±ç›´æ¥è¿”å›</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>q <span class="token operator">=</span> pr<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span>h<span class="token punctuation">,</span> k<span class="token punctuation">,</span> kc<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span>
                    <span class="token keyword">return</span> q<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// å¦‚æœå³è¾¹å­æ ‘æ‰¾ä¸åˆ°ï¼Œä¸‹æ¬¡å†ä»å·¦å­©å­ç»§ç»­</span>
                <span class="token keyword">else</span>
                    p <span class="token operator">=</span> pl<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span>p <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> null<span class="token punctuation">;</span>
        <span class="token punctuation">}</span></code></pre>
<p>HashMap#treeifyBin</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">treeifyBin</span><span class="token punctuation">(</span>Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">,</span> <span class="token keyword">int</span> hash<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">int</span> n<span class="token punctuation">,</span> index<span class="token punctuation">;</span>
        Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> e<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å½“å‰æ•°ç»„æœªåˆå§‹åŒ– || æ•°ç»„å®¹é‡å°äºæ ‘åŒ–çš„æœ€å°å®¹é‡</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>tab <span class="token operator">==</span> null <span class="token operator">||</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">&lt;</span> MIN_TREEIFY_CAPACITY<span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true">// ä¼˜å…ˆæ‰©å®¹ï¼Œé€šè¿‡æ‰©å®¹å‡å°‘å†²çªï¼Œè€Œä¸æ˜¯è½¬æˆæ ‘ï¼Œå¤§æ¦‚æ˜¯å› ä¸ºæ­¤æ—¶æ‰©å®¹çš„æˆæœ¬ç›¸å¯¹è¾ƒä½ï¼Ÿ</span>
            <span class="token function">resize</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// å¦åˆ™ï¼Œå¦‚æœè¯¥å“ˆå¸Œçš„ä½ç½®æœ‰èŠ‚ç‚¹</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> tab<span class="token punctuation">[</span>index <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> hd <span class="token operator">=</span> null<span class="token punctuation">,</span> tl <span class="token operator">=</span> null<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// ä»å¤´ç»“ç‚¹å¼€å§‹å‘åéå†ï¼Œå°†é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘èŠ‚ç‚¹ç»„æˆçš„åŒå‘é“¾è¡¨</span>
            <span class="token keyword">do</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// å°†é“¾è¡¨èŠ‚ç‚¹è½¬ä¸ºçº¢é»‘æ ‘èŠ‚ç‚¹</span>
                TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> p <span class="token operator">=</span> <span class="token function">replacementTreeNode</span><span class="token punctuation">(</span>e<span class="token punctuation">,</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// å‰é¢æ²¡æœ‰èŠ‚ç‚¹</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>tl <span class="token operator">==</span> null<span class="token punctuation">)</span>
                    <span class="token comment" spellcheck="true">// å°†åŸæœ¬çš„é“¾è¡¨å¤´èŠ‚ç‚¹è®¾ä¸ºæ–°çš„åŒå‘é“¾è¡¨çš„å¤´èŠ‚ç‚¹</span>
                    hd <span class="token operator">=</span> p<span class="token punctuation">;</span>
                <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">// é“¾æ¥å½¢æˆæ–°çš„åŒå‘é“¾è¡¨</span>
                    p<span class="token punctuation">.</span>prev <span class="token operator">=</span> tl<span class="token punctuation">;</span>
                    tl<span class="token punctuation">.</span>next <span class="token operator">=</span> p<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                tl <span class="token operator">=</span> p<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// å°†æ–°çš„åŒå‘é“¾è¡¨çš„å¤´èŠ‚ç‚¹æ’å…¥æ•°ç»„åŸä½ç½®</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> hd<span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span>
                <span class="token comment" spellcheck="true">// å†æŠŠåŒå‘é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘ï¼ŒåŒæ—¶ä¿ç•™é“¾è¡¨çš„å¼•ç”¨ï¼Œä¹Ÿå°±æ˜¯åŒæ—¶æœ‰å‰åå·¦å³ä¸Šäº”ä¸ªæŒ‡å‘ï¼Œå¯ä»¥å½“é“¾è¡¨ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å½“æ ‘ä½¿ç”¨</span>
                hd<span class="token punctuation">.</span><span class="token function">treeify</span><span class="token punctuation">(</span>tab<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre>
<p>HashMap$TreeNode#treeify</p>
<pre class=" language-java"><code class="language-java">        <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">treeify</span><span class="token punctuation">(</span>Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> root <span class="token operator">=</span> null<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// ä»æ­¤å¤´èŠ‚ç‚¹å¼€å§‹å‘åéå†</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span>TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> x <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">,</span> next<span class="token punctuation">;</span> x <span class="token operator">!=</span> null<span class="token punctuation">;</span> x <span class="token operator">=</span> next<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// å½“å‰èŠ‚ç‚¹çš„åä¸€ä¸ªèŠ‚ç‚¹</span>
                next <span class="token operator">=</span> <span class="token punctuation">(</span>TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">)</span> x<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// å…ˆæŠŠå·¦å³å­èŠ‚ç‚¹ç½®ç©º</span>
                x<span class="token punctuation">.</span>left <span class="token operator">=</span> x<span class="token punctuation">.</span>right <span class="token operator">=</span> null<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// ç¬¬ä¸€æ¬¡ï¼Œè¿˜æ²¡è®¾ç½®æ ‘çš„æ ¹èŠ‚ç‚¹</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    x<span class="token punctuation">.</span>parent <span class="token operator">=</span> null<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// æ ¹èŠ‚ç‚¹ä¸ºé»‘è‰²</span>
                    x<span class="token punctuation">.</span>red <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// è®¾ç½®å¤´èŠ‚ç‚¹ä¸ºæ ¹èŠ‚ç‚¹</span>
                    root <span class="token operator">=</span> x<span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
                <span class="token comment" spellcheck="true">// æ ‘å·²ç»æœ‰äº†æ ¹èŠ‚ç‚¹</span>
                <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    K k <span class="token operator">=</span> x<span class="token punctuation">.</span>key<span class="token punctuation">;</span>
                    <span class="token keyword">int</span> h <span class="token operator">=</span> x<span class="token punctuation">.</span>hash<span class="token punctuation">;</span>
                    Class<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> kc <span class="token operator">=</span> null<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// ä»æ ¹èŠ‚ç‚¹å¼€å§‹å‘ä¸‹éå†ï¼Œå’Œå½“å‰è¦æ’å…¥çš„èŠ‚ç‚¹æ¯”è¾ƒï¼Œä¸¤å±‚å¾ªç¯</span>
                    <span class="token keyword">for</span> <span class="token punctuation">(</span>TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> p <span class="token operator">=</span> root<span class="token punctuation">;</span> <span class="token punctuation">;</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>
                        <span class="token keyword">int</span> dir<span class="token punctuation">,</span> ph<span class="token punctuation">;</span>
                        K pk <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">;</span>
                        <span class="token comment" spellcheck="true">// å…ˆæ¯”è¾ƒå“ˆå¸Œå€¼ï¼Œå¦‚æœè¦æ’å…¥çš„èŠ‚ç‚¹æ¯”è¾ƒå°ï¼Œé‚£ä¹ˆå‡†å¤‡æ’å…¥åˆ°å·¦è¾¹</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>ph <span class="token operator">=</span> p<span class="token punctuation">.</span>hash<span class="token punctuation">)</span> <span class="token operator">></span> h<span class="token punctuation">)</span>
                            dir <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
                            <span class="token comment" spellcheck="true">// å¦‚æœè¦æ’å…¥çš„èŠ‚ç‚¹æ¯”è¾ƒå¤§ï¼Œé‚£ä¹ˆå‡†å¤‡æ’å…¥åˆ°å³è¾¹</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>ph <span class="token operator">&lt;</span> h<span class="token punctuation">)</span>
                            dir <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
                            <span class="token comment" spellcheck="true">// å¦‚æœå“ˆå¸Œå€¼ç›¸ç­‰ï¼ŒComparable#compareToä¹Ÿç›¸ç­‰</span>
                        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>kc <span class="token operator">==</span> null <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>kc <span class="token operator">=</span> <span class="token function">comparableClassFor</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>dir <span class="token operator">=</span> <span class="token function">compareComparables</span><span class="token punctuation">(</span>kc<span class="token punctuation">,</span> k<span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                            <span class="token comment" spellcheck="true">// System#identityHashCodeæœ€åæ¯”è¾ƒä¸€æ¬¡</span>
                            dir <span class="token operator">=</span> <span class="token function">tieBreakOrder</span><span class="token punctuation">(</span>k<span class="token punctuation">,</span> pk<span class="token punctuation">)</span><span class="token punctuation">;</span>
                        TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> xp <span class="token operator">=</span> p<span class="token punctuation">;</span>
                        <span class="token comment" spellcheck="true">// æ›´æ–°ä¸‹ä¸ªéå†çš„èŠ‚ç‚¹ï¼Œå¦‚æœå·²ç»æ²¡æœ‰å¶å­èŠ‚ç‚¹äº†ï¼Œè¯´æ˜åˆ°äº†åº•ï¼Œå‡†å¤‡æ’å…¥</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>p <span class="token operator">=</span> <span class="token punctuation">(</span>dir <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">?</span> p<span class="token punctuation">.</span>left <span class="token operator">:</span> p<span class="token punctuation">.</span>right<span class="token punctuation">)</span> <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            x<span class="token punctuation">.</span>parent <span class="token operator">=</span> xp<span class="token punctuation">;</span>
                            <span class="token keyword">if</span> <span class="token punctuation">(</span>dir <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span>
                                xp<span class="token punctuation">.</span>left <span class="token operator">=</span> x<span class="token punctuation">;</span>
                            <span class="token keyword">else</span>
                                xp<span class="token punctuation">.</span>right <span class="token operator">=</span> x<span class="token punctuation">;</span>
                            <span class="token comment" spellcheck="true">// æ’å…¥åå¹³è¡¡çº¢é»‘æ ‘ï¼Œè¿”å›å¹³è¡¡åçš„æ ¹èŠ‚ç‚¹</span>
                            root <span class="token operator">=</span> <span class="token function">balanceInsertion</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">;</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                    <span class="token punctuation">}</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment" spellcheck="true">// å°†å¹³è¡¡åçš„æ ¹èŠ‚ç‚¹ï¼Œè®¾ä¸ºåŒå‘é“¾è¡¨çš„å¤´ç»“ç‚¹ï¼Œå¹¶æ›´æ–°åˆ°æ•°ç»„å¯¹åº”çš„ä½ç½®</span>
            <span class="token function">moveRootToFront</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> root<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span></code></pre>
<hr>
<p>HashMap#get</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">public</span> V <span class="token function">get</span><span class="token punctuation">(</span>Object key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> e<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>e <span class="token operator">=</span> <span class="token function">getNode</span><span class="token punctuation">(</span><span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> null <span class="token operator">?</span> null <span class="token operator">:</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>HashMap#getNode</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">final</span> Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> <span class="token function">getNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> Object key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span>
        Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> first<span class="token punctuation">,</span> e<span class="token punctuation">;</span>
        <span class="token keyword">int</span> n<span class="token punctuation">;</span>
        K k<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// æ•°ç»„ä¸ä¸ºç©º &amp;&amp; æ•°ç»„å­˜åœ¨èŠ‚ç‚¹ &amp;&amp; ä»æ•°ç»„è·å–å“ˆå¸Œå€¼å¯¹åº”çš„ç´¢å¼•çš„å…ƒç´ ï¼Œå¹¶ä¸”å…ƒç´ ä¸ä¸ºç©º</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>first <span class="token operator">=</span> tab<span class="token punctuation">[</span><span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// å¦‚æœç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å“ˆå¸Œç­‰äºæŒ‡å®šçš„å“ˆå¸Œ &amp;&amp; è¯¥èŠ‚ç‚¹çš„Keyç­‰äºæŒ‡å®šçš„Key</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>first<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token comment" spellcheck="true">// always check first node</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> first<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                <span class="token comment" spellcheck="true">// ç›´æ¥è¿”å›è¯¥èŠ‚ç‚¹</span>
                <span class="token keyword">return</span> first<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// ç¬¬ä¸€ä¸ªèŠ‚ç‚¹åé¢è¿˜æœ‰èŠ‚ç‚¹</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> first<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// ç¬¬ä¸€ä¸ªèŠ‚ç‚¹æ˜¯çº¢é»‘æ ‘èŠ‚ç‚¹</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>first <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
                    <span class="token comment" spellcheck="true">// ä»çº¢é»‘æ ‘æŸ¥æ‰¾è¿”å›</span>
                    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">)</span> first<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTreeNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// è¯´æ˜æ˜¯é“¾è¡¨èŠ‚ç‚¹ï¼Œéå†é“¾è¡¨æŸ¥æ‰¾å¹¶è¿”å›</span>
                <span class="token keyword">do</span> <span class="token punctuation">{</span>
                    <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                        <span class="token keyword">return</span> e<span class="token punctuation">;</span>
                <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<hr>
<p>HashMap#remove</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">public</span> V <span class="token function">remove</span><span class="token punctuation">(</span>Object key<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> e<span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>e <span class="token operator">=</span> <span class="token function">removeNode</span><span class="token punctuation">(</span><span class="token function">hash</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">,</span> null<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">,</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">==</span> null <span class="token operator">?</span> null <span class="token operator">:</span> e<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>HashMap#removeNode</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">final</span> Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> <span class="token function">removeNode</span><span class="token punctuation">(</span><span class="token keyword">int</span> hash<span class="token punctuation">,</span> Object key<span class="token punctuation">,</span> Object value<span class="token punctuation">,</span> <span class="token keyword">boolean</span> matchValue<span class="token punctuation">,</span> <span class="token keyword">boolean</span> movable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">;</span>
        Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> p<span class="token punctuation">;</span>
        <span class="token keyword">int</span> n<span class="token punctuation">,</span> index<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// æ•°ç»„å­˜åœ¨ &amp;&amp; æ•°ç»„é•¿åº¦å¤§äº0 &amp;&amp; æ ¹æ®å“ˆå¸Œä»æ•°ç»„è·å–å¯¹åº”ç´¢å¼•çš„èŠ‚ç‚¹ï¼Œå¦‚æœèŠ‚ç‚¹å­˜åœ¨</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>tab <span class="token operator">=</span> table<span class="token punctuation">)</span> <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">0</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>p <span class="token operator">=</span> tab<span class="token punctuation">[</span>index <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> node <span class="token operator">=</span> null<span class="token punctuation">,</span> e<span class="token punctuation">;</span>
            K k<span class="token punctuation">;</span>
            V v<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// å¦‚æœç¬¬ä¸€ä¸ªèŠ‚ç‚¹çš„å“ˆå¸Œå€¼ä¸€è‡´ï¼ŒKeyä¹Ÿç›¸ç­‰ï¼Œè¯´æ˜æ‰¾åˆ°äº†è¦åˆ é™¤çš„èŠ‚ç‚¹</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>p<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> p<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
                node <span class="token operator">=</span> p<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// å¦åˆ™å‘åéå†ç›´åˆ°æ‰¾åˆ°</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> p<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// å¦‚æœæ˜¯ä¸ªæ ‘èŠ‚ç‚¹ï¼Œä»æ ‘æ‰¾</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>p <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
                    node <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">)</span> p<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getTreeNode</span><span class="token punctuation">(</span>hash<span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// å¦‚æœæ˜¯ä¸ªæ™®é€šçš„é“¾è¡¨èŠ‚ç‚¹ï¼Œå‘åéå†é“¾è¡¨æ‰¾</span>
                <span class="token keyword">else</span> <span class="token punctuation">{</span>
                    <span class="token keyword">do</span> <span class="token punctuation">{</span>
                        <span class="token keyword">if</span> <span class="token punctuation">(</span>e<span class="token punctuation">.</span>hash <span class="token operator">==</span> hash <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>k <span class="token operator">=</span> e<span class="token punctuation">.</span>key<span class="token punctuation">)</span> <span class="token operator">==</span> key <span class="token operator">||</span> <span class="token punctuation">(</span>key <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> key<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                            node <span class="token operator">=</span> e<span class="token punctuation">;</span>
                            <span class="token keyword">break</span><span class="token punctuation">;</span>
                        <span class="token punctuation">}</span>
                        p <span class="token operator">=</span> e<span class="token punctuation">;</span>
                    <span class="token punctuation">}</span> <span class="token keyword">while</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>e <span class="token operator">=</span> e<span class="token punctuation">.</span>next<span class="token punctuation">)</span> <span class="token operator">!=</span> null<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
            <span class="token comment" spellcheck="true">// æ‰¾åˆ°äº†è¦åˆ é™¤çš„èŠ‚ç‚¹ï¼Œå¦‚æœè¿˜è¦åŒ¹é…å€¼çš„è¯ï¼ŒåŒ¹é…å€¼æ˜¯å¦ç›¸ç­‰</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token operator">!</span>matchValue <span class="token operator">||</span> <span class="token punctuation">(</span>v <span class="token operator">=</span> node<span class="token punctuation">.</span>value<span class="token punctuation">)</span> <span class="token operator">==</span> value <span class="token operator">||</span> <span class="token punctuation">(</span>value <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> value<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// æ ‘èŠ‚ç‚¹ï¼Œè°ƒç”¨å¯¹åº”çš„åˆ é™¤æ–¹æ³•</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token keyword">instanceof</span> <span class="token class-name">TreeNode</span><span class="token punctuation">)</span>
                    <span class="token punctuation">(</span><span class="token punctuation">(</span>TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">)</span> node<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">removeTreeNode</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> tab<span class="token punctuation">,</span> movable<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// æ™®é€šçš„é“¾è¡¨èŠ‚ç‚¹ï¼Œå¹¶ä¸”æ˜¯é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œç›´æ¥æŠŠä¸‹ä¸€ä¸ªèŠ‚ç‚¹å½“æˆæ–°çš„å¤´èŠ‚ç‚¹æ’å…¥æ•°ç»„å°±å¥½</span>
                <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>node <span class="token operator">==</span> p<span class="token punctuation">)</span>
                    tab<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
                    <span class="token comment" spellcheck="true">// æ™®é€šçš„é“¾è¡¨èŠ‚ç‚¹ï¼Œå¹¶ä¸”ä¸æ˜¯é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œåªéœ€æŠŠé“¾è¡¨é‡æ–°è¿èµ·æ¥å°±å¥½</span>
                <span class="token keyword">else</span>
                    p<span class="token punctuation">.</span>next <span class="token operator">=</span> node<span class="token punctuation">.</span>next<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// ä¿®æ”¹æ¬¡æ•°é€’å¢ï¼Œå¿«é€Ÿå¤±è´¥æ£€æµ‹ç”¨</span>
                <span class="token operator">++</span>modCount<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// HashMapçš„èŠ‚ç‚¹æ•°é‡é€’å‡</span>
                <span class="token operator">--</span>size<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// åˆ é™¤èŠ‚ç‚¹åçš„å›è°ƒï¼Œä¹Ÿæ˜¯ä¸ªç©ºæ–¹æ³•ï¼ŒLinkedHashMapå®ç°</span>
                <span class="token function">afterNodeRemoval</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// è¿”å›åˆ é™¤çš„èŠ‚ç‚¹</span>
                <span class="token keyword">return</span> node<span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> null<span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>HashMap$TreeNode#removeTreeNode</p>
<pre class=" language-java"><code class="language-java">        <span class="token keyword">final</span> <span class="token keyword">void</span> <span class="token function">removeTreeNode</span><span class="token punctuation">(</span>HashMap<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> map<span class="token punctuation">,</span> Node<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span> tab<span class="token punctuation">,</span> <span class="token keyword">boolean</span> movable<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">int</span> n<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// æ•°ç»„ä¸ºç©ºï¼Œåˆ™ç›´æ¥è¿”å›</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>tab <span class="token operator">==</span> null <span class="token operator">||</span> <span class="token punctuation">(</span>n <span class="token operator">=</span> tab<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// å“ˆå¸Œå¯¹åº”çš„ä½ç½®</span>
            <span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token punctuation">(</span>n <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">&amp;</span> hash<span class="token punctuation">;</span>
            TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> first <span class="token operator">=</span> <span class="token punctuation">(</span>TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">)</span> tab<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">,</span> root <span class="token operator">=</span> first<span class="token punctuation">,</span> rl<span class="token punctuation">;</span>
            TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> succ <span class="token operator">=</span> <span class="token punctuation">(</span>TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span><span class="token punctuation">)</span> next<span class="token punctuation">,</span> pred <span class="token operator">=</span> prev<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯åŒå‘é“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œç›´æ¥å°†åç»§èŠ‚ç‚¹æ’å…¥æ•°ç»„ï¼Œå°±æ˜¯åˆ é™¤</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pred <span class="token operator">==</span> null<span class="token punctuation">)</span>
                tab<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> first <span class="token operator">=</span> succ<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// å¦åˆ™ï¼ŒæŠŠè‡ªå·±çš„å‰é©±èŠ‚ç‚¹çš„åæŒ‡é’ˆè·³è¿‡è‡ªå·±ï¼ŒæŒ‡å‘è‡ªå·±çš„åç»§èŠ‚ç‚¹ï¼Œå°±æ˜¯åˆ é™¤</span>
            <span class="token keyword">else</span>
                pred<span class="token punctuation">.</span>next <span class="token operator">=</span> succ<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// å¦‚æœå½“å‰èŠ‚ç‚¹è¿˜æœ‰åç»§èŠ‚ç‚¹ï¼Œè¿˜è¦æŠŠå®ƒçš„å‰æŒ‡é’ˆè¿æ¥ä¸Š</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>succ <span class="token operator">!=</span> null<span class="token punctuation">)</span>
                succ<span class="token punctuation">.</span>prev <span class="token operator">=</span> pred<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// ä¸Šé¢å¤„ç†å®Œäº†çº¢é»‘æ ‘èŠ‚ç‚¹çš„åŒå‘é“¾è¡¨å¼•ç”¨åï¼Œè¿˜è¦å¤„ç†æ ‘èŠ‚ç‚¹çš„å¼•ç”¨</span>
            <span class="token comment" spellcheck="true">// è¯´æ˜èŠ‚ç‚¹åé¢æ²¡æœ‰èŠ‚ç‚¹äº†ï¼Œç›´æ¥è¿”å›</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>first <span class="token operator">==</span> null<span class="token punctuation">)</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// å¦‚æœæ ¹èŠ‚ç‚¹æœ‰çˆ¶èŠ‚ç‚¹ï¼Œæ‰¾åˆ°çœŸæ­£çš„æ ¹èŠ‚ç‚¹ï¼Œå³æ•°ç»„ä¸Šçš„èŠ‚ç‚¹å¹¶ä¸æ˜¯çº¢é»‘æ ‘çš„æ ¹èŠ‚ç‚¹ï¼Œè¿™æ˜¯ä»€ä¹ˆæƒ…å†µä¸‹å‘ç”Ÿï¼Ÿ</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>parent <span class="token operator">!=</span> null<span class="token punctuation">)</span>
                root <span class="token operator">=</span> root<span class="token punctuation">.</span><span class="token function">root</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// è¿™ä¸ªæ¡ä»¶æ²¡çœ‹æ‡‚ï¼Œç›´æ¥å°±è¿”å›äº†</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>root <span class="token operator">==</span> null <span class="token operator">||</span> <span class="token punctuation">(</span>movable <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span>root<span class="token punctuation">.</span>right <span class="token operator">==</span> null <span class="token operator">||</span> <span class="token punctuation">(</span>rl <span class="token operator">=</span> root<span class="token punctuation">.</span>left<span class="token punctuation">)</span> <span class="token operator">==</span> null <span class="token operator">||</span> rl<span class="token punctuation">.</span>left <span class="token operator">==</span> null<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                tab<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> first<span class="token punctuation">.</span><span class="token function">untreeify</span><span class="token punctuation">(</span>map<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// too small</span>
                <span class="token keyword">return</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>

            TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> p <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">,</span> pl <span class="token operator">=</span> left<span class="token punctuation">,</span> pr <span class="token operator">=</span> right<span class="token punctuation">,</span> replacement<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// åˆ é™¤çš„èŠ‚ç‚¹æœ‰ä¸¤ä¸ªå­èŠ‚ç‚¹çš„æƒ…å†µ</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>pl <span class="token operator">!=</span> null <span class="token operator">&amp;&amp;</span> pr <span class="token operator">!=</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// ...</span>
            <span class="token punctuation">}</span>
            <span class="token comment" spellcheck="true">// åˆ é™¤çš„èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªå·¦å­©å­çš„æƒ…å†µ</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>pl <span class="token operator">!=</span> null<span class="token punctuation">)</span>
                replacement <span class="token operator">=</span> pl<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// åˆ é™¤çš„èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªå³å­©å­çš„æƒ…å†µ</span>
            <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>pr <span class="token operator">!=</span> null<span class="token punctuation">)</span>
                replacement <span class="token operator">=</span> pr<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// åˆ é™¤çš„èŠ‚ç‚¹ä¸€ä¸ªå­©å­éƒ½æ²¡æœ‰çš„æƒ…å†µ</span>
            <span class="token keyword">else</span>
                replacement <span class="token operator">=</span> p<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// åˆ é™¤çš„èŠ‚ç‚¹åªæœ‰ä¸€ä¸ªå­©å­çš„æƒ…å†µï¼Œä»æ ‘ä¸­åˆ é™¤</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>replacement <span class="token operator">!=</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// ...</span>
            <span class="token punctuation">}</span>
            <span class="token comment" spellcheck="true">// å¹³è¡¡çº¢é»‘æ ‘</span>
            TreeNode<span class="token operator">&lt;</span>K<span class="token punctuation">,</span> V<span class="token operator">></span> r <span class="token operator">=</span> p<span class="token punctuation">.</span>red <span class="token operator">?</span> root <span class="token operator">:</span> <span class="token function">balanceDeletion</span><span class="token punctuation">(</span>root<span class="token punctuation">,</span> replacement<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// åˆ é™¤çš„èŠ‚ç‚¹ä¸€ä¸ªå­©å­éƒ½æ²¡æœ‰çš„æƒ…å†µï¼Œå¹³è¡¡åæ‰åˆ é™¤</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>replacement <span class="token operator">==</span> p<span class="token punctuation">)</span> <span class="token punctuation">{</span>  <span class="token comment" spellcheck="true">// detach</span>
                <span class="token comment" spellcheck="true">// ...</span>
            <span class="token punctuation">}</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>movable<span class="token punctuation">)</span>
                <span class="token function">moveRootToFront</span><span class="token punctuation">(</span>tab<span class="token punctuation">,</span> r<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span></code></pre>
<p>å…·ä½“çš„çº¢é»‘æ ‘åˆ é™¤æ’å…¥å¹³è¡¡ä»£ç è¿™é‡Œä¸è´´äº†ï¼ŒHashMapçš„å¹³è¡¡æˆ‘ä¹Ÿæ²¡çœ‹ï¼ŒçŒœæµ‹å’ŒTreeMapå·®ä¸å¤šï¼Œæœ‰å…´è¶£çš„å¯ä»¥çœ‹çœ‹æˆ‘TreeMapçš„é‚£ç¯‡ç¬”è®°ï¼Œå·²ç»å¾ˆè¯¦ç»†äº†ã€‚</p>
<p>ç›®å‰åœ¨çº¢é»‘æ ‘PTSDä¸­ï¼Œä¸æƒ³å†çœ‹äº†ã€‚</p>

				</div>
				<!-- about -->
				
			</div>
			<!-- pagination -->
			
			<div class="comment-section">
	
	


</div>
		</div>
		
	</div>


        <footer>
             
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

        </footer>
    </div>
    <!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script> -->
    <script>
        var timeEnd = new Date();
        console.log('è€—æ—¶ï¼š' + (timeEnd - timeStart));
        document.addEventListener('DOMContentLoaded', (event) => {
            document.querySelectorAll('pre').forEach((block) => {
                block.classList.add("line-numbers");
            });
        });
    </script>
    <!-- <script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>-->
    <!-- material design -->
    <!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script> -->
    <!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>-->
    <!-- toc -->
    <!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script> -->
    <!-- <script src="/libs/tocify/jquery.tocify.custom.js"></script> -->
    <!-- <script src="/js/main.js"></script> -->
    <script src="/js/prism.js"></script>
</body>
</html>
