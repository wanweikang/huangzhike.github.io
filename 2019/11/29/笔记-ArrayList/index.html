<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <script>
            var timeStart = new Date();
        </script>
        
        <title>[ç¬”è®°]-ArrayList | ğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒ•ğŸŒ–ğŸŒ—ğŸŒ˜</title>
        
        <meta name="author" content="huangzhike">
        
        
        <meta name="description" content="jdk1.8.0_211

ArrayList
/**
 * ç»§æ‰¿äº†AbstractListï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„é˜Ÿåˆ—
 * å®ç°äº†RandomAccessæ ‡è®°æ¥å£ï¼Œè¡¨ç¤ºæä¾›äº†å¿«é€Ÿéšæœºè®¿é—®åŠŸèƒ½
 * å®ç°äº†Cloneableæ ‡è®°æ¥å£ï¼Œè¡¨ç¤ºèƒ½è¢«å…‹éš†
 * å®ç°Serializableæ ‡è®°æ¥å£ï¼Œè¡¨ç¤ºæ”¯æŒåºåˆ—åŒ–
 ">
        
        
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        
        <meta property="og:title" content="[ç¬”è®°]-ArrayList"/>
        
        <meta property="og:site_name" content="ğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒ•ğŸŒ–ğŸŒ—ğŸŒ˜"/>
        
        
        <!-- favicon -->
        <link rel="icon" type="image/ico" href="/ok.ico" sizes="32x32">
        <meta name="msapplication-TileColor" content="#009688">
        <meta name="msapplication-TileImage" content="/mstile-144x144.ico">
        <meta name="theme-color" content="#009688">
        <!-- favicon end -->
        <!-- <link href="//ok.ico" rel="icon"> -->
        
        <!-- toc -->
        <!-- <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css"> -->
        <!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
        <!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">-->
        <!-- material design -->
        <!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
        <!-- <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css"> -->
        <!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
        <!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css"> -->
        <!--<link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">-->
        <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
        <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
        <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
        
        <!-- <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>-->
        <!-- <script>window.jQuery || document.write('<script src="/libs/jquery-3.1.1.slim.min.js" type="text/javascript"><\/script>')</script>-->
    <meta name="generator" content="Hexo 4.2.1"></head>

<body>
    <nav class="navbar navbar-default">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">èœå•</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" title="ä¸‹ä¸€å¥æ˜¯ï¼šå®¢æœ‰å¯äººæœŸä¸æ¥ã€‚å°æ—¶å€™ï¼Œå–œæ¬¢é åœ¨é˜³å°ä¸Šï¼Œä¸€è¾¹å¹é£ï¼Œä¸€è¾¹çœ‹ä¹¦ï¼Œå–œæ¬¢è¯»ä¹¦å—ï¼Œéªšå¹´ï¼Ÿ" href="/">ä¹¦å½“å¿«æ„è¯»æ˜“å°½</a>
           
		</div>
		<div id="navbar" class="collapse navbar-collapse">
			<ul class="nav navbar-nav navbar-right">
				
				<li>
					<a href="https://huangzhike.github.io/archives" title="">
						<i class="fa fa-list"></i>Archives
					</a>
				</li>
				
				<li>
					<a href="https://github.com/huangzhike" target="_blank" rel="noopener" title="">
						<i class="fa fa-github"></i>GitHub
					</a>
				</li>
				
			</ul>
		</div>
	</div>
</nav>

    <div class="container" >
        <div class="row">
	
		<div class="col-md-9 center-content">
			
			<div class="content">
				<!-- index -->
				
				<h2>[ç¬”è®°]-ArrayList</h2>
				
				<div>
					<div class="post-time">2019-11-29</div>
				</div>
				
				<div class="article-content">
				<p>jdk1.8.0_211</p>
<hr>
<p>ArrayList</p>
<pre class=" language-java"><code class="language-java"><span class="token comment" spellcheck="true">/**
 * ç»§æ‰¿äº†AbstractListï¼Œæ˜¯ä¸€ä¸ªæ•°ç»„é˜Ÿåˆ—
 * å®ç°äº†RandomAccessæ ‡è®°æ¥å£ï¼Œè¡¨ç¤ºæä¾›äº†å¿«é€Ÿéšæœºè®¿é—®åŠŸèƒ½
 * å®ç°äº†Cloneableæ ‡è®°æ¥å£ï¼Œè¡¨ç¤ºèƒ½è¢«å…‹éš†
 * å®ç°Serializableæ ‡è®°æ¥å£ï¼Œè¡¨ç¤ºæ”¯æŒåºåˆ—åŒ–
 */</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ArrayList</span><span class="token operator">&lt;</span>E<span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name">AbstractList</span><span class="token operator">&lt;</span>E<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">List</span><span class="token operator">&lt;</span>E<span class="token operator">></span><span class="token punctuation">,</span> RandomAccess<span class="token punctuation">,</span> Cloneable<span class="token punctuation">,</span> java<span class="token punctuation">.</span>io<span class="token punctuation">.</span>Serializable <span class="token punctuation">{</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">long</span> serialVersionUID <span class="token operator">=</span> 8683452581122892189L<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * åˆå§‹å®¹é‡ä¸º10
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> DEFAULT_CAPACITY <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/*
     * è¿™ä¸¤ä¸ªéƒ½æ˜¯ç©ºæ•°ç»„ï¼Œä¸åŒçš„æ„é€ å™¨åˆå§‹åŒ–æ—¶ä½¿ç”¨ä¸åŒçš„å¯¹è±¡ï¼Œç”¨æ¥åŒºåˆ†æ€§åœ°æ‰©å®¹
     */</span>

    <span class="token comment" spellcheck="true">/**
     * å½“åˆå§‹åŒ–æ—¶æŒ‡å®šåˆå§‹å®¹é‡ä¸ºé›¶æ—¶ä½¿ç”¨
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> Object<span class="token punctuation">[</span><span class="token punctuation">]</span> EMPTY_ELEMENTDATA <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * å½“åˆå§‹åŒ–æ—¶ä¸æŒ‡å®šåˆå§‹å®¹é‡æ—¶ä½¿ç”¨
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> Object<span class="token punctuation">[</span><span class="token punctuation">]</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * åº•å±‚ä½¿ç”¨æ•°ç»„ä¿å­˜å…ƒç´ ï¼ŒåŠ äº†transientå…³é”®å­—è¡¨ç¤ºè¯¥å±æ€§ä¸èƒ½åºåˆ—åŒ–
     * elementDataæ˜¯é€šè¿‡åå°„è°ƒç”¨writeObjectæ–¹æ³•åºåˆ—åŒ–çš„ï¼Œä¸€ä¸ªä¸ªéå†å…ƒç´ 
     * ç™¾åº¦åŸå› ï¼šå¯ä»¥æ ¹æ®sizeåºåˆ—åŒ–å…ƒç´ ï¼Œè€Œä¸æ˜¯æ ¹æ®æ•°ç»„çš„é•¿åº¦åºåˆ—åŒ–ï¼ŒèŠ‚çº¦ç©ºé—´ï¼Œå¥½å§
     */</span>
    <span class="token keyword">transient</span> Object<span class="token punctuation">[</span><span class="token punctuation">]</span> elementData<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// non-private to simplify nested class access</span>

    <span class="token comment" spellcheck="true">/**
     * æ•°ç»„å½“å‰çš„å®¹é‡
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">int</span> size<span class="token punctuation">;</span>

    <span class="token comment" spellcheck="true">/**
     * 2^31 - 1 - 8
     * å…³äºå‡8ï¼Œæ ¹æ®JDKçš„åŸæ³¨é‡Šï¼Œå¤§æ¦‚æ˜¯è™šæ‹Ÿæœºçš„æ•°ç»„å®ç°é—®é¢˜
     */</span>
    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token keyword">int</span> MAX_ARRAY_SIZE <span class="token operator">=</span> Integer<span class="token punctuation">.</span>MAX_VALUE <span class="token operator">-</span> <span class="token number">8</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span></code></pre>
<p>AbstractList</p>
<pre class=" language-java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AbstractList</span><span class="token operator">&lt;</span>E<span class="token operator">></span> <span class="token keyword">extends</span> <span class="token class-name">AbstractCollection</span><span class="token operator">&lt;</span>E<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">List</span><span class="token operator">&lt;</span>E<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token comment" spellcheck="true">/**
     * å³ModifyCountï¼Œè¡¨ç¤ºåˆ—è¡¨ç»“æ„ä¿®æ”¹çš„æ¬¡æ•°
     */</span>
    <span class="token keyword">protected</span> <span class="token keyword">transient</span> <span class="token keyword">int</span> modCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span></code></pre>
<p>æ„é€ æ–¹æ³•</p>
<p>ArrayList</p>
<pre class=" language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**
     * æ ¹æ®æŒ‡å®šå®¹é‡æ„é€ ä¸€ä¸ªç©ºåˆ—è¡¨
     */</span>
    <span class="token keyword">public</span> <span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token keyword">int</span> initialCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// æŒ‡å®šäº†ä¸€ä¸ªéç©ºçš„å®¹é‡</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Object</span><span class="token punctuation">[</span>initialCapacity<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">// æŒ‡å®šä¸€ä¸ªä¸ºé›¶çš„å®¹é‡</span>
        <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>initialCapacity <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> EMPTY_ELEMENTDATA<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Illegal Capacity: "</span> <span class="token operator">+</span> initialCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * æ ¹æ®é»˜è®¤å®¹é‡æ„é€ ä¸€ä¸ªç©ºåˆ—è¡¨
     */</span>
    <span class="token keyword">public</span> <span class="token function">ArrayList</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment" spellcheck="true">/**
     * ä»æŒ‡å®šé›†åˆæ„é€ 
     */</span>
    <span class="token keyword">public</span> <span class="token function">ArrayList</span><span class="token punctuation">(</span>Collection<span class="token operator">&lt;</span><span class="token operator">?</span> <span class="token keyword">extends</span> <span class="token class-name">E</span><span class="token operator">></span> c<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// ç›´æ¥è°ƒç”¨é›†åˆçš„Collection#toArrayæ›´æ–°èµ‹å€¼</span>
        elementData <span class="token operator">=</span> c<span class="token punctuation">.</span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// æ›´æ–°åˆ—è¡¨å…ƒç´ çš„æ•°é‡ï¼Œå¦‚æœä¸ä¸ºç©º</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span>size <span class="token operator">=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// Collection#toArrayçš„è¿”å›ç±»å‹å¯èƒ½ä¸æ˜¯Object[]ï¼Œå¤„ç†è¿™ä¸ªBug</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData<span class="token punctuation">.</span><span class="token function">getClass</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">!=</span> Object<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span>
                elementData <span class="token operator">=</span> Arrays<span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> size<span class="token punctuation">,</span> Object<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment" spellcheck="true">// ç©ºçš„å°±ç”¨ç©ºæ•°ç»„æ›¿ä»£</span>
        <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>elementData <span class="token operator">=</span> EMPTY_ELEMENTDATA<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre>
<hr>
<p>æ·»åŠ å…ƒç´ æ—¶å¦‚æœä¸æ·»åŠ åˆ°æœ«å°¾ï¼Œé‚£ä¹ˆåé¢çš„å…ƒç´ å…¨éƒ¨è¦åç§»ä¸€ä½ã€‚</p>
<p>ArrayList#add</p>
<pre class=" language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**
     * æ·»åŠ å…ƒç´ åˆ°æŒ‡å®šä½ç½®
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">add</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> E element<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// å…ˆæ£€æŸ¥ç´¢å¼•æ˜¯å¦åœ¨æ•°ç»„çš„èŒƒå›´å†…ï¼Œå¦åˆ™æŠ›å‡ºIndexOutOfBoundsException</span>
        <span class="token function">rangeCheckForAdd</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å…ˆç¡®ä¿å®¹é‡å¤Ÿï¼Œä¸å¤Ÿå°±è¦æ‰©å®¹ï¼ŒåŒæ—¶ä¼šå¢åŠ ModCount</span>
        <span class="token comment" spellcheck="true">// ä¼ å…¥æ·»åŠ è¯¥å…ƒç´ æ‰€éœ€çš„æœ€å°å®¹é‡</span>
        <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span>size <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment" spellcheck="true">// Increments modCount!!</span>
        <span class="token comment" spellcheck="true">// åé¢çš„å…¨éƒ¨åç§»ä¸€ä½</span>
        System<span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> index<span class="token punctuation">,</span> elementData<span class="token punctuation">,</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> size <span class="token operator">-</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å°†å…ƒç´ åŠ å…¥æ•°ç»„</span>
        elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">=</span> element<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å¢åŠ åˆ—è¡¨å…ƒç´ çš„æ•°é‡</span>
        size<span class="token operator">++</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>ArrayList#ensureCapacityInternal</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ensureCapacityInternal</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// è®¡ç®—éœ€è¦çš„å®¹é‡ï¼Œå¹¶è‡ªåŠ¨æ‰©å®¹ï¼Œå¦‚æœéœ€è¦çš„è¯</span>
        <span class="token function">ensureExplicitCapacity</span><span class="token punctuation">(</span><span class="token function">calculateCapacity</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> minCapacity<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>ArrayList#calculateCapacity</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">int</span> <span class="token function">calculateCapacity</span><span class="token punctuation">(</span>Object<span class="token punctuation">[</span><span class="token punctuation">]</span> elementData<span class="token punctuation">,</span> <span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// é»˜è®¤çš„æ— å‚æ„é€ åˆå§‹åŒ–çš„ç©ºåˆ—è¡¨ï¼Œæ­¤æ—¶è¿˜æ²¡æœ‰æ·»åŠ å…ƒç´ </span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData <span class="token operator">==</span> DEFAULTCAPACITY_EMPTY_ELEMENTDATA<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// è¿”å›ä¸¤è€…çš„æœ€å¤§å€¼ï¼Œæ–°çš„åˆ—è¡¨ç¬¬ä¸€æ¬¡æ·»åŠ æ•°æ®ä¼šè¿›æ¥ï¼Œé»˜è®¤å®¹é‡10</span>
            <span class="token comment" spellcheck="true">// åé¢ä¼šè‡ªåŠ¨æ‰©å®¹ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œæ–°çš„åˆ—è¡¨æ˜¯ç©ºæ•°ç»„ï¼Œç¬¬ä¸€æ¬¡æ·»åŠ æ•°æ®æ—¶æ‰è‡ªåŠ¨æ‰©å®¹</span>
            <span class="token keyword">return</span> Math<span class="token punctuation">.</span><span class="token function">max</span><span class="token punctuation">(</span>DEFAULT_CAPACITY<span class="token punctuation">,</span> minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> minCapacity<span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>ArrayList#ensureExplicitCapacity</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">ensureExplicitCapacity</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// ä¿®æ”¹æ¬¡æ•°å¢åŠ </span>
        modCount<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// éœ€è¦æ‰©å®¹</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>minCapacity <span class="token operator">-</span> elementData<span class="token punctuation">.</span>length <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token function">grow</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>ArrayList#grow</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">private</span> <span class="token keyword">void</span> <span class="token function">grow</span><span class="token punctuation">(</span><span class="token keyword">int</span> minCapacity<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// åŸæœ¬æ•°ç»„çš„å®¹é‡</span>
        <span class="token keyword">int</span> oldCapacity <span class="token operator">=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// æ‰©å®¹åçš„æ–°å®¹é‡ = åŸæœ¬å®¹é‡ + åŸæœ¬å®¹é‡ / 2</span>
        <span class="token comment" spellcheck="true">// å°±æ˜¯ä¹˜1.5</span>
        <span class="token keyword">int</span> newCapacity <span class="token operator">=</span> oldCapacity <span class="token operator">+</span> <span class="token punctuation">(</span>oldCapacity <span class="token operator">>></span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å¦‚æœå°äºéœ€è¦çš„æœ€å°å®¹é‡</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> minCapacity <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true">// æ›´æ–°</span>
            newCapacity <span class="token operator">=</span> minCapacity<span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// å¤„ç†æå¤§å€¼çš„é—®é¢˜ï¼Œè¿™æ“ä½œæ²¡çœ‹æ‡‚</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>newCapacity <span class="token operator">-</span> MAX_ARRAY_SIZE <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
            newCapacity <span class="token operator">=</span> <span class="token function">hugeCapacity</span><span class="token punctuation">(</span>minCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// åˆ›å»ºæ–°çš„æ•°ç»„å¹¶æ‹·è´å…ƒç´ ï¼Œä¹Ÿå°±æ˜¯è¯´æ¯æ¬¡æ‰©å®¹éƒ½ä¼šåˆ›å»ºæ–°çš„æ•°ç»„å¯¹è±¡ï¼Œå†å¤åˆ¶è¿‡å»</span>
        elementData <span class="token operator">=</span> Arrays<span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> newCapacity<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<hr>
<p>ArrayList#get</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">public</span> E <span class="token function">get</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// è¶Šç•Œæ£€æŸ¥ï¼Œä¸èƒ½è¶…è¿‡åˆ—è¡¨å·²æœ‰å…ƒç´ æ•°é‡çš„å¤§å°ï¼Œå¦åˆ™æŠ›IndexOutOfBoundsException</span>
        <span class="token function">rangeCheck</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// ç›´æ¥æ ¹æ®ç´¢å¼•ä»æ•°ç»„æ‹¿</span>
        <span class="token keyword">return</span> <span class="token function">elementData</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>ArrayList#elementData</p>
<pre class=" language-java"><code class="language-java">    <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"unchecked"</span><span class="token punctuation">)</span>
    E <span class="token function">elementData</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>E<span class="token punctuation">)</span> elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<hr>
<p>ArrayList#remove</p>
<pre class=" language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**
     * åˆ é™¤æŒ‡å®šç´¢å¼•çš„å…ƒç´ 
     */</span>
    <span class="token keyword">public</span> E <span class="token function">remove</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// è¶Šç•Œæ£€æŸ¥ï¼Œä¸èƒ½è¶…è¿‡åˆ—è¡¨å·²æœ‰å…ƒç´ æ•°é‡çš„å¤§å°ï¼Œå¦åˆ™æŠ›IndexOutOfBoundsException</span>
        <span class="token function">rangeCheck</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// ä¿®æ”¹æ¬¡æ•°å¢åŠ ï¼Œå› ä¸ºç§»é™¤äº†å…ƒç´ </span>
        modCount<span class="token operator">++</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è¿”å›è¦åˆ é™¤ä½ç½®çš„å…ƒç´ </span>
        E oldValue <span class="token operator">=</span> <span class="token function">elementData</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">int</span> numMoved <span class="token operator">=</span> size <span class="token operator">-</span> index <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>numMoved <span class="token operator">></span> <span class="token number">0</span><span class="token punctuation">)</span>
            <span class="token comment" spellcheck="true">// åé¢çš„å…ƒç´ éƒ½éœ€è¦å‰ç§»ä¸€ä¸ªä½ç½®</span>
            System<span class="token punctuation">.</span><span class="token function">arraycopy</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> index <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">,</span> elementData<span class="token punctuation">,</span> index<span class="token punctuation">,</span> numMoved<span class="token punctuation">)</span><span class="token punctuation">;</span>
        elementData<span class="token punctuation">[</span><span class="token operator">--</span>size<span class="token punctuation">]</span> <span class="token operator">=</span> null<span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// clear to let GC do its work</span>
        <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>ArrayList#remove</p>
<pre class=" language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**
     * åˆ é™¤æŒ‡å®šå…ƒç´ 
     */</span>
    <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">remove</span><span class="token punctuation">(</span>Object o<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>o <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span> <span class="token operator">==</span> null<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token comment" spellcheck="true">// å¿«é€Ÿåˆ é™¤ï¼Œå¤§æ¦‚æŒ‡çš„æ˜¯çœç•¥äº†è¶Šç•Œæ£€æŸ¥å’Œè¿”å›å€¼ï¼Œå…¶å®ä¹Ÿæ²¡å¿«å¤šå°‘</span>
                    <span class="token function">fastRemove</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
            <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> size<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>o<span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>elementData<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                    <span class="token function">fastRemove</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
                    <span class="token keyword">return</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
                <span class="token punctuation">}</span>
        <span class="token punctuation">}</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<hr>
<p>ArrayList#size</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// ç›´æ¥è¿”å›æ•°é‡ï¼Œä¸ç”¨éå†è®¡ç®—</span>
        <span class="token keyword">return</span> size<span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<hr>
<p>ArrayList#clone</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">public</span> Object <span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            ArrayList<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span> v <span class="token operator">=</span> <span class="token punctuation">(</span>ArrayList<span class="token operator">&lt;</span><span class="token operator">?</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">clone</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// æ–°çš„æ•°ç»„ï¼Œä½†æ˜¯å…ƒç´ è¿˜æ˜¯åŸæœ¬çš„å…ƒç´ å“¦</span>
            v<span class="token punctuation">.</span>elementData <span class="token operator">=</span> Arrays<span class="token punctuation">.</span><span class="token function">copyOf</span><span class="token punctuation">(</span>elementData<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
            v<span class="token punctuation">.</span>modCount <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> v<span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">CloneNotSupportedException</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// this shouldn't happen, since we are Cloneable</span>
            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">InternalError</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre>
<hr>
<p>ArrayList#subList</p>
<pre class=" language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**
     * è¿”å›ä¸€ä¸ªå­åˆ—è¡¨
     */</span>
    <span class="token keyword">public</span> List<span class="token operator">&lt;</span>E<span class="token operator">></span> <span class="token function">subList</span><span class="token punctuation">(</span><span class="token keyword">int</span> fromIndex<span class="token punctuation">,</span> <span class="token keyword">int</span> toIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">// å…ˆæ£€æŸ¥èŒƒå›´æ˜¯å¦åˆæ³•ï¼Œå¦åˆ™æŠ›IndexOutOfBoundsException</span>
        <span class="token function">subListRangeCheck</span><span class="token punctuation">(</span>fromIndex<span class="token punctuation">,</span> toIndex<span class="token punctuation">,</span> size<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token comment" spellcheck="true">// è¿”å›å­åˆ—è¡¨</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">SubList</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> fromIndex<span class="token punctuation">,</span> toIndex<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>ArrayList$SubList</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">SubList</span> <span class="token keyword">extends</span> <span class="token class-name">AbstractList</span><span class="token operator">&lt;</span>E<span class="token operator">></span> <span class="token keyword">implements</span> <span class="token class-name">RandomAccess</span> <span class="token punctuation">{</span>
        <span class="token function">SubList</span><span class="token punctuation">(</span>AbstractList<span class="token operator">&lt;</span>E<span class="token operator">></span> parent<span class="token punctuation">,</span> <span class="token keyword">int</span> offset<span class="token punctuation">,</span> <span class="token keyword">int</span> fromIndex<span class="token punctuation">,</span> <span class="token keyword">int</span> toIndex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// çˆ¶åˆ—è¡¨</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>parent <span class="token operator">=</span> parent<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>parentOffset <span class="token operator">=</span> fromIndex<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>offset <span class="token operator">=</span> offset <span class="token operator">+</span> fromIndex<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>size <span class="token operator">=</span> toIndex <span class="token operator">-</span> fromIndex<span class="token punctuation">;</span>
            <span class="token keyword">this</span><span class="token punctuation">.</span>modCount <span class="token operator">=</span> ArrayList<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span>modCount<span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span></code></pre>
<p>è¿™ä¸ªå­åˆ—è¡¨åªæ˜¯ç»´æŠ¤äº†è‡ªèº«çš„ç´¢å¼•åç§»ï¼Œå®é™…ä¸Šæ“ä½œçš„è¿˜æ˜¯çˆ¶åˆ—è¡¨çš„å…ƒç´ ã€‚</p>
<p>ArrayList$SubList#set</p>
<pre class=" language-java"><code class="language-java">        <span class="token keyword">public</span> E <span class="token function">set</span><span class="token punctuation">(</span><span class="token keyword">int</span> index<span class="token punctuation">,</span> E e<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">rangeCheck</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token function">checkForComodification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            E oldValue <span class="token operator">=</span> ArrayList<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">elementData</span><span class="token punctuation">(</span>offset <span class="token operator">+</span> index<span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// å®é™…ä¸Šæ“ä½œçš„æ˜¯çˆ¶åˆ—è¡¨çš„æ•°ç»„</span>
            ArrayList<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span>elementData<span class="token punctuation">[</span>offset <span class="token operator">+</span> index<span class="token punctuation">]</span> <span class="token operator">=</span> e<span class="token punctuation">;</span>
            <span class="token keyword">return</span> oldValue<span class="token punctuation">;</span>
        <span class="token punctuation">}</span></code></pre>
<hr>
<p>ä¸‰ç§è¿­ä»£å™¨</p>
<ul>
<li><p>ArrayList#iterator</p>
</li>
<li><p>ArrayList#listIterator</p>
</li>
<li><p>ArrayList#spliterator</p>
</li>
</ul>
<p>å…³äºSpliteratorï¼Œè¿™æ˜¯JDK8åŠ çš„ï¼Œå°±æ˜¯å°†å…ƒç´ åˆ†å‰²ä¸ºå¤šä»½ï¼Œå¤šçº¿ç¨‹å¹¶è¡Œå¤„ç†ï¼Œå¯¹äºArrayListè¿™ç§éšæœºå­˜å–çš„è¿˜å¥½ï¼ŒLinkedListè¿™ç§çš„è¯ï¼Œåˆ†å‰²æ“ä½œæœ¬èº«çš„æ€§èƒ½åº”è¯¥å°±ä¸å¤ªå¥½å§ã€‚</p>
<p>ArrayList#iterator</p>
<pre class=" language-java"><code class="language-java">    <span class="token comment" spellcheck="true">/**
     * è¿™é‡Œé‡å†™äº†çˆ¶ç±»AbstractListçš„æ–¹æ³•ï¼Œä½†æ˜¯æ²¡åŠ @Override
     */</span>
    <span class="token keyword">public</span> Iterator<span class="token operator">&lt;</span>E<span class="token operator">></span> <span class="token function">iterator</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Itr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>ArrayList$Itr</p>
<pre class=" language-java"><code class="language-java">    <span class="token keyword">private</span> <span class="token keyword">class</span> <span class="token class-name">Itr</span> <span class="token keyword">implements</span> <span class="token class-name">Iterator</span><span class="token operator">&lt;</span>E<span class="token operator">></span> <span class="token punctuation">{</span>
        <span class="token comment" spellcheck="true">/**
         * è¿­ä»£å™¨æœ‰ä¸ªæ¸¸æ ‡ï¼Œåˆå§‹ä¸º0ï¼Œè™½ç„¶æ²¡æœ‰æ˜¾å¼åˆå§‹åŒ–ï¼Œä½†æ˜¯å®ƒæ˜¯ä¸ªåŸå§‹ç±»å‹ï¼Œä½ æ‡‚çš„
         * ä¹‹æ‰€ä»¥å«æ¸¸æ ‡è€Œä¸å«ç´¢å¼•æ˜¯å› ä¸ºå®ƒä¸æŒ‡å‘å…ƒç´ ï¼Œè€Œæ˜¯æŒ‡å‘å…ƒç´ ä¹‹é—´ï¼Œè¡¨ç¤ºä¸‹ä¸€ä¸ªè¿­ä»£çš„å…ƒç´ ä½ç½®ï¼Œå½“è°ƒç”¨Iterator#nextæ—¶åç§»
         * æ‰€ä»¥åˆå§‹æ—¶åœ¨ç¬¬ä¸€ä¸ªå…ƒç´ å‰é¢ï¼Œè¿­ä»£å®Œååœ¨æœ€åä¸€ä¸ªå…ƒç´ åé¢ï¼Œå³é•¿åº¦ä¸ºNçš„é›†åˆæœ‰N+1ä¸ªæ¸¸æ ‡çš„ä½ç½®
         */</span>
        <span class="token keyword">int</span> cursor<span class="token punctuation">;</span>       <span class="token comment" spellcheck="true">// index of next element to return</span>

        <span class="token comment" spellcheck="true">/**
         * ä¸Šæ¬¡è¿­ä»£è¿”å›å…ƒç´ çš„ç´¢å¼•
         */</span>
        <span class="token keyword">int</span> lastRet <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment" spellcheck="true">// index of last element returned; -1 if no such</span>

        <span class="token keyword">int</span> expectedModCount <span class="token operator">=</span> modCount<span class="token punctuation">;</span>
    <span class="token punctuation">}</span></code></pre>
<p>ArrayList$Itr#hasNext</p>
<pre class=" language-java"><code class="language-java">        <span class="token comment" spellcheck="true">/**
         * æ¸¸æ ‡åæ˜¯å¦è¿˜æœ‰å…ƒç´ 
         */</span>
        <span class="token keyword">public</span> <span class="token keyword">boolean</span> <span class="token function">hasNext</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token keyword">return</span> cursor <span class="token operator">!=</span> size<span class="token punctuation">;</span>
        <span class="token punctuation">}</span></code></pre>
<p>ArrayList$Itr#next</p>
<pre class=" language-java"><code class="language-java">        <span class="token annotation punctuation">@SuppressWarnings</span><span class="token punctuation">(</span><span class="token string">"unchecked"</span><span class="token punctuation">)</span>
        <span class="token keyword">public</span> E <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// è¿”å›ä¸‹ä¸€ä¸ªå…ƒç´ ä¹‹å‰å…ˆæ£€æŸ¥ModCountå’ŒæœŸå¾…çš„ExpectedModCountæ˜¯å¦ä¸€æ ·</span>
            <span class="token comment" spellcheck="true">// ä¸ä¸€æ ·è¯´æ˜è¿­ä»£è¿‡ç¨‹ä¸­åˆ—è¡¨ç»“æ„å‘ç”Ÿäº†ä¿®æ”¹ï¼ŒæŠ›å‡ºConcurrentModificationExceptionï¼Œç§°ä¸ºFail-Fast</span>
            <span class="token function">checkForComodification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// è¦è¿­ä»£çš„ä¸‹ä¸€ä¸ªå…ƒç´ ä½ç½®</span>
            <span class="token keyword">int</span> i <span class="token operator">=</span> cursor<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// è¶Šç•Œæ£€æŸ¥ï¼Œä¸€èˆ¬ä¸ä¼šå‘ç”Ÿ</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> size<span class="token punctuation">)</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">NoSuchElementException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            Object<span class="token punctuation">[</span><span class="token punctuation">]</span> elementData <span class="token operator">=</span> ArrayList<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span>elementData<span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// æ­£å¸¸è°ƒç”¨Iterator#hasNextåå†Iterator#nextï¼Œæ¸¸æ ‡æ˜¯å°äºæ•°ç»„çš„å¤§å°çš„</span>
            <span class="token comment" spellcheck="true">// è¿™é‡Œå¯èƒ½æ˜¯å¤šçº¿ç¨‹æ“ä½œåŒä¸€ä¸ªè¿­ä»£å™¨Iteratorï¼ŒæŠ›ConcurrentModificationException</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">>=</span> elementData<span class="token punctuation">.</span>length<span class="token punctuation">)</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentModificationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// æ¸¸æ ‡åç§»</span>
            cursor <span class="token operator">=</span> i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// æ›´æ–°ä¸Šæ¬¡è¿”å›ä½ç½®LastRetï¼ŒåŒæ—¶ä¹Ÿæ˜¯å½“å‰è¿­ä»£å…ƒç´ çš„ç´¢å¼•ï¼Œè¿”å›å¯¹åº”çš„æ•°ç»„å…ƒç´ </span>
            <span class="token keyword">return</span> <span class="token punctuation">(</span>E<span class="token punctuation">)</span> elementData<span class="token punctuation">[</span>lastRet <span class="token operator">=</span> i<span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span></code></pre>
<p>ArrayList$Itr#remove</p>
<pre class=" language-java"><code class="language-java">        <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token comment" spellcheck="true">// è¯´æ˜è¿˜æ²¡æœ‰è°ƒç”¨Iterator#nextï¼Œå½“ç„¶ä¸èƒ½ç§»é™¤å½“å‰å…ƒç´ </span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>lastRet <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalStateException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token comment" spellcheck="true">// æ£€æŸ¥ModCountï¼Œå¦‚æœè¿­ä»£è¿‡ç¨‹ä¸­å‘ç”Ÿäº†ä¿®æ”¹ï¼ŒæŠ›ConcurrentModificationException</span>
            <span class="token function">checkForComodification</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">try</span> <span class="token punctuation">{</span>
                <span class="token comment" spellcheck="true">// è°ƒç”¨åˆ—è¡¨çš„åˆ é™¤æ–¹æ³•åˆ é™¤å½“å‰è¿­ä»£çš„å…ƒç´ </span>
                ArrayList<span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>lastRet<span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// æ›´æ–°æ¸¸æ ‡ä½ç½®ï¼Œå› ä¸ºåˆ é™¤äº†ä¸€ä¸ªå…ƒç´ ï¼Œæ‰€ä»¥å…¶å®æ˜¯å›é€€äº†ä¸€æ­¥</span>
                cursor <span class="token operator">=</span> lastRet<span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// åˆ é™¤å®Œæ¢å¤åˆå§‹å€¼</span>
                lastRet <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span>
                <span class="token comment" spellcheck="true">// æ›´æ–°ä¿®æ”¹åçš„æœŸå¾…å€¼</span>
                expectedModCount <span class="token operator">=</span> modCount<span class="token punctuation">;</span>
            <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">IndexOutOfBoundsException</span> ex<span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">ConcurrentModificationException</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span></code></pre>
<p>æ‰€ä»¥éå†æ—¶å¦‚æœè¦ç§»é™¤Listçš„å…ƒç´ ï¼Œä¸èƒ½ç›´æ¥è°ƒç”¨List#removeæ–¹æ³•ï¼Œè€Œæ˜¯è¦é€šè¿‡Iteratorç§»é™¤ï¼Œå¦åˆ™ä¼šæŠ›å¼‚å¸¸ã€‚</p>
<p>ç±»ä¼¼<code>for...each</code>è¿™ç§æ–¹å¼éå†å…¶å®æ˜¯ä¸ªè¯­æ³•ç³–ï¼Œåç¼–è¯‘ç±»æ–‡ä»¶åå°±ä¼šå‘ç°å…¶å®è¿˜æ˜¯è°ƒç”¨äº†è¿­ä»£å™¨ã€‚</p>
<p>ä¸è¿‡æˆ‘è¿˜æ˜¯ä¸å–œæ¬¢ç”¨è¿­ä»£å™¨å“ˆï¼Œéº»çƒ¦ã€‚</p>
<p>å¯ä»¥çœ‹å‡ºè¿­ä»£å™¨è¿˜æ˜¯å¤šäº†æŒºå¤šæ­¥éª¤çš„ï¼Œæ‰€ä»¥åªæ˜¯ç®€å•çš„è¿­ä»£çš„è¯ï¼Œç”¨æ™®é€šçš„<code>for (; ; ) { }</code>ä¼šæ›´åŠ å¿«äº›ã€‚</p>
<p>ListIteratorå…¶å®åŠ äº†ä¸ª<code>ListIterator#hasPrevious</code>å’Œ<code>ListIterator#previous</code>ï¼Œå³å‘å‰è¿­ä»£çš„åŠŸèƒ½ï¼Œè¿™é‡Œä¸è´´ä»£ç äº†ã€‚</p>

				</div>
				<!-- about -->
				
			</div>
			<!-- pagination -->
			
			<div class="comment-section">
	
	


</div>
		</div>
		
	</div>


        <footer>
             
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

        </footer>
    </div>
    <!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script> -->
    <script>
        var timeEnd = new Date();
        console.log('è€—æ—¶ï¼š' + (timeEnd - timeStart));
        document.addEventListener('DOMContentLoaded', (event) => {
            document.querySelectorAll('pre').forEach((block) => {
                block.classList.add("line-numbers");
            });
        });
    </script>
    <!-- <script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>-->
    <!-- material design -->
    <!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script> -->
    <!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>-->
    <!-- toc -->
    <!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script> -->
    <!-- <script src="/libs/tocify/jquery.tocify.custom.js"></script> -->
    <!-- <script src="/js/main.js"></script> -->
    <script src="/js/prism.js"></script>
</body>
</html>
