<!DOCTYPE HTML>
<html>
	<head>
		<meta charset="utf-8">
				<script>var timeStart = new Date();</script>
		
		<title>[笔记]-RequireJS | 一个放笔记的地方而已</title>
		
		<meta name="author" content="Huangzhike">
		
		
		<meta name="description" content="没有鸡汤，只有笔记">
		
		
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		
		<meta property="og:title" content="[笔记]-RequireJS"/>
		
		<meta property="og:site_name" content="一个放笔记的地方而已"/>
		
		
		<!-- favicon -->
		<link rel="icon" type="image/ico" href="/ok.ico" sizes="32x32">
 


		<meta name="msapplication-TileColor" content="#009688">
		<meta name="msapplication-TileImage" content="/mstile-144x144.ico">
		<meta name="theme-color" content="#009688">

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Didact+Gothic"> 

		<!-- favicon end -->
		<!-- <link href="//ok.ico" rel="icon"> -->
		
		<!-- toc -->
		<!-- <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">-->
		<!-- material design -->
		<!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css"> -->
		<!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css"> -->
		<!--<link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">-->
		<link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
		 
		 
		<!-- <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>-->
		<!-- <script>window.jQuery || document.write('<script src="/libs/jquery-3.1.1.slim.min.js" type="text/javascript"><\/script>')</script>-->
	</head>

<body>
	<nav class="navbar navbar-default">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">菜单</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" href="/">一个放笔记的地方而已</a>
           
		</div>
		<div id="navbar" class="collapse navbar-collapse">
			<ul class="nav navbar-nav navbar-right">
				
				<li>
					<a href="https://huangzhike.github.io/" title="">
						<i class="fa fa-home"></i>Index
					</a>
				</li>
				
				<li>
					<a href="https://huangzhike.github.io/archives" title="">
						<i class="fa fa-list"></i>Archives
					</a>
				</li>
				
				<li>
					<a href="https://github.com/huangzhike" title="">
						<i class="fa fa-github"></i>GitHub
					</a>
				</li>
				
			</ul>
		</div>
	</div>
</nav>

	<div class="container" >
		<div class="row">
	
		<div class="col-md-9 center-content">
			
			<div class="content">
				<!-- index -->
				
				<h2>[笔记]-RequireJS</h2>
				
				<div>
					<span class="post-time">2016-11-23 12:31:17</span>
				</div>	
				
				<div class="article-content">
				<p><strong>参考</strong>：<br><a href="http://www.requirejs.cn/" target="_blank" rel="external">http://www.requirejs.cn/</a><br><a href="http://www.runoob.com/w3cnote" target="_blank" rel="external">http://www.runoob.com/w3cnote</a><br><a href="http://www.cnblogs.com/zhongxia/p/5100477.html" target="_blank" rel="external">http://www.cnblogs.com/zhongxia/p/5100477.html</a><br><a href="http://www.tuicool.com/articles/jam2Anv" target="_blank" rel="external">http://www.tuicool.com/articles/jam2Anv</a><br><a href="https://www.zhihu.com/question/20342350" target="_blank" rel="external">https://www.zhihu.com/question/20342350</a></p>
<ul>
<li><p><code>&lt;script data-main=&quot;path/to/module_config.js&quot; src=&quot;path/to/require.js&quot;&gt;&lt;/script&gt;</code>，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// data-main属性指定主模块，第一个被require.js加载</span></div><div class="line"><span class="comment">// 使每个页面都用这个config，直接用require加载短模块名</span></div><div class="line"><span class="comment">// require.js默认后缀名是js，可不写</span></div><div class="line">&lt;script data-main=<span class="string">"js/main"</span> src=<span class="string">"path/to/require.js"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span></div><div class="line"><span class="comment">// require默认将data-main指定的js为根路径：</span></div><div class="line"><span class="built_in">require</span>([<span class="string">'jquery'</span>], <span class="function"><span class="keyword">function</span> (<span class="params"></span>)</span>&#123;</div><div class="line"></div><div class="line">&#125;);</div><div class="line"><span class="comment">// 不配置jquery的paths，require加载js/jquery.js，而不是jquery.js，相当于配置了：</span></div><div class="line"><span class="built_in">require</span>.config(&#123;</div><div class="line">	<span class="attr">baseUrl</span> : <span class="string">"js"</span></div><div class="line">&#125;)</div></pre></td></tr></table></figure>
</li>
<li><p>require.config()：配置requirejs，写在主模块（main.js）头部。</p>
<ul>
<li>参数是对象，对象的paths属性指定模块的加载路径。</li>
</ul>
</li>
<li><p>require()：加载依赖模块，执行加载完后的回调。两个参数：</p>
<ul>
<li>数组，表示主模块依赖的模块；</li>
<li>回调函数，前面指定的模块都加载成功后被调用。加载的模块以参数传入该函数，在回调内使用。</li>
</ul>
</li>
<li><p>require.js要求每个模块是单独的js文件。如果加载多个模块，就会发出多次HTTP请求。require.js提供工具，当模块部署完后，将多个模块合并一个文件。</p>
</li>
<li><p>main.js</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line">require.config(&#123;</div><div class="line">	<span class="regexp">//</span> JS模块文件，都在指定路径下，直接改变基目录（baseUrl）</div><div class="line">	baseUrl: <span class="string">"/lib/js"</span>,</div><div class="line">	paths: &#123;</div><div class="line">		<span class="regexp">//</span> 给模块命名jquery，require时[<span class="string">"jquery"</span>]加载</div><div class="line">		<span class="regexp">//</span> 如果远程cdn库没有加载成功，加载本地库</div><div class="line">		<span class="string">"jquery"</span>: [<span class="string">"http://libs.baidu.com/jquery/2.0.3/jquery"</span>, <span class="string">"jquery.min"</span>],</div><div class="line">		...</div><div class="line">	&#125;</div><div class="line">	<span class="regexp">//</span> 避开<span class="string">"baseUrl + paths"</span>的解析过程，直接加载为相对于当前HTML文档的脚本：</div><div class="line">	<span class="regexp">//</span> 以 <span class="string">".js"</span> 结束</div><div class="line">	<span class="regexp">//</span> 以 <span class="string">"/"</span> 开始</div><div class="line">	<span class="regexp">//</span> 包含 URL 协议, 如 <span class="string">"http:"</span> or <span class="string">"https:"</span></div><div class="line">	<span class="regexp">//</span> paths: &#123;</div><div class="line">	<span class="regexp">//</span> 	<span class="string">"jquery"</span>: <span class="string">"https://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min"</span>, <span class="regexp">//</span> 在另一台主机上</div><div class="line">	<span class="regexp">//</span> 	<span class="string">"underscore"</span>: <span class="string">"lib/js/underscore.min"</span>, <span class="regexp">//</span> 在其他目录</div><div class="line">	<span class="regexp">//</span> 	<span class="string">"backbone"</span>: <span class="string">"backbone.min"</span> <span class="regexp">//</span> 默认与main.js同一目录</div><div class="line">	<span class="regexp">//</span> &#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="regexp">//</span> 假定主模块依赖jquery、underscore和backbone三个模块</div><div class="line">require([<span class="string">'jquery'</span>, <span class="string">'underscore'</span>, <span class="string">'backbone'</span>], <span class="keyword">function</span> ($, _, Backbone) &#123;</div><div class="line">	<span class="regexp">//</span> 主模块的代码写在回调中</div><div class="line">&#125;);</div><div class="line"><span class="regexp">//</span> 异步加载模块，浏览器不会失去响应</div><div class="line"><span class="regexp">//</span> 指定的回调在模块都加载成功后才运行，解决了依赖</div></pre></td></tr></table></figure>
</li>
<li><h4 id="require函数检查依赖的模块，根据配置文件，获取js文件的实际路径"><a href="#require函数检查依赖的模块，根据配置文件，获取js文件的实际路径" class="headerlink" title="require函数检查依赖的模块，根据配置文件，获取js文件的实际路径"></a>require函数检查依赖的模块，根据配置文件，获取js文件的实际路径</h4></li>
<li><h4 id="根据js文件实际路径，在dom中插入script节点，并绑定onload事件来获取该模块加载完成的通知"><a href="#根据js文件实际路径，在dom中插入script节点，并绑定onload事件来获取该模块加载完成的通知" class="headerlink" title="根据js文件实际路径，在dom中插入script节点，并绑定onload事件来获取该模块加载完成的通知"></a>根据js文件实际路径，在dom中插入script节点，并绑定onload事件来获取该模块加载完成的通知</h4></li>
<li><h4 id="依赖script全部加载完成后，调用回调函数"><a href="#依赖script全部加载完成后，调用回调函数" class="headerlink" title="依赖script全部加载完成后，调用回调函数"></a>依赖script全部加载完成后，调用回调函数</h4></li>
<li><p>requirejs提供两个全局变量：</p>
</li>
<li>requirejs/require：配置requirejs及载入入口模块。如果其中一个命名被其它库使用了，用另一个。</li>
<li><p>define：定义模块</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 把require当作依赖的模块，调用它的方法：</span></div><div class="line">define([<span class="string">"require"</span>], <span class="function"><span class="keyword">function</span>(<span class="params">require</span>) </span>&#123;</div><div class="line">		<span class="keyword">var</span> cssUrl = <span class="built_in">require</span>.toUrl(<span class="string">"./style.css"</span>);</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>require.js加载的模块必须AMD规定写，采用特定的define()函数定义。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 如果模块不依赖其他模块，直接在define()函数中定义</span></div><div class="line"><span class="comment">// math.js</span></div><div class="line">define(<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	<span class="keyword">var</span> add = <span class="function"><span class="keyword">function</span> (<span class="params">x, y</span>) </span>&#123;</div><div class="line">	　　<span class="keyword">return</span> x + y;</div><div class="line">	&#125;;</div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">	　　<span class="attr">add</span>: add</div><div class="line">	&#125;;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// main.js</span></div><div class="line"><span class="built_in">require</span>([<span class="string">'math'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">math</span>) </span>&#123;</div><div class="line">	alert(math.add(<span class="number">1</span>, <span class="number">1</span>));</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// 如果模块依赖其他模块，define()函数的第一个参数是一个数组，指明模块依赖</span></div><div class="line">define([<span class="string">'myLib'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">myLib</span>) </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">function</span> <span class="title">foo</span>(<span class="params"></span>) </span>&#123;</div><div class="line">		myLib.doSomething();</div><div class="line">	&#125;</div><div class="line">	<span class="keyword">return</span> &#123;</div><div class="line">		<span class="attr">foo</span> : foo</div><div class="line">	&#125;;</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>加载非规范的模块，require()之前，先require.config()，接受一个对象，除paths属性外，还有shim属性，配置不兼容的模块。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">require</span>.config(&#123;</div><div class="line">	<span class="attr">shim</span>: &#123;</div><div class="line">		<span class="comment">// underscore和backbone两个库，都没用AMD规范编写</span></div><div class="line">		<span class="string">'underscore'</span>:&#123;</div><div class="line">			<span class="comment">// exports：将依赖中的某个全局变量暴露，输出变量名</span></div><div class="line">			exports: <span class="string">'_'</span></div><div class="line">		&#125;,</div><div class="line">		<span class="string">'backbone'</span>: &#123;</div><div class="line">			<span class="comment">// deps数组，表明该模块的依赖</span></div><div class="line">			deps: [<span class="string">'underscore'</span>, <span class="string">'jquery'</span>],</div><div class="line">			<span class="attr">exports</span>: <span class="string">'Backbone'</span></div><div class="line">		&#125;,</div><div class="line">		<span class="comment">// jquery插件</span></div><div class="line">		<span class="string">'jquery.scroll'</span>: &#123;</div><div class="line">			<span class="attr">deps</span>: [<span class="string">'jquery'</span>],</div><div class="line">			<span class="attr">exports</span>: <span class="string">'jQuery.fn.scroll'</span></div><div class="line">		&#125;,</div><div class="line">		<span class="attr">hello</span>: &#123;</div><div class="line">			<span class="comment">// init：暴露多个变量，当exports与init同时存在，exports将被忽略</span></div><div class="line">			init: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">				<span class="keyword">return</span> &#123;</div><div class="line">					<span class="attr">hello</span>: hello,</div><div class="line">					<span class="attr">hello2</span>: hello2</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="comment">// hello.js</span></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	alert(<span class="string">"hello, world~"</span>);</div><div class="line">&#125;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">hello2</span>(<span class="params"></span>) </span>&#123;</div><div class="line">	alert(<span class="string">"hello, world, again~"</span>);</div><div class="line">&#125;</div><div class="line"><span class="comment">// 调用</span></div><div class="line">requirejs([<span class="string">'hello'</span>], <span class="function"><span class="keyword">function</span>(<span class="params">hello</span>) </span>&#123;</div><div class="line">	hello.hello1();</div><div class="line">	hello.hello2();</div><div class="line">&#125;);</div></pre></td></tr></table></figure>
</li>
<li><p>require.js提供插件。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// domready插件：让回调在DOM加载完后再运行</span></div><div class="line"><span class="built_in">require</span>([<span class="string">'domready!'</span>], <span class="function"><span class="keyword">function</span> (<span class="params">doc</span>) </span>&#123;</div><div class="line">	<span class="comment">// called once the DOM is ready</span></div><div class="line">&#125;);</div><div class="line"><span class="comment">// text和image插件，允许require.js加载文本和图片文件</span></div><div class="line">define([</div><div class="line">		<span class="string">'text!review.txt'</span>,</div><div class="line">		<span class="string">'image!cat.jpg'</span></div><div class="line">	],</div><div class="line"></div><div class="line">	<span class="function"><span class="keyword">function</span>(<span class="params">review, cat</span>) </span>&#123;</div><div class="line">		<span class="built_in">console</span>.log(review);</div><div class="line">		<span class="built_in">document</span>.body.appendChild(cat);</div><div class="line">	&#125;</div><div class="line">);</div></pre></td></tr></table></figure>
</li>
<li><p>为什么只能用jquery来依赖jquery, 而不能用其它名字？</p>
<figure class="highlight less"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="selector-tag">requirejs</span><span class="selector-class">.config</span>(&#123;</div><div class="line">	<span class="attribute">baseUrl</span>: <span class="string">'/public/js'</span>,</div><div class="line">	<span class="attribute">paths</span>: &#123;</div><div class="line">		<span class="attribute">myjquery</span>: <span class="string">'lib/jquery/jquery'</span></div><div class="line">	&#125;</div><div class="line">&#125;);</div><div class="line"></div><div class="line"><span class="selector-tag">requirejs</span>([<span class="string">'myjquery'</span>], function(jq) &#123;</div><div class="line">	<span class="selector-tag">alert</span>(jq);</div><div class="line">&#125;);</div><div class="line"><span class="comment">// jq is undefined</span></div></pre></td></tr></table></figure>
</li>
<li><p>原来在jquery中已经定义了：<code>define(&#39;jquery&#39;, [], function() { ... });</code>；</p>
</li>
</ul>

				</div>
				<!-- about -->
				
			</div>
			<!-- pagination -->
			
			<div class="comment-section">
	
	


</div>
		</div>
		
	</div>


		<footer>
			 
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

		</footer>
	</div>
	<!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script> -->
	<script src="/js/highlight.js"></script> 
	<script>hljs.initHighlightingOnLoad();var timeEnd = new Date();console.log('耗时：' + (timeEnd - timeStart));</script>
	<!-- <script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>-->
	<!-- material design -->
	<!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script> -->
	<!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>-->
	<!-- toc -->
	<!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
	<!-- <script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script> -->
	<!-- <script src="/libs/tocify/jquery.tocify.custom.js"></script> -->
	<!-- <script src="/js/main.js"></script> -->
</body>
</html>
