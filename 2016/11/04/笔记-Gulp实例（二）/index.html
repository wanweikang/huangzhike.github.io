	<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>[笔记]-Gulp实例（二） | 一切都沉淀为笔记</title>
  <meta name="author" content="Huangzhike">
  
  <meta name="description" content="出处：https://github.com/nimojs/gulp-book
package.json：如果熟悉 npm 则可以利用 package.json 保存所有 npm install –save-dev gulp-xxx 模块依赖和模块版本。
在命令行输入npm init，依次要求补全项目">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="[笔记]-Gulp实例（二）"/>
  <meta property="og:site_name" content="一切都沉淀为笔记"/>

  
  
		<!-- favicon -->
		<link rel="icon" type="image/ico" href="/favicon.ico" sizes="32x32">
		<link rel="manifest" href="/manifest.json">
		<meta name="msapplication-TileColor" content="#009688">
		<meta name="msapplication-TileImage" content="/mstile-144x144.ico">
		<meta name="theme-color" content="#009688">
		<!-- favicon end -->
    <!-- <link href="//favicon.ico" rel="icon"> -->
  

  <!-- toc -->
  <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css">

  <!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
  <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">

  <!-- material design -->
	<!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
  <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css">
  <!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
	<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css">

  <link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">

  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">

  

  

  <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>
	<script>window.jQuery || document.write('<script src="/libs/jquery-2.0.3.min.js" type="text/javascript"><\/script>')</script>

</head>

 	<body>
	  <nav class="navbar navbar-default">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">菜单</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">一切都沉淀为笔记</a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
            <ul class="nav navbar-nav navbar-right">
                
                <li>
                    <a href="/" title="">
                    <i class="fa fa-home"></i>首页
                    </a>
                </li>
                
                <li>
                    <a href="/archives" title="">
                    <i class="fa fa-list"></i>存档
                    </a>
                </li>
                
                <li>
                    <a href="/resume" title="我的主页">
                    <i class="fa fa-github"></i>GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</nav>

	  <div class="container" >
	    <div class="row">
	
	<div class="col-md-9 center-content">
	

		<div class="content">
			<!-- index -->
		   

			  		<h2>[笔记]-Gulp实例（二）</h2>
					
					<div>
						<span class="post-time">2016-11-04 18:12</span>
					</div>	
					

					<div class="article-content">
						<p>出处：<a href="https://github.com/nimojs/gulp-book" target="_blank" rel="external">https://github.com/nimojs/gulp-book</a></p>
<p>package.json：如果熟悉 npm 则可以利用 package.json 保存所有 npm install –save-dev gulp-xxx 模块依赖和模块版本。</p>
<p>在命令行输入<code>npm init</code>，依次要求补全项目信息，不清楚的可以直接回车跳过<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">name: (gulp-demo) </div><div class="line">version: (1.0.0) </div><div class="line">description: </div><div class="line">entry point: (index.js) </div><div class="line">test command: </div><div class="line">...</div><div class="line">...</div><div class="line">Is this ok? (yes)</div></pre></td></tr></table></figure></p>
<p>最终会在当前目录中创建 package.json 文件并生成类似如下代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">	&quot;name&quot;: &quot;gulp-demo&quot;,</div><div class="line">	&quot;version&quot;: &quot;0.0.0&quot;,</div><div class="line">	&quot;description&quot;: &quot;&quot;,</div><div class="line">	&quot;scripts&quot;: &#123;</div><div class="line">		&quot;test&quot;: &quot;echo \&quot;Error: no test specified\&quot; &amp;&amp; exit 1&quot;</div><div class="line">	&#125;,</div><div class="line">	&quot;repository&quot;: &#123;</div><div class="line">		&quot;type&quot;: &quot;git&quot;,</div><div class="line">		&quot;url&quot;: &quot;https://github.com/nimojs/gulp-demo.git&quot;</div><div class="line">	&#125;,</div><div class="line">	&quot;keywords&quot;: [</div><div class="line">		&quot;gulp&quot;,</div><div class="line">	],</div><div class="line">	&quot;author&quot;: &quot;nimojs &lt;nimo.jser@gmail.com&gt;&quot;,</div><div class="line">	&quot;license&quot;: &quot;MIT&quot;,</div><div class="line">	&quot;bugs&quot;: &#123;</div><div class="line">		&quot;url&quot;: &quot;https://github.com/nimojs/gulp-demo/issues&quot;</div><div class="line">	&#125;,</div><div class="line">	&quot;homepage&quot;: &quot;https://github.com/nimojs/gulp-demo&quot;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>安装依赖：安装 gulp 到项目（防止全局 gulp 升级后与此项目 gulpfile.js 代码不兼容）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">npm install gulp --save-dev</div><div class="line"></div><div class="line">// 此时打开 package.json 会发现多了如下代码</div><div class="line">&quot;devDependencies&quot;: &#123;</div><div class="line">	&quot;gulp&quot;: &quot;^3.8.11&quot; // 声明此项目的开发依赖 gulp</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>接着安装其他依赖：</p>
<p><code>npm install gulp-uglify gulp-watch-path stream-combiner2 gulp-sourcemaps gulp-minify-css gulp-autoprefixer gulp-less gulp-ruby-sass gulp-imagemin gulp-util --save-dev</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">// 此时，package.json 将会更新</div><div class="line">&quot;devDependencies&quot;: &#123;</div><div class="line">	&quot;colors&quot;: &quot;^1.0.3&quot;,</div><div class="line">	&quot;gulp&quot;: &quot;^3.8.11&quot;,</div><div class="line">	&quot;gulp-autoprefixer&quot;: &quot;^2.1.0&quot;,</div><div class="line">	&quot;gulp-imagemin&quot;: &quot;^2.2.1&quot;,</div><div class="line">	&quot;gulp-less&quot;: &quot;^3.0.2&quot;,</div><div class="line">	&quot;gulp-minify-css&quot;: &quot;^1.0.0&quot;,</div><div class="line">	&quot;gulp-ruby-sass&quot;: &quot;^1.0.1&quot;,</div><div class="line">	&quot;gulp-sourcemaps&quot;: &quot;^1.5.1&quot;,</div><div class="line">	&quot;gulp-uglify&quot;: &quot;^1.1.0&quot;,</div><div class="line">	&quot;gulp-watch-path&quot;: &quot;^0.0.7&quot;,</div><div class="line">	&quot;stream-combiner2&quot;: &quot;^1.0.2&quot;</div><div class="line">&#125;</div><div class="line">// 当分享这份gulpfile.js 配置时，不需要发送node_modules/</div><div class="line">// 只需在命令行输入`npm install`就可以检测 package.json 中的 devDependencies 并安装所有依赖。</div></pre></td></tr></table></figure></p>
<p>设计目录结构</p>
<p>文件分为2类，一类是源码，一类是编译压缩后的版本。文件夹分别为src和dist。(注意区分dist 和dest)<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">└── src/</div><div class="line">│</div><div class="line">└── dist/</div></pre></td></tr></table></figure></p>
<p>在 src/ 下创建前端资源对应的的文件夹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">└── src/</div><div class="line">├── less/    *.less 文件</div><div class="line">├── sass/    *.scss *.sass 文件</div><div class="line">├── css/     *.css  文件</div><div class="line">├── js/      *.js 文件</div><div class="line">├── fonts/   字体文件</div><div class="line">└── images/   图片</div><div class="line">└── dist/</div></pre></td></tr></table></figure></p>
<p>让命令行输出的文字带颜色：gulp 自带的输出都带时间和颜色。利用 gulp-util 实现同样的效果。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">var gulp = require(&apos;gulp&apos;);</div><div class="line">var gutil = require(&apos;gulp-util&apos;);</div><div class="line"></div><div class="line">gulp.task(&apos;default&apos;, function () &#123;</div><div class="line">	gutil.log(&apos;message&apos;)</div><div class="line">	gutil.log(gutil.colors.red(&apos;error&apos;))</div><div class="line">	gutil.log(gutil.colors.green(&apos;message:&apos;) + &quot;some&quot;)</div><div class="line">&#125;);</div><div class="line">// 使用 gulp 启动默认任务以测试 gulp-util</div></pre></td></tr></table></figure></p>
<p>配置 JS 任务</p>
<p>gulp-uglify：检测src/js/目录下的 js 文件修改后，压缩 js/ 中所有 js 文件并输出到 dist/js/ 中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">var uglify = require(&apos;gulp-uglify&apos;)</div><div class="line"></div><div class="line">gulp.task(&apos;uglifyjs&apos;, function () &#123;</div><div class="line">	gulp.src(&apos;src/js/**/*.js&apos;)</div><div class="line">		.pipe(uglify())</div><div class="line">		.pipe(gulp.dest(&apos;dist/js&apos;))</div><div class="line">&#125;)</div><div class="line"></div><div class="line">gulp.task(&apos;default&apos;, function () &#123;</div><div class="line">	gulp.watch(&apos;src/js/**/*.js&apos;, [&apos;uglifyjs&apos;])</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>在命令行输入 gulp 后会出现如下消息，表示已经启动。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">[20:39:50] Using gulpfile ~/Documents/code/gulp-book/demo/chapter7/gulpfile.js</div><div class="line">[20:39:50] Starting &apos;default&apos;...</div><div class="line">[20:39:50] Finished &apos;default&apos; after 13 ms</div><div class="line"></div><div class="line">// 此时编辑 src/js/log.js 文件并保存，命令行会出现如下消息，表示检测到 src/js/**/*.js 文件修改后重新编译所有 js。</div><div class="line">[20:39:52] Starting &apos;js&apos;...</div><div class="line">[20:39:52] Finished &apos;js&apos; after 14 ms</div></pre></td></tr></table></figure></p>
<p>gulp-watch-path</p>
<p>此配置有个性能问题，当 gulp.watch 检测到 src/js/目录下的js文件有修改时会将所有文件全部编译。实际上只需要重新编译被修改的文件。</p>
<p>简单介绍 gulp.watch 第二个参数为 function 时的用法。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">// 当修改 src/js/log.js 文件时</div><div class="line">gulp.watch(&apos;src/js/**/*.js&apos;, function (event) &#123;</div><div class="line">	console.log(event);</div><div class="line">	event &#123;</div><div class="line">		// 不管是添加，改变或是删除</div><div class="line">		type: &apos;changed&apos;, </div><div class="line">		// 触发事件的文件路径</div><div class="line">		path: &apos;/Users/nimojs/Documents/code/gulp-book/demo/chapter7/src/js/log.js&apos;</div><div class="line">	&#125;</div><div class="line">&#125;);</div></pre></td></tr></table></figure></p>
<p>我们可以利用 event 给到的信息，检测到某个 js 文件被修改时，只编写当前修改的 js 文件。</p>
<p>可以利用 gulp-watch-path 配合 event 获取编译路径和输出路径。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">var watchPath = require(&apos;gulp-watch-path&apos;);</div><div class="line"></div><div class="line">gulp.task(&apos;watchjs&apos;, function () &#123;</div><div class="line">	gulp.watch(&apos;src/js/**/*.js&apos;, function (event) &#123;</div><div class="line">		var paths = watchPath(event, &apos;src/&apos;, &apos;dist/&apos;);</div><div class="line">		/*</div><div class="line">		paths &#123; </div><div class="line">			srcPath: &apos;src/js/log.js&apos;,</div><div class="line">			srcDir: &apos;src/js/&apos;,</div><div class="line">			distPath: &apos;dist/js/log.js&apos;,</div><div class="line">			distDir: &apos;dist/js/&apos;,</div><div class="line">			srcFilename: &apos;log.js&apos;,</div><div class="line">			distFilename: &apos;log.js&apos; </div><div class="line">		&#125;</div><div class="line">		*/</div><div class="line">		gutil.log(gutil.colors.green(event.type) + &apos; &apos; + paths.srcPath);</div><div class="line">		gutil.log(&apos;Dist &apos; + paths.distPath);</div><div class="line"></div><div class="line">		gulp.src(paths.srcPath)</div><div class="line">			.pipe(uglify())</div><div class="line">			.pipe(gulp.dest(paths.distDir))</div><div class="line">	&#125;);</div><div class="line">&#125;);</div><div class="line">/*</div><div class="line">watchPath(event, search, replace, distExt)</div><div class="line">参数	说明</div><div class="line">event	gulp.watch 回调函数的 event</div><div class="line">search	需要被替换的起始字符串</div><div class="line">replace	第三个参数是新的的字符串</div><div class="line">distExt	扩展名(非必填)</div><div class="line">*/</div><div class="line">gulp.task(&apos;default&apos;, [&apos;watchjs&apos;]);</div><div class="line"></div><div class="line">// 此时编辑 src/js/log.js 文件并保存，命令行会出现消息，表示检测到 src/js/log.js 文件修改后只重新编译 log.js。</div><div class="line">[21:47:25] changed src/js/log.js</div><div class="line">[21:47:25] Dist dist/js/log.js</div></pre></td></tr></table></figure></p>
<p>stream-combiner2</p>
<p>编辑 log.js 文件时，如果文件中有 js 语法错误时，gulp 会终止运行并报错。可以使用stream-combiner2 捕获错误信息。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">// 当 log.js 缺少` )`</div><div class="line">log(&apos;gulp-book&apos;</div><div class="line"></div><div class="line">var handleError = function (err) &#123;</div><div class="line">	var colors = gutil.colors;</div><div class="line">	console.log(&apos;\n&apos;)</div><div class="line">	gutil.log(colors.red(&apos;Error!&apos;))</div><div class="line">	gutil.log(&apos;fileName: &apos; + colors.red(err.fileName))</div><div class="line">	gutil.log(&apos;lineNumber: &apos; + colors.red(err.lineNumber))</div><div class="line">	gutil.log(&apos;message: &apos; + err.message)</div><div class="line">	gutil.log(&apos;plugin: &apos; + colors.yellow(err.plugin))</div><div class="line">&#125;</div><div class="line">var combiner = require(&apos;stream-combiner2&apos;);</div><div class="line"></div><div class="line">gulp.task(&apos;watchjs&apos;, function () &#123;</div><div class="line">	gulp.watch(&apos;src/js/**/*.js&apos;, function (event) &#123;</div><div class="line">		var paths = watchPath(event, &apos;src/&apos;, &apos;dist/&apos;)</div><div class="line">		/*</div><div class="line">		paths</div><div class="line">		&#123; srcPath: &apos;src/js/log.js&apos;,</div><div class="line">		srcDir: &apos;src/js/&apos;,</div><div class="line">		distPath: &apos;dist/js/log.js&apos;,</div><div class="line">		distDir: &apos;dist/js/&apos;,</div><div class="line">		srcFilename: &apos;log.js&apos;,</div><div class="line">		distFilename: &apos;log.js&apos; &#125;</div><div class="line">		*/</div><div class="line">		gutil.log(gutil.colors.green(event.type) + &apos; &apos; + paths.srcPath)</div><div class="line">		gutil.log(&apos;Dist &apos; + paths.distPath)</div><div class="line">		var combined = combiner.obj([</div><div class="line">			gulp.src(paths.srcPath),</div><div class="line">			uglify(),</div><div class="line">			gulp.dest(paths.distDir)</div><div class="line">		])</div><div class="line">		combined.on(&apos;error&apos;, handleError)</div><div class="line">	&#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">// 此时当编译错误的语法时，命令行会出现错误提示。而且不会让 gulp 停止运行。</div></pre></td></tr></table></figure></p>
<p>JS 压缩前和压缩后比较<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">// 压缩前</div><div class="line">var log = function (msg) &#123;</div><div class="line">	console.log(&apos;--------&apos;);</div><div class="line">	console.log(msg)</div><div class="line">	console.log(&apos;--------&apos;);</div><div class="line">&#125;</div><div class="line">log(&#123;a:1&#125;)</div><div class="line">log(&apos;gulp-book&apos;)</div><div class="line"></div><div class="line">// 压缩后</div><div class="line">var log=function(o)&#123;console.log(&quot;--------&quot;),console.log(o),console.log(&quot;--------&quot;)&#125;;log(&#123;a:1&#125;),log(&quot;gulp-book&quot;);</div></pre></td></tr></table></figure></p>
<p>压缩后的代码不存在换行符和空白符，可以使用 sourcemap 帮助调试<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">var sourcemaps = require(&apos;gulp-sourcemaps&apos;)</div><div class="line">// ...</div><div class="line">var combined = combiner.obj([</div><div class="line">	gulp.src(paths.srcPath),</div><div class="line">	sourcemaps.init(),</div><div class="line">	uglify(),</div><div class="line">	sourcemaps.write(&apos;./&apos;),</div><div class="line">	gulp.dest(paths.distDir)</div><div class="line">])</div><div class="line">// ...</div></pre></td></tr></table></figure></p>
<p>此时 dist/js/ 中也会生成对应的 .map 文件，以便使用 Chrome 控制台调试代码。</p>
<p>有时也需要一次编译所有 js 文件。可以配置 uglifyjs 任务。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">gulp.task(&apos;uglifyjs&apos;, function () &#123;</div><div class="line">	var combined = combiner.obj([</div><div class="line">		gulp.src(&apos;src/js/**/*.js&apos;),</div><div class="line">		sourcemaps.init(),</div><div class="line">		uglify(),</div><div class="line">		sourcemaps.write(&apos;./&apos;),</div><div class="line">		gulp.dest(&apos;dist/js/&apos;)</div><div class="line">	])</div><div class="line">	combined.on(&apos;error&apos;, handleError)</div><div class="line">&#125;)</div><div class="line">// 命令行输入 gulp uglifyjs 以压缩 src/js/ 下的所有 js 文件。</div></pre></td></tr></table></figure></p>
<p>有时不想使用 LESS 或 SASS而是直接编写 CSS，但需要压缩 CSS 以提高页面加载速度。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">var minifycss = require(&apos;gulp-minify-css&apos;)</div><div class="line"></div><div class="line">gulp.task(&apos;watchcss&apos;, function () &#123;</div><div class="line">	gulp.watch(&apos;src/css/**/*.css&apos;, function (event) &#123;</div><div class="line">		var paths = watchPath(event, &apos;src/&apos;, &apos;dist/&apos;)</div><div class="line">		gutil.log(gutil.colors.green(event.type) + &apos; &apos; + paths.srcPath)</div><div class="line">		gutil.log(&apos;Dist &apos; + paths.distPath)</div><div class="line">		gulp.src(paths.srcPath)</div><div class="line">			.pipe(sourcemaps.init())</div><div class="line">			.pipe(minifycss())</div><div class="line">			.pipe(sourcemaps.write(&apos;./&apos;))</div><div class="line">			.pipe(gulp.dest(paths.distDir))</div><div class="line">	&#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">gulp.task(&apos;default&apos;, [&apos;watchjs&apos;,&apos;watchcss&apos;])</div><div class="line">gulp-autoprefixer</div></pre></td></tr></table></figure></p>
<p>autoprefixer 解析 CSS 文件并且添加浏览器前缀到CSS规则里。只需要关心编写标准语法的 css，autoprefixer 会自动补全。 </p>
<p>autoprefixer 处理前：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">.demo &#123;</div><div class="line">	display:flex;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>autoprefixer 处理后：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line">.demo &#123;</div><div class="line">	display:-webkit-flex;</div><div class="line">	display:-ms-flexbox;</div><div class="line">	display:flex;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>在 watchcss 任务中加入 autoprefixer:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">gulp.task(&apos;watchcss&apos;, function () &#123;</div><div class="line">	gulp.watch(&apos;src/css/**/*.css&apos;, function (event) &#123;</div><div class="line">		var paths = watchPath(event, &apos;src/&apos;, &apos;dist/&apos;)</div><div class="line">		gutil.log(gutil.colors.green(event.type) + &apos; &apos; + paths.srcPath)</div><div class="line">		gutil.log(&apos;Dist &apos; + paths.distPath)</div><div class="line">		gulp.src(paths.srcPath)</div><div class="line">			.pipe(sourcemaps.init())</div><div class="line">			.pipe(autoprefixer(&#123;</div><div class="line">				browsers: &apos;last 2 versions&apos;</div><div class="line">			&#125;))</div><div class="line">			.pipe(minifycss())</div><div class="line">			.pipe(sourcemaps.write(&apos;./&apos;))</div><div class="line">			.pipe(gulp.dest(paths.distDir))</div><div class="line">	&#125;)</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>有时也需要一次编译所有 css 文件。可以配置 minifyss 任务。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line">gulp.task(&apos;minifycss&apos;, function () &#123;</div><div class="line">	gulp.src(&apos;src/css/**/*.css&apos;)</div><div class="line">		.pipe(sourcemaps.init())</div><div class="line">		.pipe(autoprefixer(&#123;</div><div class="line">			browsers: &apos;last 2 versions&apos;</div><div class="line">		&#125;))</div><div class="line">		.pipe(minifycss())</div><div class="line">		.pipe(sourcemaps.write(&apos;./&apos;))</div><div class="line">		.pipe(gulp.dest(&apos;dist/css/&apos;))</div><div class="line">&#125;)</div><div class="line">// 命令行输入 gulp minifyss 以压缩 src/css/ 下的所有 .css 文件并复制到 dist/css 目录下</div></pre></td></tr></table></figure></p>
<p>配置 Less 任务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line">var less = require(&apos;gulp-less&apos;)</div><div class="line"></div><div class="line">gulp.task(&apos;watchless&apos;, function () &#123;</div><div class="line">	gulp.watch(&apos;src/less/**/*.less&apos;, function (event) &#123;</div><div class="line">	var paths = watchPath(event, &apos;src/less/&apos;, &apos;dist/css/&apos;)</div><div class="line">	gutil.log(gutil.colors.green(event.type) + &apos; &apos; + paths.srcPath)</div><div class="line">	gutil.log(&apos;Dist &apos; + paths.distPath)</div><div class="line">	var combined = combiner.obj([</div><div class="line">		gulp.src(paths.srcPath),</div><div class="line">		sourcemaps.init(),</div><div class="line">		autoprefixer(&#123;</div><div class="line">			browsers: &apos;last 2 versions&apos;</div><div class="line">		&#125;),</div><div class="line">		less(),</div><div class="line">		minifycss(),</div><div class="line">		sourcemaps.write(&apos;./&apos;),</div><div class="line">		gulp.dest(paths.distDir)</div><div class="line">	])</div><div class="line">	combined.on(&apos;error&apos;, handleError)</div><div class="line">	&#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">gulp.task(&apos;lesscss&apos;, function () &#123;</div><div class="line">	var combined = combiner.obj([</div><div class="line">		gulp.src(&apos;src/less/**/*.less&apos;),</div><div class="line">		sourcemaps.init(),</div><div class="line">		autoprefixer(&#123;</div><div class="line">			browsers: &apos;last 2 versions&apos;</div><div class="line">		&#125;),</div><div class="line">		less(),</div><div class="line">		minifycss(),</div><div class="line">		sourcemaps.write(&apos;./&apos;),</div><div class="line">		gulp.dest(&apos;dist/css/&apos;)</div><div class="line">	])</div><div class="line">	combined.on(&apos;error&apos;, handleError)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">gulp.task(&apos;default&apos;, [&apos;watchjs&apos;, &apos;watchcss&apos;, &apos;watchless&apos;])</div></pre></td></tr></table></figure></p>
<p>配置 Sass 任务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">gulp.task(&apos;watchsass&apos;,function () &#123;</div><div class="line">	gulp.watch(&apos;src/sass/**/*&apos;, function (event) &#123;</div><div class="line">	var paths = watchPath(event, &apos;src/sass/&apos;, &apos;dist/css/&apos;)</div><div class="line">	gutil.log(gutil.colors.green(event.type) + &apos; &apos; + paths.srcPath)</div><div class="line">	gutil.log(&apos;Dist &apos; + paths.distPath)</div><div class="line">	sass(paths.srcPath)</div><div class="line">		.on(&apos;error&apos;, function (err) &#123;</div><div class="line">			console.error(&apos;Error!&apos;, err.message);</div><div class="line">		&#125;)</div><div class="line">		.pipe(sourcemaps.init())</div><div class="line">		.pipe(minifycss())</div><div class="line">		.pipe(autoprefixer(&#123;</div><div class="line">			browsers: &apos;last 2 versions&apos;</div><div class="line">		&#125;))</div><div class="line">		.pipe(sourcemaps.write(&apos;./&apos;))</div><div class="line">		.pipe(gulp.dest(paths.distDir))</div><div class="line">	&#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">gulp.task(&apos;sasscss&apos;, function () &#123;</div><div class="line">	sass(&apos;src/sass/&apos;)</div><div class="line">		.on(&apos;error&apos;, function (err) &#123;</div><div class="line">			console.error(&apos;Error!&apos;, err.message);</div><div class="line">		&#125;)</div><div class="line">		.pipe(sourcemaps.init())</div><div class="line">		.pipe(minifycss())</div><div class="line">		.pipe(autoprefixer(&#123;</div><div class="line">			browsers: &apos;last 2 versions&apos;</div><div class="line">		&#125;))</div><div class="line">		.pipe(sourcemaps.write(&apos;./&apos;))</div><div class="line">		.pipe(gulp.dest(&apos;dist/css&apos;))</div><div class="line">&#125;)</div><div class="line"></div><div class="line">gulp.task(&apos;default&apos;, [&apos;watchjs&apos;, &apos;watchcss&apos;, &apos;watchless&apos;, &apos;watchsass&apos;, &apos;watchsass&apos;])</div></pre></td></tr></table></figure></p>
<p>配置 image 任务<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line">var imagemin = require(&apos;gulp-imagemin&apos;)</div><div class="line"></div><div class="line">gulp.task(&apos;watchimage&apos;, function () &#123;</div><div class="line">	gulp.watch(&apos;src/images/**/*&apos;, function (event) &#123;</div><div class="line">		var paths = watchPath(event,&apos;src/&apos;,&apos;dist/&apos;)</div><div class="line"></div><div class="line">		gutil.log(gutil.colors.green(event.type) + &apos; &apos; + paths.srcPath)</div><div class="line">		gutil.log(&apos;Dist &apos; + paths.distPath)</div><div class="line"></div><div class="line">		gulp.src(paths.srcPath)</div><div class="line">			.pipe(imagemin(&#123;</div><div class="line">				progressive: true</div><div class="line">			&#125;))</div><div class="line">			.pipe(gulp.dest(paths.distDir))</div><div class="line">	&#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">gulp.task(&apos;image&apos;, function () &#123;</div><div class="line">	gulp.src(&apos;src/images/**/*&apos;)</div><div class="line">		.pipe(imagemin(&#123;</div><div class="line">			progressive: true</div><div class="line">		&#125;))</div><div class="line">		.pipe(gulp.dest(&apos;dist/images&apos;))</div><div class="line">&#125;)</div></pre></td></tr></table></figure></p>
<p>配置文件复制任务：复制 src/fonts/ 文件到 dist/ 中<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line">gulp.task(&apos;watchcopy&apos;, function () &#123;</div><div class="line">	gulp.watch(&apos;src/fonts/**/*&apos;, function (event) &#123;</div><div class="line">	var paths = watchPath(event)</div><div class="line"></div><div class="line">	gutil.log(gutil.colors.green(event.type) + &apos; &apos; + paths.srcPath)</div><div class="line">	gutil.log(&apos;Dist &apos; + paths.distPath)</div><div class="line"></div><div class="line">	gulp.src(paths.srcPath)</div><div class="line">		.pipe(gulp.dest(paths.distDir))</div><div class="line">	&#125;)</div><div class="line">&#125;)</div><div class="line"></div><div class="line">gulp.task(&apos;copy&apos;, function () &#123;</div><div class="line">	gulp.src(&apos;src/fonts/**/*&apos;)</div><div class="line">		.pipe(gulp.dest(&apos;dist/fonts/&apos;))</div><div class="line">&#125;)</div><div class="line"></div><div class="line">gulp.task(&apos;default&apos;, [&apos;watchjs&apos;, &apos;watchcss&apos;, &apos;watchless&apos;, &apos;watchsass&apos;, &apos;watchimage&apos;, &apos;watchcopy&apos;])</div></pre></td></tr></table></figure></p>

					</div>

			  <!-- about -->
			  
		</div>

		<!-- pagination -->
	  

		<div class="comment-section">
  
  


</div>
	</div>

	

</div>


		<footer>
			

<p>
  Powered by <a href="https://hexo.io">Hexo</a>  | with <a href="https://github.com/wayou/hexo-theme-material">Material</a> theme
</p>
<p>
  &copy; 2016 <a href="http://huangzhike.github.io"> Huangzhike </a>
</p>
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

		</footer>
	  </div>

		<!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script>
		<script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>

		<!-- material design -->
		<!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script>
		<!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>
		<!-- toc -->
		<!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
		<script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
		<script src="/libs/tocify/jquery.tocify.custom.js"></script>

		<script src="/js/main.js"></script>

	</body>
</html>
