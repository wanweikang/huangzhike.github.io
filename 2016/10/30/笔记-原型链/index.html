<!DOCTYPE HTML>
<html>
    <head>
        <meta charset="utf-8">
        <script>
            var timeStart = new Date();
        </script>
        
        <title>[ç¬”è®°]-åŸå‹é“¾ | ğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒ•ğŸŒ–ğŸŒ—ğŸŒ˜</title>
        
        <meta name="author" content="huangzhike">
        
        
        <meta name="description" content="2016-11-17æ›´æ–°
JavaScriptåŸºäºåŸå‹ï¼ˆprototype-basedï¼‰å®ç°é¢å‘å¯¹è±¡ï¼ˆOOPï¼‰ï¼Œä½†ä¸æ˜¯æ‰€æœ‰å¯¹è±¡éƒ½æœ‰åŸå‹ï¼ˆprototypeï¼‰å±æ€§ï¼š
var obj = {};
obj.prototype; // undefined
å¯¹è±¡å®ä¾‹(Object Instance)æ²¡æœ‰åŸå‹ï¼ˆ">
        
        
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        
        <meta property="og:title" content="[ç¬”è®°]-åŸå‹é“¾"/>
        
        <meta property="og:site_name" content="ğŸŒ‘ğŸŒ’ğŸŒ“ğŸŒ”ğŸŒ•ğŸŒ–ğŸŒ—ğŸŒ˜"/>
        
        
        <!-- favicon -->
        <link rel="icon" type="image/ico" href="/ok.ico" sizes="32x32">
        <meta name="msapplication-TileColor" content="#009688">
        <meta name="msapplication-TileImage" content="/mstile-144x144.ico">
        <meta name="theme-color" content="#009688">
        <!-- favicon end -->
        <!-- <link href="//ok.ico" rel="icon"> -->
        
        <!-- toc -->
        <!-- <link rel="stylesheet" href="/libs/tocify/jquery.tocify.css" media="screen" type="text/css"> -->
        <!-- <link rel="stylesheet" href="/libs/bs/css/bootstrap.min.css" media="screen" type="text/css"> -->
        <!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap/3.3.4/css/bootstrap.min.css" media="screen" type="text/css">-->
        <!-- material design -->
        <!-- <link rel="stylesheet" href="/libs/bs-material/css/ripples.min.css" media="screen" type="text/css"> -->
        <!-- <link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/ripples.min.css" media="screen" type="text/css"> -->
        <!-- <link rel="stylesheet" href="/libs/bs-material/css/material.min.css" media="screen" type="text/css"> -->
        <!--<link rel="stylesheet" href="//apps.bdimg.com/libs/bootstrap-material/0.3.0/css/material.min.css" media="screen" type="text/css"> -->
        <!--<link rel="stylesheet" href="/css/highlight.light.css" media="screen" type="text/css">-->
        <link rel="stylesheet" href="/css/bootstrap.min.css" media="screen" type="text/css">
        <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
        <link rel="stylesheet" href="/css/prism.css" media="screen" type="text/css">
        
        <!-- <script src="//apps.bdimg.com/libs/jquery/2.0.3/jquery.min.js"></script>-->
        <!-- <script>window.jQuery || document.write('<script src="/libs/jquery-3.1.1.slim.min.js" type="text/javascript"><\/script>')</script>-->
    <meta name="generator" content="Hexo 4.2.1"></head>

<body>
    <nav class="navbar navbar-default">
	<div class="container">
		<div class="navbar-header">
			<button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
				<span class="sr-only">èœå•</span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
				<span class="icon-bar"></span>
			</button>
			<a class="navbar-brand" title="ä¸‹ä¸€å¥æ˜¯ï¼šå®¢æœ‰å¯äººæœŸä¸æ¥ã€‚å°æ—¶å€™ï¼Œå–œæ¬¢é åœ¨é˜³å°ä¸Šï¼Œä¸€è¾¹å¹é£ï¼Œä¸€è¾¹çœ‹ä¹¦ï¼Œå–œæ¬¢è¯»ä¹¦å—ï¼Œéªšå¹´ï¼Ÿ" href="/">ä¹¦å½“å¿«æ„è¯»æ˜“å°½</a>
           
		</div>
		<div id="navbar" class="collapse navbar-collapse">
			<ul class="nav navbar-nav navbar-right">
				
				<li>
					<a href="https://huangzhike.github.io/archives" title="">
						<i class="fa fa-list"></i>Archives
					</a>
				</li>
				
				<li>
					<a href="https://github.com/huangzhike" target="_blank" rel="noopener" title="">
						<i class="fa fa-github"></i>GitHub
					</a>
				</li>
				
			</ul>
		</div>
	</div>
</nav>

    <div class="container" >
        <div class="row">
	
		<div class="col-md-9 center-content">
			
			<div class="content">
				<!-- index -->
				
				<h2>[ç¬”è®°]-åŸå‹é“¾</h2>
				
				<div>
					<div class="post-time">2016-10-30</div>
				</div>
				
				<div class="article-content">
				<p><strong>2016-11-17æ›´æ–°</strong></p>
<p>JavaScriptåŸºäºåŸå‹ï¼ˆprototype-basedï¼‰å®ç°é¢å‘å¯¹è±¡ï¼ˆOOPï¼‰ï¼Œä½†ä¸æ˜¯æ‰€æœ‰å¯¹è±¡éƒ½æœ‰åŸå‹ï¼ˆprototypeï¼‰å±æ€§ï¼š</p>
<pre class=" language-JavaScript"><code class="language-JavaScript">var obj = {};
obj.prototype; // undefined</code></pre>
<p>å¯¹è±¡å®ä¾‹(Object Instance)æ²¡æœ‰åŸå‹ï¼ˆprototypeï¼‰ï¼Œè€Œæ„é€ å™¨(constructor)æœ‰åŸå‹ï¼Œâ€œ[constructor].prototypeâ€æŒ‡å‘åŸå‹ã€‚</p>
<pre class=" language-JavaScript"><code class="language-JavaScript">var Foo = new Function();
// prototypeæ˜¯functionè‡ªå¸¦å±æ€§ï¼Œfunctionæœ¬èº«ä¹Ÿæ˜¯å¯¹è±¡
Foo.prototype; // {}

var instance = new Foo;
instance.prototype; // undefinedï¼Œå¯¹è±¡å®ä¾‹æ²¡æœ‰åŸå‹

var str = "Hello";
str.prototype; // undefined</code></pre>
<p>prototypeæ˜¯å‡½æ•°ç±»å‹è‡ªå¸¦å±æ€§ï¼Œéå‡½æ•°ç±»å‹æ²¡æœ‰ï¼ˆObjectï¼ŒStringç­‰ç±»å‹çš„æ„é€ å‡½æ•°æœ¬èº«ä¹Ÿæ˜¯å‡½æ•°ï¼Œæ‰€ä»¥æœ‰prototypeå±æ€§ï¼‰ï¼š</p>
<pre class=" language-JavaScript"><code class="language-JavaScript">Object.prototype; // Object {}
Function.prototype; // function(){}
String.prototype; // String {length: 0, [[PrimitiveValue]]: ""}</code></pre>
<p>æ‰€æœ‰å¯¹è±¡ï¼ˆundefinedã€nullé™¤å¤–ï¼‰éƒ½æœ‰[[Prototype]]å±æ€§ï¼Œå³éšå¼åŸå‹ã€‚æŒ‡å‘â€œæ„é€ å‡½æ•°â€çš„prototypeï¼ˆåŸå‹å¯¹è±¡ï¼‰ï¼Œå‡½æ•°ä¹Ÿæ˜¯å¯¹è±¡ï¼Œä¹Ÿæœ‰<code>__proto__</code>ã€‚</p>
<p>å®ä¾‹å¯¹è±¡çš„<code>__proto__</code>å±æ€§ä»…æŒ‡å‘æ„é€ å‡½æ•°çš„åŸå‹ï¼ˆprototypeï¼‰å¯¹è±¡ï¼Œè€Œä¸æŒ‡å‘æ„é€ å‡½æ•°ã€‚</p>
<pre class=" language-JavaScript"><code class="language-JavaScript">var Foo = function () {};
var a = {};
Foo.prototype = a;
var foo = new Foo();
foo.__proto__ === a // true</code></pre>
<p>JavaScriptå¼•æ“é€šè¿‡<code>__proto__</code>å±æ€§ä¸€çº§ä¸€çº§å½¢æˆâ€œåŸå‹é“¾â€ï¼ˆprototype chainï¼‰ã€‚</p>
<pre class=" language-JavaScript"><code class="language-JavaScript">var a = { x: 1 };
var b = { __proto__: a};
var c = { __proto__: b};
c.x // 1</code></pre>
<p>å¦‚æœæ²¡æœ‰æ”¹å˜Obejectå¯¹è±¡<code>__proto__</code>ï¼Œåˆ™æŒ‡å‘<code>Object.prototype</code>ï¼ˆ<code>Object.prototype.__proto__</code>æŒ‡å‘<code>null</code>ï¼ŒåŸå‹é“¾ç»ˆç»“ï¼‰ã€‚</p>
<pre class=" language-JavaScript"><code class="language-JavaScript">var obj = new Object();
// ç­‰ä»·äº
var obj = {};

obj.prototype; // undefined ï¼ˆæ²¡æœ‰prototypeå±æ€§ï¼‰
obj.__proto__ === Object.prototype // objå¯¹è±¡æ˜¯è¢«Objectå‡½æ•°åˆ›å»ºçš„
obj.__proto__ === obj.constructor.prototype
obj.__proto__ === Object.getFrototypeOf(obj)</code></pre>
<p>è·å–å®ä¾‹å¯¹è±¡çš„åŸå‹å¯¹è±¡æœ‰ä¸‰ç§æ–¹æ³•ï¼š<code>obj.__proto__</code>ï¼›<code>obj.constructor.prototype</code>ï¼›<code>Object.getPrototypeOf(obj)</code>ã€‚</p>
<pre class=" language-JavaScript"><code class="language-JavaScript">Array.prototype.p = "abc";
var arr = new Array();
arr.p // abc
arr.__proto__.p // abc ï¼ˆé€šè¿‡__proto__è¯»å–å®šä¹‰åœ¨åŸå‹å¯¹è±¡ä¸Šçš„å±æ€§ï¼‰
arr.constructor.prototype.p // abc ï¼ˆé€šè¿‡constructor.prototypeè¯»å–å®šä¹‰åœ¨åŸå‹å¯¹è±¡ä¸Šçš„å±æ€§ï¼‰</code></pre>
<p>Object.getPrototypeOfæ–¹æ³•ï¼Œæ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒ<code>__proto__</code>å±æ€§ã€‚</p>
<pre class=" language-JavaScript"><code class="language-JavaScript">Object.getPrototypeOf({ __proto__: null }) === null
// å°†ä¸€ä¸ªå¯¹è±¡çš„__proto__å±æ€§è®¾ä¸ºnullï¼Œç„¶åä½¿ç”¨Object.getPrototypeOfæ–¹æ³•è·å–åŸå‹ï¼Œåˆ¤æ–­æ˜¯å¦ç­‰äºnullã€‚
// å¦‚æœæ”¯æŒ__proto__å±æ€§ï¼Œæ¯”è¾ƒç»“æœæ˜¯trueã€‚å¦åˆ™ï¼Œç­‰å¼å·¦è¾¹çš„å€¼ç­‰äºObjectã€‚</code></pre>
<ul>
<li>JavaScriptçš„ç»§æ‰¿é€šè¿‡æ„é€ å‡½æ•°å’ŒåŸå‹é“¾çš„æ··åˆæ¨¡å¼å®ç°ï¼Œé¿å…å¯¹è±¡å…±äº«å¯ä»¥ç”¨ä¸€ä¸ªç©ºå‡½æ•°å½“åšä¸­é—´å˜é‡ã€‚</li>
<li>prototypeå’Œconstructoræ¥æ„æˆå¤–éƒ¨åŸå‹é“¾ï¼Œå¼€å‘äººå‘˜å†™ä»£ç å›æº¯æ—¶ç”¨ï¼Œ<strong>proto</strong>å½¢æˆå†…éƒ¨åŸå‹é“¾ï¼Œæ˜¯JavaScriptå¼•æ“åŸå‹ç»§æ‰¿æœºåˆ¶ã€‚</li>
<li>å†…éƒ¨åŸå‹é“¾ï¼šå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ï¼Œå¯èƒ½å®šä¹‰åœ¨è‡ªèº«ä¸Šï¼Œä¹Ÿå¯èƒ½å®šä¹‰åœ¨åŸå‹å¯¹è±¡ä¸Šã€‚å½“è¯»å–å¯¹è±¡çš„å±æ€§æ—¶ï¼ˆa.bï¼‰ï¼Œå…ˆåœ¨å½“å‰å¯¹è±¡ä¸ŠæŸ¥æ‰¾è¯¥å±æ€§ï¼Œå¦‚æœæ²¡æœ‰ï¼Œæ²¿ç€protoè¿™æ¡é“¾ï¼Œåˆ°å…¶åŸå‹å¯¹è±¡ä¸Šæ‰¾ï¼Œå¦‚æœè¿˜æ²¡æœ‰ï¼Œå°±åˆ°åŸå‹çš„åŸå‹æ‰¾ã€‚å¦‚æœä¸€ç›´ä¸Šæº¯åˆ°Object.prototypeè¿˜æ˜¯æ‰¾ä¸åˆ°ï¼Œè¿”å›undefinedã€‚</li>
<li>å¦‚æœåŸå‹é“¾å¾ˆé•¿ï¼ŒæŸ¥æ‰¾å¯¹è±¡çš„å±æ€§å°±ä¼šå˜æ…¢ï¼Œå› æ­¤è¦ä¸è¦æŠŠåŸå‹é“¾æå¾—å¤ªé•¿ã€‚</li>
<li>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨åŸå‹é“¾ä¸­å›æº¯æŸ¥è¯¢å±æ€§ï¼Œåœ¨å†…éƒ¨åŸå‹é“¾ä¸­è¿›è¡Œï¼Œè¿™ä¸ªè¿‡ç¨‹æ˜¯ç”±JavaScriptå¼•æ“ç»´æŠ¤çš„ã€‚</li>
<li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ<code>__proto__</code>å±æ€§æŒ‡å‘çš„å’Œprototypeå±æ€§ä¸€æ ·ï¼ŒæŒ‡å‘çš„éƒ½æ˜¯åŸå‹å¯¹è±¡ã€‚</li>
</ul>
<pre class=" language-JavaScript"><code class="language-JavaScript">var arr = [];
arr.prototype; // undefined
// åŸå‹é“¾ï¼š
arr --> Array.prototype --> Object.prototype --> null
// Array.prototypeä¸Šæœ‰indexOf()ã€shift()ç­‰æ–¹æ³•ï¼Œæ•°ç»„å¯¹è±¡éƒ½å¯ä»¥è°ƒç”¨ã€‚

function Foo() {}
// åŸå‹é“¾ï¼š
Foo --> Function.prototype --> Object.prototype --> null
// Function.prototypeä¸Šæœ‰apply()ç­‰æ–¹æ³•ï¼Œå‡½æ•°å¯¹è±¡éƒ½å¯ä»¥è°ƒç”¨ã€‚</code></pre>
<pre class=" language-JavaScript"><code class="language-JavaScript">var Foo = {
     name: "Jim",
     sayName: function () {
          console.log(this.name);
     }
};

var Bar = {
     name: "Sam"
};

Bar.__proto__ = Foo; // æŠŠBarçš„åŸå‹æŒ‡å‘å¯¹è±¡Foo
Bar.sayName===Foo.sayName; // true
Bar.sayName(); // Sam</code></pre>
<p>å¦‚æœè®©æŸä¸ªå‡½æ•°çš„prototypeå±æ€§æŒ‡å‘ä¸€ä¸ªæ•°ç»„ï¼Œè¯¥å‡½æ•°å¯ä»¥ä½œæ•°ç»„çš„æ„é€ å‡½æ•°ï¼Œå› ä¸ºå®ƒç”Ÿæˆçš„å®ä¾‹å¯¹è±¡éƒ½å¯ä»¥é€šè¿‡prototypeè°ƒç”¨å®šä¹‰åœ¨æ•°ç»„çš„prototypeå¯¹è±¡ä¸Šé¢çš„æ•°ç»„æ–¹æ³•ã€‚</p>
<pre class=" language-JavaScript"><code class="language-JavaScript">function arrFunc() {}
arrFunc.prototype = new Array();
arrFunc.prototype.constructor = arrFunc;
var arrf = new arrFunc();
arrf.push(1, 2, 3);
arrf.length // 3
arrf instanceof Array // true</code></pre>
<p><img src="/imgs/prototype_chain.png" alt="prototype_chain by huangzhike"></p>
<pre class=" language-JavaScript"><code class="language-JavaScript">function Foo() {}
var Foo = function() {};
var Foo = new Function();
typeof Foo; // function

// å‡½æ•°è¢«Functionåˆ›å»ºï¼ŒFunctionè¢«è‡ªèº«åˆ›å»ºï¼Œå®ƒçš„ __proto__æŒ‡å‘è‡ªèº«çš„prototype
Foo.__proto__ === Function.prototype; // å¯¹è±¡çš„__proto__æŒ‡å‘åˆ›å»ºå®ƒçš„æ„é€ å‡½æ•°çš„prototype
Foo.__proto__.constructor === Function;

Function.__proto__ === Function.prototype;
Function.__proto__.constructor === Function;

Foo.prototype.__proto__ !== Foo.prototype.constructor.prototype;
Foo.prototype.__proto__ === Object.prototype;
Foo.prototype.constructor === Foo; // prototype.constructoræŒ‡å‘æ„é€ å‡½æ•°Fooæœ¬èº«

Function.prototype.__proto__ === Object.prototype; // Function.prototypeä¹Ÿæ˜¯è¢«Objectåˆ›å»ºçš„å¯¹è±¡
Function.prototype.constructor === Function;

var foo = new Foo();
typeof foo; // object

foo.prototype; // undefined
foo.__proto__ === Foo.prototype;
foo.__proto__ === foo.constructor.prototype;

Object.__proto__ !== Object.prototype;
Object.__proto__ === Function.prototype;
Object.prototype.constructor.__proto__ === Function.prototype;

Object.prototype.__proto__ === null; // é¡¶çº§å¯¹è±¡
Object.prototype.constructor === Object;

String.__proto__ === Function.prototype;
Number.__proto__ === Function.prototype;
Boolean.__proto__ === Function.prototype;
Array.__proto__===Function.prototype;
Function.__proto__ === Function.prototype;
Object.__proto__ === Function.prototype;

RegExp.__proto__ === Function.prototype;
Date.__proto__ === Function.prototype;

JSON.__proto__ === Object.prototype;
Math.__proto__ === Object.prototype;</code></pre>
<p>instanceofå®é™…ä¸Šæ˜¯åˆ¤æ–­<code>__proto__</code>ï¼ˆä»¥åŠ<code>__proto__.__proto__</code>â€¦ï¼‰æŒ‡å‘åŸå‹ï¼š</p>
<pre class=" language-JavaScript"><code class="language-JavaScript">foo instanceof Foo; // true
foo instanceof Object; // true
foo instanceof Function; // false

foo.__proto__ === Foo.prototype; // true
foo.__proto__.__proto__ === Object.prototype; // true
foo.__proto__.__proto__ === Function.prototype;  // false</code></pre>
<pre class=" language-JavaScript"><code class="language-JavaScript">Foo.prototype.isPrototypeOf(foo) // true ï¼Œå®ä¾‹fooçš„åŸå‹æ˜¯Foo.prototypeä¸æ˜¯Foo
Object.prototype.isPrototypeOf(Foo) // true</code></pre>
<pre class=" language-JavaScript"><code class="language-JavaScript">var arr = new Array();
arr.__proto__ === Array.prototype;
arr.__proto__.__proto__ === Object.prototype; // Array.prototype.__proto__ === Object.prototype
arr.__proto__.__proto__.__proto__ === null; // Object.prototype.__proto__ === null
Array.__proto__===Function.prototype; // true
Array instanceof Function; // true
Function.__proto__.__proto__.__proto__ === null; // true

var obj = new Object();
obj.__proto__ === Object.prototype;  // true
obj.__proto__.constructor === Object; // true
obj.__proto__.__proto__ === null;   // true</code></pre>
<p>ä¸€åˆ‡çš†å¯¹è±¡çš„æ„æ€ï¼šnew Fooï¼Œnew Objectï¼Œnew Functionå…¨éƒ¨æŒ‡å‘Object.prototypeï¼Œè¿½æ ¹æº¯æºï¼Œæœ€æºå¤´çš„å¯¹è±¡éƒ½æ˜¯ä»Objectæ„é€ å‡½æ•°ç”Ÿæˆï¼ˆä½¿ç”¨new Object()å‘½ä»¤ï¼‰ï¼Œæ‰€æœ‰å¯¹è±¡çš„åŸå‹éƒ½å¯ä»¥ä¸Šæº¯åˆ°Object.prototypeã€‚</p>
<p>Object.prototypeçš„åŸå‹æ˜¯nullï¼ŒåŸå‹é“¾ç»ˆç»“ã€‚</p>
<pre class=" language-JavaScript"><code class="language-JavaScript">Object.getPrototypeOf(Object.prototype) // null</code></pre>
<ul>
<li>æœ€é¡¶çº§æ„é€ å™¨ï¼šFunction</li>
<li>æœ€é¡¶çº§åŸå‹ï¼šObject.prototype</li>
</ul>

				</div>
				<!-- about -->
				
			</div>
			<!-- pagination -->
			
			<div class="comment-section">
	
	


</div>
		</div>
		
	</div>


        <footer>
             
<a id="gotop" href="#" title="back to top"><i class="mdi-hardware-keyboard-arrow-up"></i></a>

        </footer>
    </div>
    <!-- <script src="/libs/bs/js/bootstrap.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/bootstrap/3.3.4/js/bootstrap.min.js"></script> -->
    <script>
        var timeEnd = new Date();
        console.log('è€—æ—¶ï¼š' + (timeEnd - timeStart));
        document.addEventListener('DOMContentLoaded', (event) => {
            document.querySelectorAll('pre').forEach((block) => {
                block.classList.add("line-numbers");
            });
        });
    </script>
    <!-- <script>(typeof $().modal == 'function')|| document.write('<script src="/libs/bs/js/bootstrap.min.js" type="text/javascript"><\/script>')</script>-->
    <!-- material design -->
    <!-- <script src="/libs/bs-material/js/ripples.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/ripples.min.js"></script> -->
    <!-- <script src="/libs/bs-material/js/material.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/bootstrap-material/0.3.0/js/material.min.js"></script>-->
    <!-- toc -->
    <!-- <script src="/libs/tocify/jquery-ui.min.js"></script> -->
    <!-- <script src="//apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script> -->
    <!-- <script src="/libs/tocify/jquery.tocify.custom.js"></script> -->
    <!-- <script src="/js/main.js"></script> -->
    <script src="/js/prism.js"></script>
</body>
</html>
